<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 8 Visualização de dados com ggplot2 | Introdução à Linguagem R: seus fundamentos e sua prática</title>
<meta name="author" content="Pedro Faria">
<meta name="description" content="8.1 Introdução e pré-requisitos Esse é o primeiro capítulo em que vamos introduzir o pacote ggplot2, ou simplesmente ggplot. O ggplot é um pacote voltado para a visualização de dados, ou em outras...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Capítulo 8 Visualização de dados com ggplot2 | Introdução à Linguagem R: seus fundamentos e sua prática">
<meta property="og:type" content="book">
<meta property="og:url" content="bem-vindo.html/visualização-de-dados-com-ggplot2.html">
<meta property="og:image" content="bem-vindo.html/capa.png">
<meta property="og:description" content="8.1 Introdução e pré-requisitos Esse é o primeiro capítulo em que vamos introduzir o pacote ggplot2, ou simplesmente ggplot. O ggplot é um pacote voltado para a visualização de dados, ou em outras...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 8 Visualização de dados com ggplot2 | Introdução à Linguagem R: seus fundamentos e sua prática">
<meta name="twitter:description" content="8.1 Introdução e pré-requisitos Esse é o primeiro capítulo em que vamos introduzir o pacote ggplot2, ou simplesmente ggplot. O ggplot é um pacote voltado para a visualização de dados, ou em outras...">
<meta name="twitter:image" content="bem-vindo.html/capa.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introdução à Linguagem R: seus fundamentos e sua prática</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem vindo!</a></li>
<li class="book-part">Introduzindo a Linguagem R</li>
<li><a class="" href="no%C3%A7%C3%B5es-b%C3%A1sicas-do-r.html"><span class="header-section-number">1</span> Noções Básicas do R</a></li>
<li><a class="" href="fundamentos-da-linguagem-r.html"><span class="header-section-number">2</span> Fundamentos da Linguagem R</a></li>
<li class="book-part">Importando, organizando e transformando dados</li>
<li><a class="" href="introduzindo-o-universo-do-tidyverse.html"><span class="header-section-number">3</span> Introduzindo o universo do tidyverse</a></li>
<li><a class="" href="importando-e-exportando-dados-com-readr-readxl-e-haven.html"><span class="header-section-number">4</span> Importando e exportando dados com readr, readxl e haven</a></li>
<li><a class="" href="transformando-dados-com-dplyr.html"><span class="header-section-number">5</span> Transformando dados com dplyr</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-a-base-de-dados-relacionais-com-dplyr.html"><span class="header-section-number">6</span> Introdução a base de dados relacionais com dplyr</a></li>
<li><a class="" href="tidy-data-uma-abordagem-para-organizar-os-seus-dados-com-tidyr.html"><span class="header-section-number">7</span> Tidy Data: uma abordagem para organizar os seus dados com tidyr</a></li>
<li class="book-part">Visualizando seus dados</li>
<li><a class="active" href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html"><span class="header-section-number">8</span> Visualização de dados com ggplot2</a></li>
<li><a class="" href="configurando-componentes-est%C3%A9ticos-do-gr%C3%A1fico-no-ggplot2.html"><span class="header-section-number">9</span> Configurando componentes estéticos do gráfico no ggplot2</a></li>
<li class="book-part">Ferramentas para tipos específicos de dados</li>
<li><a class="" href="manipula%C3%A7%C3%A3o-e-transforma%C3%A7%C3%A3o-de-strings-com-stringr.html"><span class="header-section-number">10</span> Manipulação e transformação de strings com stringr</a></li>
<li><a class="" href="introduzindo-fatores-factors-com-forcats.html"><span class="header-section-number">11</span> Introduzindo fatores (factor’s) com forcats</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-%C3%A0-vari%C3%A1veis-de-tempo-com-lubridate.html"><span class="header-section-number">12</span> Introdução à variáveis de tempo com lubridate</a></li>
<li class="book-part">Funções e Loops: construindo os seus próprios programas e automatizando tarefas</li>
<li><a class="" href="controle-condicional-de-fluxo.html"><span class="header-section-number">13</span> Controle condicional de fluxo</a></li>
<li><a class="" href="fun%C3%A7%C3%B5es.html"><span class="header-section-number">14</span> Funções</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">15</span> Loops</a></li>
<li><a class="" href="functional-programming-com-purrr.html"><span class="header-section-number">16</span> Functional programming com purrr</a></li>
<li><a class="" href="debugging---resolvendo-bugs-em-suas-fun%C3%A7%C3%B5es.html"><span class="header-section-number">17</span> Debugging - Resolvendo bugs em suas funções</a></li>
<li><a class="" href="environments-ou-ambientes-no-r.html"><span class="header-section-number">18</span> Environments ou ambientes no R</a></li>
<li class="book-part">Respostas dos exercícios de cada capítulo</li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-1.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-2.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-3.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-4.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-5.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-6.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-7.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-8.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-9.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-10.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-11.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-12.html">Referências</a></li>
<li><a class="" href="refer%C3%AAncias-13.html">Referências</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="pnad-cont%C3%ADnua-arquivo-csv-para-input.html"><span class="header-section-number">A</span> PNAD Contínua: arquivo CSV para input</a></li>
<li><a class="" href="refer%C3%AAncias-14.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/pedropark99/Introducao_R/">View book source <i class="fas fa-book-open"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="visualização-de-dados-com-ggplot2" class="section level1" number="8">
<h1>
<span class="header-section-number">Capítulo 8</span> Visualização de dados com <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2"><i class="fas fa-link"></i></a>
</h1>
<div id="introdução-e-pré-requisitos-2" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Introdução e pré-requisitos<a class="anchor" aria-label="anchor" href="#introdu%C3%A7%C3%A3o-e-pr%C3%A9-requisitos-2"><i class="fas fa-link"></i></a>
</h2>
<p>Esse é o primeiro capítulo em que vamos introduzir o pacote <code>ggplot2</code>, ou simplesmente <code>ggplot</code>. O <code>ggplot</code> é um pacote voltado para a visualização de dados, ou em outras palavras, para a construção de gráficos. Para que você possa acompanhar os exemplos dessa seção, você precisa ter o pacote instalado em sua máquina. Após instalá-lo, você pode tanto chamar diretamente pelo pacote <code>ggplot2</code>, quanto pelo <code>tidyverse</code>, que também o inclui, através da função <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<p></p>
</div>
<div id="o-que-é-o-ggplot-e-a-sua-gramática" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> O que é o <code>ggplot</code> e a sua gramática<a class="anchor" aria-label="anchor" href="#o-que-%C3%A9-o-ggplot-e-a-sua-gram%C3%A1tica"><i class="fas fa-link"></i></a>
</h2>
<p>A linguagem R é conhecida por sua capacidade gráfica, e <span class="citation"><a href="refer%C3%AAncias-14.html#ref-murrell2006" role="doc-biblioref">Murrell</a> (<a href="refer%C3%AAncias-14.html#ref-murrell2006" role="doc-biblioref">2006</a>)</span> oferece ótimos exemplos que atestam essa afirmação. Mesmo que a linguagem R ofereça “já de fábrica,” o pacote <code>lattice</code>, que já é capaz de muita coisa, o <code>ggplot</code> é sem dúvidas, o pacote mais popular da linguagem no que tange a criação de gráficos, pois ele oferece algo que os outros pacotes não tem, que é a sua <em>flexibilidade</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ou seja, em relação a seus concorrentes, o &lt;code&gt;ggplot&lt;/code&gt; não é necessariamente o pacote que oferece praticidade, mas sim, um leque de possibilidades muito maior em relação a seus concorrentes.&lt;/p&gt;"><sup>19</sup></a>.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-453"></span>
<img src="Figuras/phases9032.png" alt="phases9032 por Thomas Lin Pedersen" width="70%"><p class="caption">
Figura 8.1: phases9032 por Thomas Lin Pedersen
</p>
</div>
<p></p>
<p>Flexibilidade é uma das principais características (e a principal vantagem) do <code>ggplot</code>, e é o que amplia a sua utilização para além dos gráficos sérios e frios de um jornal científico, permitindo ao usuário criar gráficos vistosos, e um tanto peculiares. Veja por exemplo, a arte criada por Thomas Lin Pedersen, mostrada na figura 8.1. O que lhe dá essa liberdade dentro do <code>ggplot</code>, é a sua gramática.</p>
<p>O pacote <code>ggplot</code> (ou seu nome oficial - <code>ggplot2</code>) foi inicialmente desenvolvido por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-wickham2016" role="doc-biblioref">Wickham</a> (<a href="refer%C3%AAncias-14.html#ref-wickham2016" role="doc-biblioref">2016</a>)</span>, e lançado pela primeira vez no ano de 2005. O pacote representa uma implementação da teoria desenvolvida por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">Wilkinson</a> (<a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">2005</a>)</span>, chamada de <em>The Grammar of Graphics</em> (ou “a gramática dos gráficos”). Portanto, o <code>ggplot</code> busca abstrair os principais conceitos da teoria de <span class="citation"><a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">Wilkinson</a> (<a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">2005</a>)</span>, e implementá-los dentro da linguagem R.</p>
<p>Segundo a teoria de <span class="citation"><a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">Wilkinson</a> (<a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">2005</a>)</span>, todo e qualquer gráfico estatístico, pode ser descrito por um conjunto de camadas, ou componentes, que estão apresentados na figura 8.2. Dessa forma, na visão de <span class="citation"><a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">Wilkinson</a> (<a href="refer%C3%AAncias-14.html#ref-wilkinson" role="doc-biblioref">2005</a>)</span> todos os tipos de gráfico que conhecemos (pizza, barras, dispersão, <em>boxplot</em>, etc.) fazem parte de um mesmo grupo, e a característica que os tornam diferentes entre si, se encontra na forma como as camadas abaixo estão definidas em cada gráfico.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-454"></span>
<img src="Figuras/camadas_grafico.png" alt="Camadas de um gráfico do ggplot, baseado em Wickham (2016)" width="60%"><p class="caption">
Figura 8.2: Camadas de um gráfico do ggplot, baseado em Wickham (2016)
</p>
</div>
<p></p>
<p>Tendo isso em mente, um gráfico do <code>ggplot</code> é composto por várias camadas, que em conjunto formam o gráfico desejado. A ideia por trás do pacote, portanto, é utilizar uma gramática para descrever de forma concisa, cada uma das camadas apresentadas na figura 8.2. Após definirmos essas camadas, nós podemos somá-las para construirmos o nosso gráfico final. Em outras palavras, você vai adicionando aos poucos, novas camadas ao gráfico, onde cada uma dessas camadas fica responsável por definir um componente específico do gráfico (escalas, formas geométricas, legendas, facetas, anotações, …). Caso seja de seu desejo, você pode deixar o próprio <code>ggplot</code> responsável por definir várias das camadas apresentadas na figura 8.2. Porém, em todo gráfico do <code>ggplot</code>, você deve obrigatoriamente definir as três camadas (em negrito na figura 8.2) apresentadas a seguir, sendo portanto, as camadas <strong>essenciais</strong> que formam a base de todo gráfico do <code>ggplot</code>.</p>
<ol style="list-style-type: decimal">
<li><p>Dados: os dados que o gráfico deve expor.</p></li>
<li><p>Mapeamento estético (<em>aesthetic mapping</em>): uma descrição de como as variáveis dispostas em seus dados devem ser mapeadas para elementos visuais (ou estéticos) de seu gráfico.</p></li>
<li><p>Geometrias: são as formas geométricas do gráfico que representam os seus dados, ou seja, em um gráfico de dispersão, seus dados são representados no gráfico por <em>pontos</em>, enquanto em um gráfico de barras, seus dados são representados por <em>retângulos</em>.</p></li>
</ol>
<p>A gramática do <code>ggplot</code>, representa, portanto, as regras que definem o emprego das funções necessárias, e de seus possíveis parâmetros para acessarmos e controlarmos cada uma das camadas mostradas na figura 8.2. Logo, cada uma dessas camadas, são controladas por uma função (ou por um conjunto de funções) diferente, que lhe permite o uso de diferentes mecanismos e valores em sua definição.</p>
</div>
<div id="iniciando-um-gráfico-do-ggplot" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Iniciando um gráfico do <code>ggplot</code><a class="anchor" aria-label="anchor" href="#iniciando-um-gr%C3%A1fico-do-ggplot"><i class="fas fa-link"></i></a>
</h2>
<div id="dados" class="section level3" number="8.3.1">
<h3>
<span class="header-section-number">8.3.1</span> Dados<a class="anchor" aria-label="anchor" href="#dados"><i class="fas fa-link"></i></a>
</h3>
<p>Primeiro, vamos definir os dados que vamos utilizar em nossos gráficos. A tabela <code>datasus</code>, contém a contagem de mortes por homicídios dolosos em 2018 no Brasil, coletados a partir dos microdados do SIM/DATASUS. Nessa mesma tabela, temos a distribuição dessas mortes, por sexo, por faixa etária, pelo estado (Unidade da Federação - UF) em que as mortes ocorreram, e pela cor de pele dos indivíduos.</p>
<p></p>
<div class="sourceCode" id="cb872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>

<span class="va">github</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/pedropark99/"</span>
<span class="va">pasta</span> <span class="op">&lt;-</span> <span class="st">"Curso-R/master/Dados/"</span>
<span class="va">arquivo</span> <span class="op">&lt;-</span> <span class="st">"datasus.csv"</span>

<span class="va">datasus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">github</span>, <span class="va">pasta</span>, <span class="va">arquivo</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## i Using "','" as decimal and "'.'" as grouping mark. Use `read_delim()` for more control.</code></pre>
<pre><code>## Rows: 1836 Columns: 6</code></pre>
<pre><code>## -- Column specification ---------------------------------------------------
## Delimiter: ";"
## chr (5): Faixa etaria, Genero, Cor, Nome UF, UF
## dbl (1): Contagem</code></pre>
<pre><code>## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb877"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasus</span></code></pre></div>
<pre><code>## # A tibble: 1,836 x 6
##    `Faixa etaria` Genero    Cor      `Nome UF` UF    Contagem
##    &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;
##  1 10 a 14        Feminino  Parda    Acre      AC           4
##  2 10 a 14        Masculino Parda    Acre      AC           4
##  3 15 a 19        Feminino  Branca   Acre      AC           2
##  4 15 a 19        Feminino  Parda    Acre      AC           4
##  5 15 a 19        Masculino Branca   Acre      AC           6
##  6 15 a 19        Masculino Parda    Acre      AC          65
##  7 15 a 19        Masculino Preta    Acre      AC           1
##  8 20 a 24        Feminino  Indígena Acre      AC           1
##  9 20 a 24        Feminino  Parda    Acre      AC           4
## 10 20 a 24        Masculino Branca   Acre      AC           7
## # ... with 1,826 more rows</code></pre>
<p></p>
<p>Vamos começar a montar o nosso gráfico. Você <strong>sempre</strong> inicia um gráfico de <code>ggplot</code>, pela função base do pacote - <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Essa função é responsável por criar o objeto base para o gráfico, e nela, possuímos dois argumentos que compõe duas das três camadas essenciais (que definimos na seção 8.2) desse gráfico, e que podem ou não ser fornecidos nessa função. Esses dois argumentos são: <em>data</em>, que é o nome da tabela onde estão os dados que serão utilizados no gráfico; e <em>mapping</em>, que é o <em>aesthetic mapping</em>, ou o mapeamento de variáveis de sua tabela, para componentes estéticos do gráfico. Ou seja, você não precisa necessariamente fornecer esses argumentos já na função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, pois você pode defini-los dentro das funções que formam as figuras geométricas (as funções <code>geom</code>). O importante, é que você sempre deve começar um gráfico <code>ggplot</code>, com a função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<p>Mas então, qual é a diferença entre eu fornecer esses argumentos na função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> ou dentro das funções <code>geom</code>? Pense em um exemplo, no qual você busca mostrar em um mesmo gráfico, duas informações diferentes. Você pode utilizar dois <code>geom</code>’s (ou formas geométricas) diferentes para mostrar e diferenciar essas duas informações no gráfico. Por exemplo, podemos ter um gráfico que contenha barras mostrando a evolução da dívida pública, e linhas mostrando a evolução do salário médio no país.</p>
<p>Caso você forneça os dois argumentos (<em>data</em> e <em>mapping</em>) na função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, você está dizendo ao programa, que ele deve utilizar a mesma base de dados, e o mesmo <em>aesthetic mapping</em>, em todos os formatos geométricos (<code>geom</code>) do gráfico. Enquanto, ao fornecer esses argumentos dentro de cada função <code>geom</code>, você estaria dizendo ao programa que utilize essa base de dados, e esse <em>aesthetic mapping</em>, apenas naquele formato geométrico (ou <code>geom</code>) especificamente. Tendo isso em mente, não conseguiríamos montar o gráfico descrito no parágrafo anterior, ao dar os argumentos já na função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Pois o gráfico mostra duas informações diferentes (salário médio e dívida pública), ao longo dos <code>geom</code>’s do gráfico. Ou seja, os dois formatos geométricos dispostos no gráfico, utilizam dois <em>aesthetic mapping</em> diferentes. Quando chegarmos à seção 8.4 vou explicar isso em mais detalhes.</p>
<p>No nosso caso, os dados que vamos utilizar, estão na tabela <code>datasus</code>, por isso forneço ao argumento <em>data</em> o nome dessa tabela. Ao rodar o código logo abaixo, você vai perceber que ele gera apenas um quadro cinza vazio. Isso ocorre porque definimos apenas uma das camadas essenciais para compor o gráfico, que são os dados utilizados. Temos que definir as outras duas, para completarmos a base de um gráfico, por isso, vamos passar agora para o <em>aesthetic mapping</em>.</p>
<p></p>
<div class="sourceCode" id="cb879"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">datasus</span><span class="op">)</span></code></pre></div>
<p></p>
</div>
<div id="mapeamento-de-variáveis-aesthetic-mapping" class="section level3" number="8.3.2">
<h3>
<span class="header-section-number">8.3.2</span> Mapeamento de variáveis (<em>Aesthetic Mapping</em>)<a class="anchor" aria-label="anchor" href="#mapeamento-de-vari%C3%A1veis-aesthetic-mapping"><i class="fas fa-link"></i></a>
</h3>
<p>O <em>aesthetic mapping</em> representa o mapeamento, ou a conexão de variáveis em sua tabela (ou sua base de dados), com os componentes estéticos e visuais do gráfico. Nós controlamos esse mapeamento através da função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Há diversos desses componentes visuais que compõe um gráfico, e os primeiros que vêm a sua mente, são provavelmente as cores e as formas geométricas. Mas também os próprios eixos, ou melhor dizendo, as escalas utilizadas nos eixos, são componentes visuais do gráfico. Pois essas escalas definem como as formas geométricas vão se posicionar dentro do espaço do gráfico.</p>
<p>Pense por exemplo, no globo terrestre. Você pode representar esse globo dentro do <code>ggplot</code>, mas para que os formatos sejam corretamente posicionados em um “globo,” você precisa usar uma escala e um sistema de coordenadas diferentes do plano cartesiano. Um outro exemplo, seria o gráfico de pizza. Ao pesquisar sobre, você irá perceber que um gráfico de pizza no <code>ggplot</code>, é feito a partir do formato geométrico de barras (<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>). Ou seja, um gráfico de barras, é o ponto de partida para gerar um gráfico de pizza no <code>ggplot</code>, e o que diferencia esses dois gráficos, é a escala usada. Em um gráfico de pizza, utilizamos uma coordenada circular, chamada de coordenada polar, ao invés do plano cartesiano.</p>
<p>Agora, vamos continuar montando nosso gráfico. Primeiro, vamos tentar montar um gráfico de barras, que mostre a distribuição do total de mortes ao longo das faixas etárias no país, baseado nos dados apresentados na tabela <code>datasus</code>. Tendo isso em mente, o número de mortes, deve ficar no eixo y de nosso gráfico, enquanto os grupos (faixas etárias), devem ficar no eixo x.</p>
<p>Essa é a base do nosso mapeamento de variáveis. Estamos definindo que o número de mortes deve ficar no eixo y, e as faixas etárias no eixo x, e nós concedemos essa descrição ao <code>ggplot</code>, dentro da função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> (abreviação para <em>aesthetic mapping</em>). Dessa vez, ao rodar o código abaixo você vai perceber que um plano cartesiano foi montado, onde temos uma escala para a faixa etária no eixo x, e outra escala para o total de mortes no eixo y. Porém, esse plano cartesiano continua vazio, pois ainda não definimos a última camada essencial do gráfico, que é a forma geométrica que deve representar os nossos dados.</p>
<p></p>
<div class="sourceCode" id="cb880"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">datasus</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Faixa etaria`</span>, y <span class="op">=</span> <span class="va">Contagem</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-457-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Portanto, vamos adicionar ao nosso código, nossa primeira função <code>geom</code>. Cada função <code>geom</code>, se refere a um formato geométrico diferente. No nosso caso, queremos um gráfico de barras, que é formado pela função <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>. O padrão dessa função (ou formato geométrico) no <code>ggplot</code>, é calcular uma contagem dos dados. Em outras palavras, o gráfico de barras no <code>ggplot</code>, se comporta inicialmente (por padrão) como um histograma. Ao invés de calcular a soma total de certa variável, ele irá contar, quantas vezes cada valor ocorre naquela variável dentro da base de dados.</p>
<p>Entretanto, não queremos uma contagem dos dados, pois a coluna <code>Contagem</code> já representa uma contagem em si. O que queremos é a soma total dessa contagem em cada faixa etária. Por isso, ao invés de fornecer <code>Contagem</code> ao argumento <em>y</em>, eu defino essa coluna para o argumento <em>weight</em>. Todas as funções que adicionarmos às várias camadas do nosso gráfico, devem ser conectadas por um sinal de <code>+</code>, por isso lembre-se de colocar esse sinal sempre que adicionar uma nova função ao seu gráfico.</p>
<p></p>
<div class="sourceCode" id="cb881"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">datasus</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Faixa etaria`</span>, weight <span class="op">=</span> <span class="va">Contagem</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-458-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Agora que definimos as três camadas essenciais (dados, <em>aesthethic mapping</em> e <code>geom</code>), temos enfim o nosso primeiro gráfico montado. Há várias coisas que poderíamos fazer a partir daqui. Podemos por exemplo, colorir as barras de acordo com a participação do sexo no número de mortes. Ou seja, essas cores irão representar em cada barra, o número de mortes que correspondem ao sexo masculino e ao sexo feminino. Por padrão, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> empilha esses agrupamentos um em cima do outro. Dessa forma, essas cores não apenas nos apresenta o número de mortes em cada sexo, mas indiretamente, elas também nos mostram o quanto que aquele grupo representa (qual a sua porcentagem) do total de mortes naquela faixa etária.</p>
<p>Desta maneira, estamos definindo um outro componente visual do gráfico (cores das barras) à uma outra variável de nossos dados (coluna <code>Genero</code>). Logo, estamos falando novamente do <em>aesthethic mapping</em> do gráfico, e por isso, devemos definir essa ligação dentro da função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Há duas formas de você colorir formas geométricas no <code>ggplot</code>, que dependem da forma geométrica e do resultado que você quer atingir. Uma barra (ou retângulo), é tratada como uma forma geométrica de área, enquanto outras formas (como pontos e linhas) são tratadas de uma maneira diferente. Nesses formatos de área, você deve utilizar o argumento <code>fill</code>, para preencher o interior deste formato de uma cor.</p>
<p></p>
<div class="sourceCode" id="cb882"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">datasus</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">`Faixa etaria`</span>,
      weight <span class="op">=</span> <span class="va">Contagem</span>,
      fill <span class="op">=</span> <span class="va">Genero</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-459-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Conseguimos colorir as barras, e podemos ver que uma parte muito pequena das mortes correspondem ao sexo feminino, em todas as faixas etárias. Agora, e se mudássemos a variável de grupos (faixas etárias) do nosso gráfico? Vamos conectar uma variável diferente ao eixo x, por exemplo, a cor de pele. Perceba, que o restante do <em>aesthetic mapping</em> continua o mesmo, e portanto, o gráfico mantém essas outras “conexões” enquanto modifica a variável ligada ao eixo x.</p>
<p></p>
<div class="sourceCode" id="cb883"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">datasus</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Cor</span>,
      weight <span class="op">=</span> <span class="va">Contagem</span>,
      fill <span class="op">=</span> <span class="va">Genero</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-460-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Como disse anteriormente, há outros componentes visuais que você pode ligar às variáveis de sua tabela de dados. Você pode por exemplo, em alguns <code>geom</code>’s, conectar o <em>formato</em> desse <code>geom</code> a uma variável. Eu sei, sua cabeça provavelmente deu uma volta com esse exemplo: “Como assim? Eu posso variar o formato de uma forma geométrica ao longo do gráfico?” Na seção 8.4 dou um exemplo dessa estratégia.</p>
</div>
<div id="formatos-geométricos---funções-geom" class="section level3" number="8.3.3">
<h3>
<span class="header-section-number">8.3.3</span> Formatos geométricos - funções <code>geom</code><a class="anchor" aria-label="anchor" href="#formatos-geom%C3%A9tricos---fun%C3%A7%C3%B5es-geom"><i class="fas fa-link"></i></a>
</h3>
<p>Cada função <code>geom</code> utiliza um formato geométrico e uma forma de desenho diferentes, para desenhar e representar os seus dados. No <code>ggplot</code> há vários <code>geom</code>’s distintos que você pode utilizar. Abaixo estou listando os <code>geom</code>’s mais comuns, mas basta consultar o painel de dicas do RStudio<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" class="uri"&gt;https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf&lt;/a&gt;&lt;/p&gt;'><sup>20</sup></a>, ou o site oficial de referências do pacote<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/index.html" class="uri"&gt;https://ggplot2.tidyverse.org/reference/index.html&lt;/a&gt;&lt;/p&gt;'><sup>21</sup></a>, que você ficará um pouco perdido com tantas opções. Um excelente repositório, com ótimos exemplos de gráficos dos quais você pode tirar inspirações de como e onde utilizar cada <code>geom</code>, é o <em>R Graph Gallery</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.r-graph-gallery.com/" class="uri"&gt;https://www.r-graph-gallery.com/&lt;/a&gt;&lt;/p&gt;'><sup>22</sup></a>.</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>: desenha um gráfico de barras.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>: desenha um gráfico de pontos (ou um gráfico de dispersão).</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>: desenha um gráfico de linha.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>: desenha um gráfico de <em>boxplot</em>.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code>: desenha um histograma.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf()</a></code>: desenha um mapa (<code>geom</code> para dados espaciais).</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>: desenha uma linha de média condicional (muito utilizado para desenhar linhas que representam modelos de regressão linear e de outros modelos econométricos).</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>: utilizado para inserir texto.</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label()</a></code>: utilizado para inserir rótulos, ou basicamente, textos envoltos por uma caixa.</p></li>
</ol>
<p>Por exemplo, um gráfico de barras, é geralmente utilizado para apresentar estatísticas descritivas dos nossos dados. Ou seja, esse tipo de gráfico (por padrão) tenta resumir características dos seus dados em poucos números (médias, totais, contagens). Já um gráfico de dispersão (por padrão) nos apresenta diretamente os dados, de forma crua no plano cartesiano. Isto é, diferentes <code>geom</code>’s vão tratar (e principalmente, representar) os seus dados de formas distintas. Vamos por exemplo, adicionar pontos ao nosso gráfico anterior, com o <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>.</p>
<p>Para facilitar a visualização, eu limitei os valores do eixo y no gráfico (para o intervalo de 0 a 1500) por meio da função <code><a href="https://ggplot2.tidyverse.org/reference/lims.html">lims()</a></code>. Dessa forma, estamos dando um <em>zoom</em> em uma área específica do gráfico. Repare que cada ponto representa uma das observações encontradas na nossa base, e que vários deles estão se sobrepondo.</p>
<p></p>
<div class="sourceCode" id="cb884"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">datasus</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Cor</span>,
      weight <span class="op">=</span> <span class="va">Contagem</span>,
      fill <span class="op">=</span> <span class="va">Genero</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Contagem</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">lims</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1500</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (geom_bar).</code></pre>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-461-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Ao substituirmos as barras por <em>boxplot</em>’s produzimos um gráfico que além de mostrar todas observações da base com o <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, ele também mostra como a distribuição de ambos os sexos se encaixam ao longo do alcance (ou <em>range</em>) desses dados. Podemos perceber que nos indivíduos de cor parda, a maior contagem para o sexo feminino em toda a base, atinge em torno de 175 mortes, enquanto para o sexo masculino, esses valores podem atingir mais de 1000 mortes, apesar de que ambos os valores são <em>outliers</em> em suas respectivas distribuições.</p>
<p></p>
<div class="sourceCode" id="cb886"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">datasus</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">Cor</span>,
      y <span class="op">=</span> <span class="va">Contagem</span>,
      fill <span class="op">=</span> <span class="va">Genero</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-462-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Uma outra forma de visualizarmos a diferença entre homens e mulheres nesses dados, seria utilizando <code>geom</code>’s de erro, como as linhas de alcance. Os <code>geom</code>’s de erro são muito úteis para visualizar medidas de variação ao longo dos grupos. O <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon()</a></code> por exemplo, é utilizado em gráficos de séries temporais, para desenhar os intervalos de confiança ou desvios padrão ao redor da linha que representa a série. No nosso caso, iremos utilizar o <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange()</a></code>, para desenharmos a diferença média entre o número de mortes entre os dois gêneros.</p>
<p>O que o <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange()</a></code> faz é desenhar uma reta de um ponto A a um ponto B. A ideia por traz desse <code>geom</code> é desenharmos um linha que representa (pelo seu comprimento), por exemplo, o desvio padrão de uma variável, ou no nosso caso, a diferença na média de vítimas de homicídios dolosos entre dois gêneros. Isto significa que temos dois novos componentes visuais que podemos controlar no gráfico através do <em>aesthetic mapping</em>, que são as coordenadas do ponto A e do ponto B. Esses componentes (pontos A e B) representam os “limites” (máximo e mínimo) dessa linha, por isso, são controlados pelos argumentos <code>ymax</code> e <code>ymin</code> dentro da função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Há outros <code>geom</code>’s que podem ser controlados por esses argumentos, porém, os que vimos anteriormente (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> e <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>) não possuem esses argumentos.</p>
<p>Primeiro, precisamos calcular o número médio de mortes de cada gênero e em cada cor de pele, e em seguida, modificar a estrutura da tabela, para que possamos mapear os limites (<code>ymin</code> e <code>ymax</code>) do <em>linerange</em> de acordo com o sexo. Para isso utilizo funções do pacote <code>dplyr</code>, portanto lembre-se de chamar por esse pacote com <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>, para ter acesso a essas funções. Perceba também que eu inverti o plano cartesiano, utilizando a função <code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb887"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasus_agrup</span> <span class="op">&lt;-</span> <span class="va">datasus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Cor</span>, <span class="va">Genero</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Contagem</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>
    id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cor"</span>, <span class="st">"Genero"</span><span class="op">)</span>,
    names_from <span class="op">=</span> <span class="st">"Genero"</span>,
    values_from <span class="op">=</span> <span class="st">"Media"</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Cor'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb889"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">datasus_agrup</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cor</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymax <span class="op">=</span> <span class="va">Masculino</span>, ymin <span class="op">=</span> <span class="va">Feminino</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Feminino</span>, color <span class="op">=</span> <span class="st">"Feminino"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Masculino</span>, color <span class="op">=</span> <span class="st">"Masculino"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-463-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Agora, muitas coisas estão ocorrendo neste gráfico. Primeiro, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_linerange()</a></code> constrói uma linha para cada cor de pele, que vai da média de mortes no sexo feminino até a média no sexo masculino. Segundo, dois <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> são utilizados, onde cada um deles fica responsável por um dos sexos, e desenha um único ponto para cada cor de pele que indica a média de mortes para o sexo correspondente. Em seguida, eu uso <code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip()</a></code> para inverter o plano cartesiano. Ou seja, a variável que estava no eixo y (média de mortes) vai para o eixo x, e a variável que estava no eixo x (cor de pele) vai para o eixo y.</p>
<p>Certamente, esse gráfico dá um pouco mais de trabalho de construir. Porém, é uma forma mais simples de se mostrar essa diferença, e com isso, você consegue atingir um público maior. Pode ser que o seu leitor não saiba o que é um <em>boxplot</em>, e há razões razoáveis para se acreditar nisso. No Brasil, o <em>boxplot</em> não é comumente tratado no ensino básico, e sim no ensino superior, e mais especificamente, em cursos que sejam da área de exatas, ou que possuam matérias de estatística na grade curricular. Nós sabemos também que o acesso da população brasileira ao ensino superior é restrito, sendo considerado um local de “elitismo.”</p>
<p>Por outro lado, os alunos em geral veem as principais medidas estatísticas de posição central (média, mediana e moda) já no ensino básico, e alguns chegam a revê-las no ensino superior. Logo, as chances de seu leitor compreender a mensagem que você quer passar: “em média, os homens são as principais vítimas de homicídios dolosos, entretanto, nas populações indígenas e de cor de pele amarela, esse padrão não parece ser significativo” são maiores. Essa consideração pode ter menor peso a depender de qual seja o público que você busca atingir. Se você está publicando um artigo científico em sua área, é bem provável que os potenciais leitores deste material conheçam um <em>boxplot</em>, e portanto, saibam interpretá-lo corretamente.</p>
</div>
</div>
<div id="uma-outra-forma-de-se-compreender-o-aesthetic-mapping" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Uma outra forma de se compreender o <em>aesthetic mapping</em><a class="anchor" aria-label="anchor" href="#uma-outra-forma-de-se-compreender-o-aesthetic-mapping"><i class="fas fa-link"></i></a>
</h2>
<p>Nas seções anteriores, eu defini o <em>aesthetic mapping</em>, como a conexão entre as variáveis de sua tabela, com os componentes visuais de seu gráfico. Porém, temos uma outra forma útil de enxergarmos esse sistema. Podemos entender o <em>aesthetic mapping</em>, como um mecanismo para determinarmos quais componentes visuais vão variar, e quais vão permanecer constantes ao longo do gráfico. Ou seja, se você está definindo, por exemplo, as cores da forma geométrica (<code>geom</code>) que representa os seus dados, você pode utilizar o <em>aesthetic mapping</em> para definir se e como essas cores vão variar ao longo do gráfico.</p>
<p>Por exemplo, vamos voltar ao gráfico de barras que montamos na seção 8.3, que mostra o número total de mortes ao longo das diferentes cores de pele e gênero da base. Perceba, que a cor está variando dentro de cada barra (e não entre cada uma delas), de acordo com a variável <code>Genero</code>.</p>
<p></p>
<div class="sourceCode" id="cb890"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cor</span>, weight <span class="op">=</span> <span class="va">Contagem</span>, fill <span class="op">=</span> <span class="va">Genero</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-464-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Nós podemos modificar a forma como essas cores variam dentro de cada barra, ao mudarmos a variável que define essa variação. Em outras palavras, podemos alterar o comportamento das cores, ao conectar esse componente em <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, a uma outra variável de nossa tabela. Como exemplo, podemos atribuir às UF’s da base. Perceba que temos agora, uma variação muito maior de cores dentro de cada barra.</p>
<p></p>
<div class="sourceCode" id="cb891"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cor</span>, weight <span class="op">=</span> <span class="va">Contagem</span>, fill <span class="op">=</span> <span class="va">UF</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-465-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Nós podemos ainda, atribuir a mesma variável alocada no eixo x para definir a variação dessas cores ao longo do gráfico. Dessa forma, temos um gráfico onde cada uma das barras terá a sua própria cor. Isso não é particularmente útil, mas talvez você deseja ter uma cor separada para cada barra, e caso você esteja com preguiça de pensar e definir quais cores serão essas, deixar essa tarefa nas mãos do próprio <code>ggplot</code> é uma solução e um atalho simples para atingir um bom resultado.</p>
<p></p>
<div class="sourceCode" id="cb892"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cor</span>, weight <span class="op">=</span> <span class="va">Contagem</span>, fill <span class="op">=</span> <span class="va">Cor</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-466-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Portanto, ao conectarmos diferentes variáveis com o argumento (<code>fill</code>) em <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, que define como as cores de cada barra são compostas, podemos modificar a forma como essas cores variam ao longo do gráfico. Mas e se nós quisermos manter uma única cor para essas barras, ou seja, e se é de seu desejo manter as cores constantes ao longo de todo o gráfico? Para isso, basta que você defina essas cores, fora de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</p>
<p>Em outras palavras, a função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> trabalha com <strong>variáveis</strong>, ou atributos de suas observações que tendem a variar ao longo de sua base. Quando você estiver trabalhando com valores constantes, ou com atributos que possuem um único valor possível ao longo de toda a sua base, a função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> provavelmente não será o lugar ideal para trabalharmos com tais valores.</p>
<p>Por exemplo, o R possui diversas cores pré-programadas em seu sistema, e sempre que você quiser acessar essas cores ao longo do <code>ggplot</code>, você pode se referir a elas, através de seus nomes registrados. Caso queira uma lista com os nomes dessas cores pré-programadas, você pode utilizar a função <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code>. Dentre essas diversas cores, temos uma chamada de <code>steelblue</code>. Logo, caso eu queira que todas as barras do meu gráfico estejam coloridas de acordo com essa cor, eu preciso fornecer o nome dessa cor ao argumento <code>fill</code>, de fora da função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb893"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cor</span>, weight <span class="op">=</span> <span class="va">Contagem</span><span class="op">)</span>,
    fill <span class="op">=</span> <span class="st">"steelblue"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-467-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Portanto, você pode aplicar essa metodologia para qualquer outro componente visual de seu gráfico que pode ser definido. Ou seja, se você deseja manter algum dos componentes visuais, definidos por um dos argumentos de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> (<code>fill</code>, <code>color</code>, <code>size</code>, <code>fontface</code>, <code>linetype</code>, <code>shape</code>, etc.), constantes, você precisa apenas definir esses argumentos fora de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Por outro lado, caso você queira controlar a forma como algum desses componentes visuais variam ao longo do gráfico, você precisa definir esses argumentos dentro de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</p>
<p>Porém, você talvez se pergunte: o que ocorre se eu fornecer a cor <code>steelblue</code> dentro de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>? Será que o <code>ggplot</code> reconhece que queremos aplicar essa cor sobre as formas geométricas do gráfico? A resposta curta é não, mas o resultado em geral é um pouco estranho, ou no mínimo algo inesperado. Pois em um caso como esse, a função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> irá entender que você deseja colorir as barras no gráfico, de acordo com uma nova variável em sua tabela, chamada <code>fill</code>, e que possui um único valor possível ao longo da base, mais especificamente, o texto <code>steelblue</code>.</p>
<p>Esse comportamento ocorre sempre que você fornece um valor em texto (um <em>string</em>) à algum argumento de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Em uma situação como essa, o <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> parece criar uma nova variável em sua tabela chamada <code>fill</code>, e que contém o valor em texto que você forneceu a esse argumento. Isso não necessariamente é um comportamento inadequado, mas ele certamente surpreende alguns usuários, e como ele tem se mantido ao longo das últimas versões do <code>ggplot</code>, é possível que ele continue a funcionar dessa forma, por um bom tempo.</p>
<p></p>
<div class="sourceCode" id="cb894"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cor</span>, weight <span class="op">=</span> <span class="va">Contagem</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-468-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
</div>
<div id="sobrepondo-o-aesthetic-mapping-inicial-em-diversas-camadas" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Sobrepondo o <em>aesthetic mapping</em> inicial em diversas camadas<a class="anchor" aria-label="anchor" href="#sobrepondo-o-aesthetic-mapping-inicial-em-diversas-camadas"><i class="fas fa-link"></i></a>
</h2>
<p>Agora, vou explicar em maiores detalhes qual é a diferença entre: preenchermos os argumentos de <code>data</code> e <code>mapping</code> já na função inicial do gráfico (<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>), e de preenchê-los nas funções <code>geom</code>.</p>
<p>Para isso, vamos usar outros dados. Na tabela PIB eu possuo uma série histórica mensal do índice de faturamento real da indústria (<code>Faturamento_indus</code>), da porcentagem do PIB que representa a dívida pública líquida (<code>Divida_liq_perc</code>), e a média mensal da taxa de investimento produtivo (taxa de formação bruta de capital fixo - <code>FBCF</code>) na economia brasileira, além de dados de PIB, coletados do IPEAData<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="http://www.ipeadata.gov.br/Default.aspx" class="uri"&gt;http://www.ipeadata.gov.br/Default.aspx&lt;/a&gt;&lt;/p&gt;'><sup>23</sup></a>.</p>
<p></p>
<div class="sourceCode" id="cb895"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PIB</span></code></pre></div>
<pre><code>## # A tibble: 184 x 6
##    Data           PIB PIB_acumulado Divida_liq_perc  FBCF Faturamento_indus
##    &lt;date&gt;       &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt; &lt;dbl&gt;             &lt;dbl&gt;
##  1 2005-01-01 163540.         100              42.3 103.              102. 
##  2 2005-02-01 160702.          98.3            42.7  99.1              98.9
##  3 2005-03-01 175469.         107.             43.1 112.               98.3
##  4 2005-04-01 177179          108.             42.5 108.              107. 
##  5 2005-05-01 177497.         109.             42.4 113.              100. 
##  6 2005-06-01 180882.         111.             42.8 115.              104. 
##  7 2005-07-01 184074.         113.             43.2 111.               99.8
##  8 2005-08-01 187247.         114.             43.2 120.               97  
##  9 2005-09-01 181539.         111.             43.2 115.               96.1
## 10 2005-10-01 189183          116.             43.6 110.               95.8
## # ... with 174 more rows</code></pre>
<p></p>
<p>Na seção 8.3, expliquei que ao preencher os argumentos já no <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> você estaria pedindo ao programa, que utilize a mesma base de dados e/ou o mesmo <em>aesthetic mapping</em> ao longo de todas as camadas do gráfico. Como exemplo, veja o que acontece no gráfico abaixo.</p>
<p>Como o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> busca resumir os nossos dados em poucas estatísticas, eu coloquei dessa vez o valor <em>“identity”</em> no argumento <code>stat</code>. Isso impede que ele agrupe os dados em alguma medida estatística, fazendo com que o <code>geom</code> apenas identifique os valores que aparecem na base, da mesma forma que um <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> faria. Perceba também, que eu estou utilizando três <code>geom</code>’s diferentes no gráfico. Mas como eu não defini um <em>aesthetic mapping</em> específico em cada um deles, todos esses <code>geom</code>’s estão mostrando exatamente a mesma informação. Dito de outra forma, estes <code>geom</code>’s estão utilizando o mesmo <em>aesthetic mapping</em>, o qual definimos na função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb897"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">PIB</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Data</span>, y <span class="op">=</span> <span class="va">Faturamento_indus</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"darkgray"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-471-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Você deve estar pensando: “Ok, mas isso não faz sentido! Por que eu usaria três <code>geom</code>’s diferentes para uma mesma informação?” Bem, pode ser que você queira utilizar mais de um <code>geom</code> que mostre a mesma informação, por questões estéticas no gráfico. Um exemplo simples, seria marcar a borda de uma linha criada por <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>. Ou seja, não há uma forma direta e simples em <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> (algo que já é possível de ser feito no <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>), de pintar essas bordas de uma cor mais escura (ou clara) do que o interior da linha, dando assim uma maior ênfase para aquela linha. Portanto, a ideia seria criarmos duas camadas de <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>: uma interna, com uma linha mais estreita e de cor mais clara (ou mais escura); e uma externa, com uma linha mais larga (de forma que ela “transborde” para fora da linha interna) e de cor mais escura (ou mais clara).</p>
<p>De qualquer maneira, esses <code>geom</code>’s não fazem muito sentido da forma como estão dispostos no momento, portanto, vamos mudar de estratégia. Por que não utilizamos um só <code>geom</code> para apresentar três informações diferentes?! Para isso, temos que modificar a nossa base levemente. O objetivo é pegar as três colunas com as variáveis que vamos plotar (<code>Faturamento_indus</code>, <code>FBCF</code> e <code>Divida_liq_perc</code>), e agrupá-las em duas colunas: uma com os valores dessas variáveis, e outra coluna com os nomes dessas variáveis, para identificar qual variável o valor na primeira coluna se refere. Realizamos esse trabalho pela função <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb898"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">PIB_remodelado</span> <span class="op">&lt;-</span> <span class="va">PIB</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Data</span>, <span class="va">Faturamento_indus</span>, <span class="va">FBCF</span>, <span class="va">Divida_liq_perc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Faturamento_indus"</span>, <span class="st">"FBCF"</span>, <span class="st">"Divida_liq_perc"</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="st">"Nome_variavel"</span>,
    values_to <span class="op">=</span> <span class="st">"Valor"</span>
  <span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">PIB_remodelado</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Data</span>, y <span class="op">=</span> <span class="va">Valor</span>, linetype <span class="op">=</span> <span class="va">Nome_variavel</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-472-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Novamente, como não incluímos uma função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, ou definimos o argumento <code>data</code> dentro do <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>, ele irá utilizar o <code>data</code> e o <em>aesthetic mapping</em> (<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>) que definimos em <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Lembra de quando eu disse que você poderia controlar o formato de um <code>geom</code> de acordo com uma variável? O gráfico acima é um exemplo prático disso. Estamos utilizando apenas um <code>geom</code> para mostrar três informações diferentes, e o componente estético que utilizamos para diferenciar essas informações no gráfico, é o formato dessas linhas. Portanto, ao definirmos o componente <code>linetype</code> para <em>Nome_variavel</em>, estamos modificando o formato da linha (tracejada ou sólida), de acordo com os valores dessa variável. Poderíamos usar a mesma estratégia em <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, ao definirmos o argumento <code>shape</code> para <em>Nome_variavel</em>. O resultado, seria um gráfico com pontos de três formatos diferentes (triângulos, quadrados e pontos comuns).</p>
<p>Entretanto, para utilizarmos essa estratégia, nós tivemos que reestruturar a nossa base de dados pela função <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>. E se você não quisesse modificar essa base? Infelizmente, sem essa modificação, não poderíamos mostrar as três variáveis utilizando apenas uma função <code>geom</code>, mas poderíamos realizar o mesmo trabalho com uma função <code>geom</code> para cada variável. Neste caso, teremos que utilizar um <em>aesthetic mapping</em> diferente para cada <code>geom</code>, pois cada um deles, ficará responsável por mostrar os valores de uma variável diferente.</p>
<p>No primeiro gráfico dessa seção, utilizamos três <code>geom</code>’s diferentes para mostrar uma mesma informação. Se você comparar o código desse primeiro gráfico, ao código do gráfico abaixo, você perceberá que eles são quase idênticos, o que mudou, é a presença da função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> nos dois últimos <code>geom</code>’s.</p>
<p></p>
<div class="sourceCode" id="cb899"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">PIB</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Data</span>, y <span class="op">=</span> <span class="va">Faturamento_indus</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"darkgray"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">FBCF</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Divida_liq_perc</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-473-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>O único <code>geom</code> que não possui uma função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> definida, é o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, logo, esse <code>geom</code> vai seguir o <em>aesthetic mapping</em> que definimos em <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Já os outros dois <code>geom</code>’s, vão seguir o <em>aesthetic mapping</em> que definimos em seus respectivos <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Porém, repare que em ambos <code>geom</code>’s, eu apenas defini a variável mapeada para o eixo y, não cheguei a definir uma nova variável para o eixo x. Quando isso ocorre, a função irá novamente recorrer ao <em>aesthetic mapping</em> que você definiu em <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Ou seja, como não definimos uma nova variável para o eixo x, todos os <code>geom</code>’s do gráfico acabam utilizando a variável no eixo x definida em <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<p>Portanto, você pode sobrepor por completo, ou parcialmente, o <em>aesthetic mapping</em> definido em <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> em cada <code>geom</code>, basta omitir os termos dos quais você não deseja sobrepor na nova função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Um outro detalhe, é que não chegamos a definir em nenhum momento, um novo valor para o argumento <em>data</em> em algum <code>geom</code>. Logo, apesar de estarmos utilizando diferentes <em>aesthetic mappings</em>, todos os <code>geom</code>’s estão utilizando a mesma base de dados.</p>
<div id="resumo-da-estrutura-básica-de-um-gráfico-ggplot" class="section level3" number="8.5.1">
<h3>
<span class="header-section-number">8.5.1</span> Resumo da estrutura básica de um gráfico <code>ggplot()</code><a class="anchor" aria-label="anchor" href="#resumo-da-estrutura-b%C3%A1sica-de-um-gr%C3%A1fico-ggplot"><i class="fas fa-link"></i></a>
</h3>
<p>Em resumo, todo gráfico do <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> possui três camadas essenciais, que formam a base do gráfico: 1) <em>data</em>, a base (ou bases) de dados utilizada no gráfico em questão; 2) <em>aesthetic mapping</em>, o mapeamento, ou a ligação de variáveis presentes na base de dados, para componentes estéticos e visuais do gráfico; 3) <em>geom</em>, a forma geométrica (retângulos, pontos, polígonos, linhas, etc) que irá representar os seus dados no gráfico.</p>
<p>Para construir um gráfico do <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, você deve sempre definir esses componentes. Os dois primeiros (<em>data</em> e <em>aesthetic mapping</em>), podem ser definidas dentro da função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, já o terceiro (<em>geom</em>), você define ao utilizar uma (ou várias) das funções <code>geom</code>, em uma (ou em várias) das camadas do gráfico. Com isso, temos uma estrutura básica como a definida abaixo, para construirmos um gráfico do <code>ggplot</code>:</p>
<p></p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html#cb900-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb900-2"><a href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html#cb900-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="sc">&lt;</span>sua base de dados<span class="sc">&gt;</span>,</span>
<span id="cb900-3"><a href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html#cb900-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="sc">&lt;</span>aesthetic mapping<span class="sc">&gt;</span>)</span>
<span id="cb900-4"><a href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html#cb900-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb900-5"><a href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html#cb900-5" aria-hidden="true" tabindex="-1"></a>  <span class="er">&lt;</span>geom_...<span class="sc">&gt;</span> <span class="co">#uma função geom a seu gosto</span></span></code></pre></div>
<p></p>
<p>Lembre-se que essa é apenas uma estrutura básica. Como mostramos na seção 8.4, podemos sobrepor de diversas formas essa estrutura. E podemos definir diversos outros parâmetros sobre essa estrutura como foi mostrado ao longo do capítulo.</p>
</div>
</div>
<div id="uma-discussão-sobre-os-principais-geoms" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Uma discussão sobre os principais <code>geom</code>’s<a class="anchor" aria-label="anchor" href="#uma-discuss%C3%A3o-sobre-os-principais-geoms"><i class="fas fa-link"></i></a>
</h2>
<p>Nas próximas seções vamos descrever rapidamente como grande parte dos principais <code>geom</code>’s se comportam, e quais são os argumentos (ou os componentes estéticos) que podemos controlar através da função <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Dessa forma, você pode rapidamente se familiarizar com esses <code>geom</code>’s, adquirindo um vocabulário das funções que os representam, e que cobrem a maior parte dos gráficos realizados no dia-a-dia.</p>
<p>Lembre-se que há várias funções <code>geom</code> diferentes, das quais muitas não serão descritas aqui. Muitas deles utilizam o mesmo formato geométrico (linhas, retângulos, …), mas desenham esse formato de uma maneira diferente, além de possuírem outros componentes estéticos que podem ser controlados pelo <em>aesthetic mapping</em> do gráfico.</p>
<p>Caso você não encontre aqui, o formato geométrico que está procurando, ou a função <code>geom</code> que realiza o desenho da forma como você deseja, você pode consultar a página oficial do pacote<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://ggplot2.tidyverse.org/reference/index.html" class="uri"&gt;https://ggplot2.tidyverse.org/reference/index.html&lt;/a&gt;&lt;/p&gt;'><sup>24</sup></a>. A página não possui uma versão em português, porém, você deve se virar razoavelmente bem com ferramentas de tradução (como o Google Tradutor) nessas situações. Se isso não for suficiente, você talvez encontre suas dúvidas em outros materiais construídos por brasileiros, como o blog <em>Curso R</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.curso-r.com/material/ggplot/" class="uri"&gt;https://www.curso-r.com/material/ggplot/&lt;/a&gt;&lt;/p&gt;'><sup>25</sup></a>, o material do departamento de Estatística da UFPR<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="http://www.leg.ufpr.br/~walmes/cursoR/data-vis/index.html" class="uri"&gt;http://www.leg.ufpr.br/~walmes/cursoR/data-vis/index.html&lt;/a&gt;&lt;/p&gt;'><sup>26</sup></a>, ou dentro de alguma pergunta postada na página em português do <em>StackOverflow</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://pt.stackoverflow.com/" class="uri"&gt;https://pt.stackoverflow.com/&lt;/a&gt;&lt;/p&gt;'><sup>27</sup></a>. O <em>R Graph Gallery</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.r-graph-gallery.com/" class="uri"&gt;https://www.r-graph-gallery.com/&lt;/a&gt;&lt;/p&gt;'><sup>28</sup></a> é um repositório (em inglês) que possui exemplos dos mais diversos <code>geom</code>’s, e que serve como a referência perfeita para os momentos em que você não lembra qual o <code>geom</code> que desenha o tipo de gráfico que procura.</p>
<div id="gráficos-de-dispersão-e-gráficos-de-bolha" class="section level3" number="8.6.1">
<h3>
<span class="header-section-number">8.6.1</span> Gráficos de dispersão e gráficos de bolha<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-dispers%C3%A3o-e-gr%C3%A1ficos-de-bolha"><i class="fas fa-link"></i></a>
</h3>
<p>Gráficos de dispersão são formados por <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>. Esse <code>geom</code> (por padrão) não transforma os seus dados, ou em outras palavras, ele não busca resumi-los de alguma maneira. Cada ponto desenhado no plano cartesiano representa cada uma das linhas presentes em sua base de dados. Os <code>geom</code>s que possuem este comportamento, são comumente chamados de <code>geom</code>’s individuais. Por este padrão, você deve obrigatoriamente definir as variáveis de ambos os eixos (x e y), neste <code>geom</code>.</p>
<p>Nos exemplos abaixo, estou utilizando a tabela <code>mpg</code> que vêm junto do <code>ggplot</code>, e nos apresenta dados de consumo de combustível de diversos modelos de carro, para mais detalhes desses dados, execute <code><a href="https://ggplot2.tidyverse.org/reference/mpg.html">?mpg</a></code> no console. Os gráficos nos mostram uma relação aparentemente negativa entre volume ocupado pelos pistões no motor (<code>displ</code>), e a quilometragem por litro de gasolina (<code>hwy</code>).</p>
<p>Após definir os eixos, você pode pintar os pontos de acordo com uma terceira variável, por exemplo, a classe do carro (compacto, SUV, minivan, …), através do argumento <em>color</em>. A classe do carro é uma variável categórica, e por isso, o <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> irá buscar cores contrastantes para pintar os pontos. Mas você também pode definir uma variável contínua a este argumento, onde neste caso, o <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> irá criar um gradiente de cores para pintar os pontos. Uma outra possibilidade deste <code>geom</code>, é variar o formato dos pontos através do argumento <em>shape</em>.</p>
<p>A partir de <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> você também pode construir um gráfico de bolha, através do argumento <em>size</em>. Este tipo de gráfico em geral, piora o <em>overplotting</em>, ou a sobreposição dos pontos, já que alguns ficam muito grandes. Nestas situações, o argumento <em>alpha</em> é bem útil, sendo ele definido por um número de 0 a 1, indicando uma porcentagem de opacidade do <code>geom</code>. Por padrão, ele é configurado para 1 (100%), já no exemplo, eu reduzo essa opacidade para 40%.</p>
<p></p>
<div class="sourceCode" id="cb901"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-475-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p></p>
<div class="sourceCode" id="cb902"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-476-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p></p>
<div class="sourceCode" id="cb903"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, color <span class="op">=</span> <span class="va">class</span>, shape <span class="op">=</span> <span class="va">drv</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-477-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p></p>
<div class="sourceCode" id="cb904"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, size <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-478-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Você pode se aproveitar do componente <em>shape</em> para diferenciar, ou destacar as bordas dos pontos, ao escolher o <em>shape</em> 21. Este método é esteticamente atraente, e fica muito bom em conjunto com linhas. Dessa forma, você pode pintar o interior dos pontos de uma cor, utilizando <em>fill</em>, e a borda desse ponto de outra cor, utilizando <em>color</em>. Lembre-se que isso só é possível, pelo <em>shape</em> que escolhemos para estes pontos, em outras situações, você poderá colorir pontos apenas com uma cor, utilizando o <em>color</em>. No exemplo abaixo, eu deixo todos os três argumentos de fora de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, dessa forma, o <code>ggplot</code> mantém os valores que dei a cada um deles, constantes ao longo de todo o gráfico.</p>
<p></p>
<div class="sourceCode" id="cb905"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>,
    shape <span class="op">=</span> <span class="fl">21</span>,
    color <span class="op">=</span> <span class="st">"black"</span>,
    fill <span class="op">=</span> <span class="st">"steelblue"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-479-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
</div>
<div id="gráficos-de-barra" class="section level3" number="8.6.2">
<h3>
<span class="header-section-number">8.6.2</span> Gráficos de barra<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-barra"><i class="fas fa-link"></i></a>
</h3>
<p>Como descrevi anteriormente, os gráficos de barras no <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> são formados pelo <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, e em geral, são utilizados para apresentar estatísticas que resumem os dados em poucos números (como totais, médias, medianas). Em outras palavras, os <code>geom</code>’s que tem este comportamento, buscam representar várias observações de sua base, com um único formato geométrico, e são comumente chamados de <code>geom</code>’s coletivos. Por essa razão, o argumento <em>stat</em> é importante neste <code>geom</code>, pois nele você pode conceder o valor <em>identity</em>, que evita este comportamento, e faz com que o <code>geom</code> apenas identifique os valores que você fornece a ele.</p>
<p>No <code>ggplot</code>, este <code>geom</code> foi criado com o intuito de permitir que o usuário construa rapidamente gráficos de contagens e somatórios. Portanto, este <code>geom</code> possui mecanismos para calcular essas estatísticas, você não precisa calculá-las por conta própria antes de gerar o <code>ggplot</code>. Por padrão, este <code>geom</code> calcula inicialmente uma contagem dos seus dados. Logo, caso você não defina qual a estatística que deseja mostrar, ele irá contar a quantidade que cada valor aparece na base. Por exemplo, o gráfico abaixo nos mostra que dentro da tabela <code>mpg</code>, temos em torno de 80 modelos com motores de 4 ou 6 cilindradas, e menos de 10 modelos com 5 cilindradas.</p>
<p></p>
<div class="sourceCode" id="cb906"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">mpg</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-480-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Tendo essas considerações em mente, você tem duas opções básicas ao lidar com este <code>geom</code>: 1) fornecer diretamente os dados, e pedir ao <code>geom</code> que calcule as estatísticas que você deseja mostrar (contagem ou somatório); ou 2) você primeiro calcula as estatísticas que deseja, e pede ao <code>geom</code> que apenas as identifique, sem realizar nenhuma transformação desses dados. Caso opte pela opção 2, você deve <strong>tomar muito cuidado</strong> com o argumento <code>stat = "identity"</code>, por razões que vou explicar abaixo.</p>
<p>Este <code>geom</code> não possui um mecanismo próprio para calcular médias (e muitas outras estatísticas), e portanto, se você quiser mostrá-las utilizando este <code>geom</code>, você terá de calcular separadamente essas médias, e pedir ao <code>geom</code> que apenas as identifique com <code>stat = "identity"</code>.</p>
<p></p>
<div class="sourceCode" id="cb907"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">medias</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span>

  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">medias</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, y <span class="op">=</span> <span class="va">media</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-481-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Porém, caso você queira calcular o total, ou o somatório em cada grupo, você pode apenas definir a coluna com os valores a serem somados, para o argumento <em>weight</em> dentro de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb908"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">mpg</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, weight <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-482-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Agora, lembra quando eu disse que você pode pedir ao <code>geom</code> que apenas “identifique” os valores de sua base (com <code>stat = "identity"</code>) ? Com este argumento, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> irá ter um comportamento diferente, caso os valores em cada grupo não sejam únicos. No exemplo anterior, em que calculei as médias de cada <code>cyl</code> em <code>mpg</code>, o <code>geom</code> apenas identificou as médias de cada <code>cyl</code>, pois há apenas <strong>uma única</strong> média para cada <code>cyl</code>. No exemplo abaixo, estou criando rapidamente uma tabela, e nela você pode perceber que há dois valores para o grupo <code>"c"</code>. Agora, repare o que acontece no gráfico, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> acaba somando estes valores.</p>
<p></p>
<div class="sourceCode" id="cb909"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  grupo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"c"</span>,<span class="st">"d"</span><span class="op">)</span>,
  valor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grupo</span>, y <span class="op">=</span> <span class="va">valor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-483-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Em outras palavras, se os seus dados estiverem <strong>agrupados</strong>, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> com <code>stat = "identity"</code> irá de fato apenas identificar estes valores. Mas caso os seus dados estiverem desagregados, com mais de um valor por grupo, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> irá somar estes valores. Isso significa, que <code>stat = "identity"</code> representa uma outra alternativa (além de <em>weight</em>), para criar gráficos de somatório. Bastaria fornecer a coluna com os valores a serem somados para o eixo y em <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, e adicionar <code>stat = "identity"</code> à <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>.</p>
<p>Um outro ponto importante neste <code>geom</code>, é o posicionamento das barras. Por padrão, o <code>geom</code> empilha barras que ocupam o mesmo valor no eixo x no gráfico. Isso nos permite visualizarmos a participação dos grupos de uma outra variável categórica (cor de pele, faixa etária, …), em cada valor presente no eixo x. Por outro lado, você talvez esteja interessado na diferença entre os grupos, e não a sua participação. Logo, você talvez queira jogar essas barras uma do lado da outra, e para isso você deve utilizar o argumento <em>position</em>, dando o valor <em>“dodge”</em>. No exemplo abaixo, retorno a base de dados <code>datasus</code>, com o objetivo de mostrar a diferença em cada cor de pele, da média de vítimas para cada sexo.</p>
<p></p>
<div class="sourceCode" id="cb910"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">medias</span> <span class="op">&lt;-</span> <span class="va">datasus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Cor</span>, <span class="va">Genero</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>media <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Contagem</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Cor'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb912"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">medias</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Cor</span>, y <span class="op">=</span> <span class="va">media</span>, fill <span class="op">=</span> <span class="va">Genero</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-484-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Portanto, caso você não definisse <em>position</em> para <em>dodge</em>, o <code>ggplot</code> iria empilhar essas barras (azul e vermelho) uma em cima da outra. Em um gráfico de médias como o acima, não faria muito sentido empilhar essas barras, porém, este posicionamento faz muito sentido em gráficos de somatório, como os que fizemos na seção 8.3. Pois dessa forma você consegue visualizar o quanto que cada grupo representa do total.</p>
<p>Você talvez queira ir um pouco além, e observar as diferenças na participação de cada cor de pele, ao longo dos totais de vários grupos. Para isso, você pode dar o valor <em>fill</em> ao argumento <em>position</em>. Dessa forma, o <code>ggplot</code> calcula qual é a proporção de cada grupo para cada valor do eixo x, em uma escala de 0 a 1. Nesta situação, você deve definir a variável do eixo y, para o argumento <em>weight</em> em <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb913"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">datasus</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Faixa etaria`</span>, weight <span class="op">=</span> <span class="va">Contagem</span>, fill <span class="op">=</span> <span class="va">Cor</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-485-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
</div>
<div id="gráficos-de-linha" class="section level3" number="8.6.3">
<h3>
<span class="header-section-number">8.6.3</span> Gráficos de linha<a class="anchor" aria-label="anchor" href="#gr%C3%A1ficos-de-linha"><i class="fas fa-link"></i></a>
</h3>
<p>Gráficos de linha são muito utilizados em séries temporais, para mostrar a evolução de algum índice ao longo do tempo. Este tipo de gráfico é criado pelo <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>, que possui um comportamento de “conector.”</p>
<p>O <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> (diferentemente de seu irmão <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path()</a></code>) sempre ordena os valores da base (antes de conectá-los), segundo a variável alocada no eixo x, na ordem que seja mais lógica para essa variável. Veja o exemplo abaixo, onde dou um vetor de datas (fora de ordem) para o eixo x. Independente da ordem em que os valores estiverem em sua base, a função irá reordenar a base antes de conectar os pontos.</p>
<p></p>
<div class="sourceCode" id="cb914"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  dia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2020-01-01"</span>,<span class="st">"2020-01-04"</span>,<span class="st">"2020-01-02"</span>,<span class="st">"2020-01-03"</span><span class="op">)</span><span class="op">)</span>,
  valor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">27</span>,<span class="fl">14</span>,<span class="fl">23</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dia</span>, <span class="va">valor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-486-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Isso significa, que este <code>geom</code> funciona com qualquer variável no eixo x que possua uma ordem lógica, seja ela contínua ou categórica. Veja no exemplo abaixo, onde eu substituo a coluna <code>dia</code>, por um simples vetor de texto. Ao detectar o tipo de dado presente na coluna, a função reordena os valores de acordo com a ordem lógica para este tipo de dado (no exemplo abaixo, ordem alfabética).</p>
<p></p>
<div class="sourceCode" id="cb915"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab</span><span class="op">$</span><span class="va">dia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>,<span class="st">"b"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">dia</span>, <span class="va">valor</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-487-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Conhecer essa funcionalidade é importante, ao fornecer para o <code>geom</code> dados dos quais ele não consegue reconhecer o formato e a ordem correta. Pense por exemplo, se você fornecesse um vetor de datas, mas no formato “abril/2020.” Como os valores começam por um nome, ele reconhece estes valores como texto, e, portanto, ordena-os em ordem alfabética, ao invés de ordená-los como meses do ano. Nessas situações, transformar esses valores para fatores, e definir a sua ordem em seu atributo <code>levels</code>, é a melhor alternativa.</p>
<p></p>
<div class="sourceCode" id="cb916"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab</span><span class="op">$</span><span class="va">dia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Janeiro/2020"</span>, <span class="st">"Abril/2020"</span>, <span class="st">"Fevereiro/2020"</span>, <span class="st">"Março/2020"</span><span class="op">)</span>

<span class="va">ordem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Janeiro/2020"</span>, <span class="st">"Fevereiro/2020"</span>, <span class="st">"Março/2020"</span>, <span class="st">"Abril/2020"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
    <span class="va">tab</span>,
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">dia</span>, levels <span class="op">=</span> <span class="va">ordem</span><span class="op">)</span>, <span class="va">valor</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-488-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Eu costumo aumentar a grossura dessas linhas através do argumento <em>size</em>, que por padrão está configurado para 0.5. Geralmente 1 já é um bom nível para mim, mas você pode aumentar o quanto quiser. Como eu quero que a grossura, permaneça constante ao longo de toda a linha, eu mantenho o argumento <em>size</em> de fora do <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Isso significa que você poderia variar essa grossura ao longo da linha, apesar de que o resultado seria um tanto esquisito. Tente por exemplo, adicionar ao <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> do exemplo anterior, o valor <code>size = valor</code>, e veja o resultado.</p>
<p>Neste <code>geom</code>, o argumento <em>group</em> em <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code> é muito importante. Este argumento controla como o <code>geom</code> considera os grupos da base, na hora de desenhar o formato geométrico em questão. No primeiro exemplo dessa seção, nós não utilizamos este argumento, pois a variável ligado ao eixo x (<code>dia</code>) era uma variável contínua. Entretanto, no instante em que mudamos os valores dessa coluna para texto, tivemos que adicionar um <code>group = 1</code> ao <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Logo, quando você ligar uma variável contínua ao eixo x, muito provavelmente você não precisará mexer com o <em>group</em>. Caso a variável seja categórica, é certo que algum valor deve ser dado ao argumento <em>group</em>.</p>
<p>Isso é apenas uma simplificação, que serve como um guia inicial, mas que nem sempre se aplica. Pois o <em>group</em> não diz respeito ao tipo de variável (contínua ou categórica), e sim se você quer separar ou não as linhas por algum agrupamento. Se você está apenas querendo mostrar uma única linha no gráfico, essa simplificação será útil. Mas com o tempo você vai se pegar utilizando o <em>group</em>, para mostrar em um mesmo gráfico a evolução de vários índices diferentes ao longo do tempo, mesmo que a variável no eixo x (datas) seja uma variável contínua. Basta relembrar o exemplo da seção 8.4, em que utilizamos <em>linetype</em> para diferenciar as curvas de três indicadores diferentes em um mesmo <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>. Você poderia replicar o mesmo gráfico utilizando <em>group</em>, ao invés do <em>linetype</em>.</p>
<p>Essa questão fica mais clara, ao utilizarmos uma base que possui mais de um valor por grupo. Veja por exemplo a base <code>Oxboys</code>, que vem do pacote <code>mlmRev</code>. Essa base é resultado de uma pesquisa, onde os pesquisadores acompanharam durante vários anos, o crescimento de alguns indivíduos.</p>
<p></p>
<div class="sourceCode" id="cb917"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">mlmRev</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mlmRev/man/Oxboys.html">Oxboys</a></span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>##    Subject     age height Occasion
## 1        1 -1.0000  140.5        1
## 2        1 -0.7479  143.4        2
## 3        1 -0.4630  144.8        3
## 4        1 -0.1643  147.1        4
## 5        1 -0.0027  147.7        5
## 6        1  0.2466  150.2        6
## 7        1  0.5562  151.7        7
## 8        1  0.7781  153.3        8
## 9        1  0.9945  155.8        9
## 10       2 -1.0000  136.9        1</code></pre>
<p></p>
<p>Portanto, a coluna <code>Subject</code> identifica qual o indivíduo os valores da linha se referem. Repare que várias linhas dizem respeito ao mesmo indivíduo. Agora, pense como o <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> trataria esses diversos valores que se encaixam no mesmo grupo (no nosso caso, no mesmo <code>Subject</code>). Neste caso, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> irá conectar (incorretamente) todos os valores em conjunto da base, pois ele não sabe que cada um desses valores pertence a sujeitos diferentes, o <code>geom</code> pensa que todos esses valores pertencem a um único sujeito. O resultado seria um gráfico com um aspecto de “serra.”</p>
<p></p>
<div class="sourceCode" id="cb919"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">Oxboys</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">height</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-491-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Para que isso fique claro, eu adicionei um <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> para que você veja cada um dos valores presentes na base. Primeiro, preste atenção nas variáveis que conectamos aos eixos do gráfico (idade e altura do indivíduo). Ambas as variáveis são contínuas, mas neste momento, não há qualquer variável no gráfico que possa identificar a qual dos indivíduos, cada um desses valores se refere. Logo, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> acaba conectando todos esses pontos juntos.</p>
<p></p>
<div class="sourceCode" id="cb920"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">Oxboys</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">height</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-492-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Ao invés do <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> conectar todos esses pontos em conjunto, o <code>geom</code> deveria conectar todos os pontos que dizem respeito ao mesmo indivíduo, e é para isso que o argumento <code>group</code> serve. Você define neste argumento, qual a coluna que identifica qual é o grupo (ou no nosso caso, o indivíduo) que está sendo tratado em cada observação de sua base de dados.</p>
<p></p>
<div class="sourceCode" id="cb921"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">Oxboys</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">height</span>, group <span class="op">=</span> <span class="va">Subject</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-493-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Uma outra forma de definirmos esses grupos para o <code>geom</code>, é colorindo as linhas com o argumento <em>color</em>, ou então variando o formato dessas linhas com o argumento <em>linetype</em>. Basta você fornecer a estes argumentos, uma coluna que seja capaz de identificar cada um dos grupos ou indivíduos (no nosso caso, <code>Subject</code>) que estão sendo tratados no gráfico.</p>
<p></p>
<div class="sourceCode" id="cb922"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">Oxboys</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">height</span>, color <span class="op">=</span> <span class="va">Subject</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-494-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Portanto, toda vez em que utilizar este <code>geom</code> em uma base que possui mais de um valor por grupo, você muito provavelmente terá de utilizar <em>group</em>, especialmente se você precisa diferenciar as curvas de cada grupo no gráfico.</p>
<p>Se você quiser mostrar uma única linha no gráfico, você vai mexer obrigatoriamente com o <em>group</em> caso a variável do eixo x seja categórica, onde neste caso, você deve dar uma constante qualquer ao argumento (eu geralmente defino para 1: <code>aes(group = 1)</code>). Isso é necessário, porque <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> entende que cada um dos valores dessa variável categórica, representa um grupo diferente. Dessa forma, cada um desses grupos irá possuir apenas um valor em toda a base. Caso você se esqueça de definir este valor para <em>group</em> nesta situação, o seguinte erro irá aparecer:</p>
<p></p>
<pre class="text"><code># Each group consists of only one observation. Do you need to adjust the group
# aesthetic?</code></pre>
<p></p>
</div>
<div id="histogramas-e-outros-gráficos-de-frequência" class="section level3" number="8.6.4">
<h3>
<span class="header-section-number">8.6.4</span> Histogramas e outros gráficos de frequência<a class="anchor" aria-label="anchor" href="#histogramas-e-outros-gr%C3%A1ficos-de-frequ%C3%AAncia"><i class="fas fa-link"></i></a>
</h3>
<p>Histogramas e polígonos de frequência são gráficos “unidimensionais,” ou dito de outra forma, apresentam informações sobre apenas uma variável, mais especificamente uma variável contínua. Por essa razão, você precisa definir apenas um dos eixos do gráfico, geralmente, o eixo x. Estes gráficos são criados por <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> e <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb924"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-496-1.png" width="60%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb926"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-496-2.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Ambos os gráficos funcionam da mesma forma, apenas a forma geométrica utilizada é diferente. Eles pegam a distribuição da variável ligada ao eixo x, e dividem essa distribuição em vários intervalos (chamados de <em>bin</em>’s), e contam quantos valores se encaixam em cada um destes intervalos. Neste <code>geom</code>, é importante que você teste diferentes larguras para estes intervalos, através do argumento <em>binwidth</em>. Por padrão, o <code>geom</code> tenta dividir a distribuição em 30 intervalos diferentes.</p>
<p>Você pode separar as distribuições por alguma variável categórica, dando essa variável ao argumento <em>group</em>. Porém, essas distribuições estarão sobrepostas no gráfico, sendo impossível diferenciá-las. Logo, é necessário que você mostre essas distribuições separadas em diferentes facetas do gráfico (através da função <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>).</p>
<p></p>
<div class="sourceCode" id="cb928"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span>, group <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-497-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>O <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly()</a></code> não sofre seriamente deste problema, pois a sua forma geométrica é “oca.” Mas é interessante de qualquer forma, que você ou separe essas distribuições em diferentes facetas do gráfico, ou então, que colora as distribuições de acordo com a variável categórica utilizada.</p>
<p></p>
<div class="sourceCode" id="cb930"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span>, color <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-498-1.png" width="60%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb932"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-498-2.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Uma alternativa a estes <code>geom</code>’s, é o <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> que calcula uma função de densidade para a variável escolhida. Caso esteja interessado em separar essa distribuição de acordo com uma variável categórica, eu recomendo que dê uma olhada no pacote <code>ggridges</code>. Este pacote fornece novos <code>geom</code>’s, que posicionam essas distribuições separadas de uma forma esteticamente atraente, sem a necessidade de construir diferentes facetas do mesmo gráfico, além de fornecer mecanismos para marcar os percentis da distribuição no gráfico. É mais fácil ver com seus próprios olhos,<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Veja a página oficial do pacote: &lt;a href="https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html" class="uri"&gt;https://cran.r-project.org/web/packages/ggridges/vignettes/introduction.html&lt;/a&gt;&lt;/p&gt;'><sup>29</sup></a> do que eu explicar.</p>
<p>Caso você prefira permanecer com o <code>geom</code> padrão do <code>ggplot</code> e ainda separar a distribuição por uma variável categórica, você pode utilizar o argumento <em>alpha</em> para reduzir a opacidade dessas distribuições, como um meio de combater a sobreposição. Mas o ideal, é que você as separe em diferentes facetas, utilizando <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> da mesma forma que fizemos para os histogramas.</p>
<p></p>
<div class="sourceCode" id="cb934"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">hwy</span>, fill <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-499-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
</div>
<div id="adicionando-textos-ao-gráfico" class="section level3" number="8.6.5">
<h3>
<span class="header-section-number">8.6.5</span> Adicionando textos ao gráfico<a class="anchor" aria-label="anchor" href="#adicionando-textos-ao-gr%C3%A1fico"><i class="fas fa-link"></i></a>
</h3>
<p>Você pode adicionar rótulos ao seu gráfico com <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label()</a></code>, ou adicionar textos simples com <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>. Estes <code>geom</code>’s funcionam exatamente como o <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, porém, ao invés de desenharem pontos, eles desenham textos. Em outras palavras, eles são <code>geom</code>’s individuais, em que desenham um texto, ou um rótulo, para cada uma das observações de sua base de dados.</p>
<p>Dessa vez, você deve definir a coluna que contém os rótulos/textos que deseja mostrar no gráfico, no argumento <em>label</em> em <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Os rótulos serão posicionados no plano cartesiano de acordo com os valores definidos pelas variáveis ligadas aos eixos x e y.</p>
<p></p>
<div class="sourceCode" id="cb935"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-500-1.png" width="60%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb936"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-500-2.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Ao colocar textos em um gráfico, você dificilmente não enfrentará algum nível de sobreposição. O <code>ggplot</code> oferece algumas ferramentas que em muitas ocasiões não resolvem o problema, mas que em outras podem ser suficientes. Ambos os <code>geom</code>’s descritos aqui, possuem o argumento <em>check_overlap</em>. Caso ele seja configurado para <code>TRUE</code>, o <code>ggplot</code> irá criar os rótulos na ordem em que eles aparecem na sua base, e eliminar todos os rótulos consecutivos que sobreporem os anteriores. O código ficaria dessa forma:</p>
<p></p>
<div class="sourceCode" id="cb937"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>check_overlap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Apesar de uma solução, ela pode muito bem eliminar justamente os rótulos que queremos destacar no gráfico, e por isso é pouco desejada. Você poderia também reduzir o tamanho da fonte através de <em>size</em>. Um detalhe é que este argumento trabalha por padrão com valores em milímetros (mm), mas como é um pouco confuso trabalhar com tamanho de fontes nesta unidade, eu geralmente transformo os valores para pontos (pt). No exemplo abaixo, estou reduzindo o tamanho das fontes para 7 pt. O problema dessa opção, é que ela representa um <em>trade-off</em> entre a sobreposição de pontos, e a legibilidade dos rótulos, cabe a você definir o equilíbrio entre essas opções.</p>
<p></p>
<div class="sourceCode" id="cb938"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span>, label <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">/</span><span class="va">.pt</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-502-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>A melhor solução possível, seria ajustarmos a posição de cada um dos pontos individualmente. Entretanto, se você tem vários textos que exigem desvios diferentes, essa solução facilmente se torna muito trabalhosa. A ideia, seria criarmos duas novas colunas em nosso <code>data.frame</code>, onde em cada uma você define um valor de desvio vertical (<code>y_desvio</code>), e na outra o valor de desvio horizontal (<code>x_desvio</code>) para o rótulo definido naquela linha. Em seguida, você conecta essas colunas aos argumentos de posição responsáveis por realizar estes deslocamentos de textos (<em>nudge_y</em> e <em>nudge_x</em>) em seu <em>aesthetic mapping</em> (<code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>). Veja o código abaixo.</p>
<p></p>
<div class="sourceCode" id="cb939"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  <span class="va">mpg</span>,
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">displ</span>,
    y <span class="op">=</span> <span class="va">hwy</span>,
    label <span class="op">=</span> <span class="va">model</span>,
    nudge_x <span class="op">=</span> <span class="va">x_desvio</span>,
    nudge_y <span class="op">=</span> <span class="va">y_desvio</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Vamos separar uma seção para descrevermos outras soluções mais eficazes para esse problema. Também vamos separar, uma seção para descrevermos quais são as estratégias possíveis para você trocar a fonte dos textos mostrados no gráfico, algo que ainda é difícil de ser realizado, especialmente se você trabalha no Windows. Agora vou explicar o que os argumentos de posição (<em>nudge_x</em> e <em>nudge_y</em>), e os de justificação (<em>hjust</em> e <em>vjust</em>) fazem.</p>
<p>Durante muito tempo, eu sofri de uma leve confusão entre esses argumentos. Como você muito provavelmente vai querer ajustar o posicionamento desses textos, vou tentar explicar a diferença entre os dois da forma mais clara possível, para que você não sofra do mesmo efeito.</p>
<p>Vamos começar pelos argumentos de justificação, que são <em>hjust</em> (justificação horizontal) e <em>vjust</em> (justificação vertical). Estes argumentos, servem para alterar a justificação, ou o alinhamento da cadeia de texto em relação ao seu ponto de referência (ou de coordenadas).</p>
<p></p>
<div class="sourceCode" id="cb940"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,
  text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"bottom-left"</span>, <span class="st">"bottom-right"</span>,
    <span class="st">"top-left"</span>, <span class="st">"top-right"</span>, <span class="st">"center"</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkgray"</span>, size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">text</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-504-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Por padrão, <em>hjust</em> é configurado para <em>center</em>, e <em>vjust</em> para <em>middle</em>. Logo, todos os rótulos são centralizados (tanto verticalmente, quanto horizontalmente) no ponto que define a sua localização. Para mudar o alinhamento de todos os rótulos de uma vez, você pode configurar estes argumentos, por fora do <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, fornecendo um dos valores pré-definidos.</p>
<p>No caso de <em>hjust</em>, há outros quatro valores pré-definidos possíveis (<em>left, right, inward, outward</em>). Caso você coloque <em>left</em> ou <em>right</em> neste argumento, todos os rótulos serão alinhados à esquerda, ou à direita dos pontos. Porém, caso você coloque <em>inward</em> ou <em>outward</em>, os textos serão alinhados (horizontalmente em relação aos pontos de sua localização) em um sentido para o para o centro do gráfico, ou se afastando do centro do gráfico. Dito de outra forma, os textos serão alinhados à esquerda, ou à direita do ponto de referência, a depender da sua localização em relação ao centro do plano cartesiano e do sentido escolhido (<em>inward</em> ou <em>outward</em>).</p>
<p>Para <em>vjust</em>, há também quatro outros valores pré-definidos (<em>bottom, top, inward, outward</em>). Os valores <em>bottom</em> e <em>top</em> alinham os textos na base ou no topo do ponto de referência do texto. Enquanto os valores <em>inward</em> e <em>outward</em> funcionam no mesmo sentido que em <em>hjust</em>, porém eles controlam o alinhamento vertical dos textos.</p>
<p></p>
<div class="sourceCode" id="cb941"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray"</span>, size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">text</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="st">"inward"</span>, hjust <span class="op">=</span> <span class="st">"inward"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-505-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Para deixar claro o que estes argumentos fazem, trago um novo exemplo abaixo que contém cadeias de texto de duas linhas. Caso você queira variar a justificação destes textos, ao longo do gráfico, significa que você deve conectar uma coluna de seu <code>data.frame</code> a estes argumentos em <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Porém, estes argumentos não aceitam os valores pré-definidos ao estarem dentro de <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>. Nestas situações, você deve fornecer um número: 0 (justificado à esquerda); 0.5 (centralizado); ou 1 (justificado à direita).</p>
<p></p>
<div class="sourceCode" id="cb942"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, times <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  texto <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Um texto alinhado\nà esquerda"</span>,
            <span class="st">"Um texto\ncentralizado"</span>,
            <span class="st">"Um texto alinhado\nà direita"</span><span class="op">)</span>,
            each <span class="op">=</span> <span class="fl">3</span>
          <span class="op">)</span>,
  hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
  vjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span>, color <span class="op">=</span> <span class="st">"darkgray"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    label <span class="op">=</span> <span class="va">texto</span>,
    hjust <span class="op">=</span> <span class="va">hjust</span>,
    vjust <span class="op">=</span> <span class="va">vjust</span>
  <span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-506-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Eu acredito que é justamente essa opção numérica, que gera toda a confusão sobre a função verdadeira destes argumentos. Pois o <code>ggplot</code> não gera nenhum erro caso você dê valores diferentes, e se você aumentar progressivamente estes valores, você irá perceber que o deslocamento dos textos também aumenta. Muitos que se deparam com este comportamento, podem acreditar que estes argumentos servem para deslocar os textos, e não para alinhá-los em relação ao ponto de suas coordenadas. Por isso eu recomendo nestes argumentos, que você utilize um dos valores pré-definidos que citei anteriormente, e utilize essa escala numérica, apenas em situações em que você precisa dessa variação utilizando <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>.</p>
<p>Uma outra razão pela qual estes argumentos não são apropriados, caso você queira deslocar os textos em um sentido, é que eles não trabalham em sintonia com as escalas dos eixos. No exemplo abaixo, eu configuro o valor de <em>vjust</em> para -4. Porém, o <code>ggplot</code> não deslocou verticalmente os textos em 4 unidades. O texto de valor <em>center</em>, por exemplo, não foi deslocado para as coordenadas (x = 1.5, y = 5.5), e se você quiser que ele chegue nessa coordenada? O que você faz? Triplica? Quadruplica o valor anterior? Tudo isso, significa que não há como você prever o quanto o texto irá deslocar, e por isso, você pode perder muito tempo testando diversos valores em um argumento inadequado para o resultado que deseja.</p>
<p></p>
<div class="sourceCode" id="cb943"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray"</span>, size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">text</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-507-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Agora, vou explicar como os argumentos de posição funcionam. Como o próprio sufixo deles dá a entender, o <em>nudge_y</em> irá deslocar verticalmente os textos, e <em>nudge_x</em>, vai deslocá-los horizontalmente. O verbo <em>nudge</em> em inglês se refere ao ato de “cutucar,” ou empurrar gentilmente alguém, logo, estes argumentos servem para “empurrar” os textos de suas posições originais no plano cartesiano. Para demonstrarmos a sua aplicação, vamos tentar rotular um gráfico de barras, que apresente um somatório da quilometragem em cada cilindro.</p>
<p>Como descrevi anteriormente, o <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> é um <code>geom</code> coletivo, enquanto os <code>geom</code>’s de texto são <code>geom</code>’s individuais. Por isso, caso você adicionar diretamente um <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> ao <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, sem levar em conta essa diferença, ele irá rotular cada uma das observações da base resumidas em cada barra, e não o total que ela representa.</p>
<p>Para rotular corretamente essas barras, você tem duas opções: 1) calcular o somatório em um objeto separado, e em seguida fornecer este objeto ao argumento <em>data</em>, e ajustar o <em>aesthetic mapping</em> de acordo com este objeto, em <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>; ou 2) usar as transformações estatísticas que o <code>ggplot</code> já disponibiliza para esse trabalho. No exemplo abaixo, estou demonstrando a opção 1, mas darei um exemplo da opção 2 quando chegarmos à seção de transformações estatísticas do <code>ggplot</code>.</p>
<p></p>
<div class="sourceCode" id="cb944"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">somatorios</span> <span class="op">&lt;-</span> <span class="va">mpg</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>soma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">hwy</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, weight <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">mpg</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, y <span class="op">=</span> <span class="va">soma</span>, label <span class="op">=</span> <span class="va">soma</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">somatorios</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-508-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Portanto, neste exemplo as duas camadas de <code>geom</code> utilizam não apenas <em>aesthetic mapping</em>’s, mas também fontes de dados, diferentes. Como você pode reparar acima, os rótulos estão sobre o topo da barra. Por isso, eu posso utilizar o <em>nudge_y</em> para adicionar um pequeno desvio vertical nestes rótulos, dando assim um maior espaço entre ele e a barra.</p>
<p>Diferentemente dos argumentos de alinhamento, os argumentos de posição (<em>nudge_y</em> e <em>nudge_x</em>) funcionam em sintonia com a escala dos eixos. Como a escala do eixo y termina em aproximadamente 2500, um desvio de 100 é provavelmente suficiente. Isso significa que caso o limite dessa escala fosse 1 décimo disso (250), por exemplo, um desvio de 100 em <em>nudge_y</em> iria gerar um deslocamento considerável nestes rótulos.</p>
<p></p>
<div class="sourceCode" id="cb945"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, weight <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">mpg</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, y <span class="op">=</span> <span class="va">soma</span>, label <span class="op">=</span> <span class="va">soma</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">somatorios</span>, 
    nudge_y <span class="op">=</span> <span class="fl">100</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-509-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p>Além dessas opções, caso você insira textos de 2 ou mais linhas no gráfico, você pode se interessar em reduzir ou aumentar o espaço entrelinhas destes textos. Neste caso, você pode controlar este espaço pelo argumento <em>lineheight</em> que define a proporção em relação à altura das letras. Um outro ponto possível de customização, é o ângulo dos textos, que é definido pelo argumento <em>angle</em>. Neste argumento, basta fornecer um número (de 0 a 360) que represente o ângulo desejado.</p>
<p></p>
<div class="sourceCode" id="cb946"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, weight <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">mpg</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, y <span class="op">=</span> <span class="va">soma</span>, label <span class="op">=</span> <span class="va">soma</span><span class="op">)</span>,
    data <span class="op">=</span> <span class="va">somatorios</span>, 
    nudge_y <span class="op">=</span> <span class="fl">100</span>,
    angle <span class="op">=</span> <span class="fl">45</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-510-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
</div>
</div>
<div id="sec:devices_graficos" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> Exportando os seus gráficos do <code>ggplot</code><a class="anchor" aria-label="anchor" href="#sec:devices_graficos"><i class="fas fa-link"></i></a>
</h2>
<p>Após gerar os seus gráficos com o <code>ggplot</code>, você provavelmente vai querer exportá-los para algum arquivo de imagem. Dessa forma, você possa inseri-los em seu artigo em Word (<code>.docx</code>), ou no <em>dashboard</em> que você deve apresentar ao seu chefe no dia seguinte. Para realizarmos essa tarefa, precisamos utilizar funções que possam construir esses arquivos de imagem, no qual podemos guardar os nossos gráficos. Com isso, temos duas alternativas mais comuns, que são:</p>
<ol style="list-style-type: decimal">
<li><p>Uma forma mais “moderna” de exportação, através do uso da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, que é exposta por .</p></li>
<li><p>A forma tradicional de se exportar gráficos no R, descrita por .</p></li>
</ol>
<p>Uma outra referência que também descreve ambas alternativas, se encontra em . A primeira alternativa, seria uma forma mais “moderna” de exportar os seus gráficos no R, através da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> (uma função do próprio pacote <code>ggplot</code>), que tem se popularizado bastante nos últimos tempos. Entretanto, essa função nada mais é, do que um <em>wrapper</em> sobre as funções do pacote <code>grDevices</code>, que são utilizadas na segunda alternativa apresentada acima. Ou seja, a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> é apenas um atalho para o método descrito por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-murrell2006" role="doc-biblioref">Murrell</a> (<a href="refer%C3%AAncias-14.html#ref-murrell2006" role="doc-biblioref">2006</a>)</span>, que utiliza as funções disponíveis no pacote <code>grDevices</code>.</p>
<p>Em mais detalhes, o pacote <code>grDevices</code> (que está incluso nos pacotes básicos da linguagem) oferece um conjunto de funções capazes de acessar diversos <em>devices</em> gráficos. Cada <em>device</em> gráfico, representa uma <em>engine</em> diferente que vai ser responsável por construir o arquivo onde o seu gráfico será guardado. Portanto, cada uma dessas <em>engines</em>, vão gerar um tipo arquivo diferente, ou em outras palavras, arquivos de extensões diferentes. Você já utiliza muitos desses <em>devices</em> gráficos, praticamente o tempo todo em sua rotina. Você apenas não sabia, que esse era o nome técnico dado às <em>engines</em>, que normalmente constroem esses tipos de arquivos. Sendo os exemplos mais famosos, os arquivos: JPEG/JPG (<code>.jpeg</code>, <code>.jpg</code>), PNG (<code>.png</code>), SVG (<code>.svg</code>) e PDF (<code>.pdf</code>).</p>
<div id="tipos-de-representação-geométrica-em-devices-gráficos" class="section level3" number="8.7.1">
<h3>
<span class="header-section-number">8.7.1</span> Tipos de representação geométrica em <em>devices</em> gráficos<a class="anchor" aria-label="anchor" href="#tipos-de-representa%C3%A7%C3%A3o-geom%C3%A9trica-em-devices-gr%C3%A1ficos"><i class="fas fa-link"></i></a>
</h3>
<p>Ao longo das décadas passadas mais recentes, a área da computação gráfica desenvolveu diversos modelos computacionais que fossem capazes de representar visualmente e virtualmente, o nosso mundo real <span class="citation">(<a href="refer%C3%AAncias-14.html#ref-hughes2014" role="doc-biblioref">Hughes et al. 2014</a>)</span>. Com isso, eu quero destacar que nós possuímos hoje, formas diferentes de se representar uma mesma imagem em nosso computador.</p>
<p>Isso significa, que cada um dos <em>devices</em> gráficos disponíveis, que podemos utilizar para guardar os nossos gráficos no R, em geral, utilizam um tipo, ou um método de representação geométrica diferente para representar a sua imagem. Cada um desses modelos, possuem características diferentes, e com isso, incorrem em diferentes erros na representação virtual de sua imagem. Logo, conhecer, mesmo que de maneira sutil, esses modelos de representação, as suas vantagens e características, se torna importante para fundamentarmos as nossas decisões sobre como vamos salvar os nossos gráficos no R.</p>
<p>Nós temos atualmente, dois modelos principais de representação geométrica que são utilizados para representar imagens, ao longo de toda a indústria da computação gráfica, sendo elas:</p>
<ol style="list-style-type: decimal">
<li><p>Vetorial.</p></li>
<li><p>Matricial.</p></li>
</ol>
<p>A representação vetorial (figura 8.3), como o próprio nome dá a entender, busca conectar um conjunto de vetores (ou de linhas) para formar cada forma geométrica presente em sua imagem. Um arquivo de imagem que utiliza essa representação, possui uma descrição matemática dos elementos geométricos que compõe a sua imagem <span class="citation">(<a href="refer%C3%AAncias-14.html#ref-murray1996" role="doc-biblioref">Murray and vanRyper 1996</a>)</span>. Essa descrição matemática possui informações como a direção, o comprimento e as coordenadas dos vetores (ou linhas) que formam cada forma geométrica de sua imagem. Em resumo, a representação vetorial funciona como aqueles desenhos infantis de “conecte os pontos.” Nesse sistema, qualquer forma presente em nosso gráfico, seja ela um quadrado, um círculo, uma letra, ou uma garrafa, é formada por um conjunto de linhas que conectam os “vértices” de cada forma.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-511"></span>
<img src="Figuras/vetorial_matricial.png" alt="Diferenças entre as representações vetorial e matricial" width="60%"><p class="caption">
Figura 8.3: Diferenças entre as representações vetorial e matricial
</p>
</div>
<p></p>
<p>Por outro lado, imagens que se encontram em representação matricial (figura 8.3), são popularmente conhecidas por <em>raster image</em>, ou <em>bitmap image</em>, e utilizam-se de uma malha quadricular (ou de um <em>grid</em>), no qual cada célula é preenchida, a fim de representar cada parte de sua imagem. Uma forma típica de identificarmos esse tipo de representação, está no efeito “escada,” ou no efeito pixelado (ou quadriculado) que adquirimos ao darmos um <em>zoom</em> nesse tipo de imagem.</p>
<p>Os principais <em>devices</em> gráficos disponíveis no R, que utilizam a representação vetorial, são os arquivos PDF (<code>.pdf</code>) e SVG (<code>.svg</code>). Além desses, temos alguns outros <em>devices</em> menos comuns, como os arquivos <em>encapsulated PostScript</em> (<code>.eps</code>) que são mais utilizados em programas da Adobe, como o PhotoShop. Imagens produzidas através de representações vetoriais, são em geral, mais bem definidas do que imagens produzidas por representações matriciais, e mesmo que o usuário dê um <em>zoom</em> grande sobre a imagem, elas são capazes de manter essa definição. Logo, como foi destacado por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-wickham2016" role="doc-biblioref">Wickham</a> (<a href="refer%C3%AAncias-14.html#ref-wickham2016" role="doc-biblioref">2016</a>, p 185)</span>, imagens de representações vetoriais parecem mais atraentes em um número maior de lugares. Especialmente pelo fato, de que o sistema vetorial consegue representar formas geométricas (principalmente polígonos), de maneira mais precisa, do que o sistema matricial.</p>
<p>Apesar dessa vantagem, não são todos os programas que suportam o uso de imagens provenientes de representações vetoriais (por exemplo, o Word aceita o uso de arquivos SVG, mas não aceita o uso de PDF’s para inserção de imagens). Em contrapartida, arquivos de <em>raster image</em> (ou <em>bitmap image</em>), são aceitos na grande maioria dos programas, e portanto, representam uma forma mais portátil de transportar os seus gráficos ao longo de diversos programas e sistemas. Tendo isso em mente, os <em>devices</em> gráficos mais conhecidos, que usam a representação matricial, são os arquivos PNG (<code>.png</code>), JPEG/JPG (<code>.jpeg</code>) e TIFF (<code>.tiff</code>).</p>
<p>Logo, ao escolher o <em>device</em> gráfico que irá gerar o seu arquivo de imagem, você deve refletir sobre qual o formato que mais se adequa as suas necessidades. Mesmo que você possa produzir imagens mais fiéis através de uma representação vetorial, isso não se configura na maioria das ocasiões, como uma grande vantagem. Pois, você pode se aproveitar da maior flexibilidade dos <em>devices</em> de representação matricial, e ainda assim, produzir imagens muito bem definidas e de alta resolução. Sobretudo com o uso de um arquivo PNG (<code>.png</code>) ou TIFF (<code>.tiff</code>), que produzem em geral, resultados melhores do que um arquivo JPEG/JPG (<code>.jpeg</code>).</p>
<p>Em resumo, caso o uso de um arquivo PDF (<code>.pdf</code>), ou SVG (<code>.svg</code>), não represente uma limitação para o seu trabalho, você geralmente vai preferi-los em detrimento de outros <em>devices</em> gráficos. Entretanto, caso você precise de uma maior portabilidade de seu gráfico, você ainda pode atingir ótimos resultados com um <em>device</em> gráfico de representação matricial, como um arquivo PNG (<code>.png</code>) ou TIFF (<code>.tiff</code>). Basta que você utilize uma resolução alta, e aplique um <em>anti-aliasing</em> sobre o arquivo em que você irá salvar o gráfico. Um bom nível de resolução para esses tipos de arquivos, se encontra na casa dos 300 dpi, sendo essa a resolução mínima requisitada pela maioria dos jornais e revistas científicas.</p>
<p>Concluindo, podemos utilizar diferentes tipos de representações geométricas para guardarmos informações visuais em nosso computador, com o objetivo de representarmos virtualmente uma mesma imagem. Caso queira conhecer mais a fundo essas representações, você pode consultar  e <span class="citation"><a href="refer%C3%AAncias-14.html#ref-camara2001" role="doc-biblioref">Câmara and Monteiro</a> (<a href="refer%C3%AAncias-14.html#ref-camara2001" role="doc-biblioref">2001</a>)</span> para uma introdução útil, e para uma visão mais técnica e aprofundada, você pode consultar  e .</p>
</div>
<div id="sec:anti_aliasing" class="section level3" number="8.7.2">
<h3>
<span class="header-section-number">8.7.2</span> Pontos importantes sobre <em>anti-alising</em><a class="anchor" aria-label="anchor" href="#sec:anti_aliasing"><i class="fas fa-link"></i></a>
</h3>
<p>O <em>device</em> gráfico utilizado pelo RStudio, em seu painel de <code>Plots</code>, depende do sistema operacional em que você está trabalhando. No caso do Windows, o RStudio irá utilizar o <em>device</em> gráfico nativo do sistema, e infelizmente, como foi pontuado por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-chase2019" role="doc-biblioref">Chase</a> (<a href="refer%C3%AAncias-14.html#ref-chase2019" role="doc-biblioref">2019</a>)</span>, esse <em>device</em> não é muito bom. Um de seus principais problemas, é que ele não possui um mecanismo de <em>anti-aliasing</em>.</p>
<p>O <em>anti-aliasing</em>, é um recurso muito utilizado em diversos programas que trabalham com imagens. Um grande exemplo disso, se encontra nos <em>videogames</em>, que quase sempre possuem uma opção em suas configurações gráficas, que lhe permite aplicar esse recurso sobre o gráfico do <em>game</em>. Esse recurso, consiste em um método de suavização de imagens produzidas por representações matriciais, onde o computador tenta preencher certas áreas ao redor dos limites de cada forma geométrica representada na imagem, de forma que os contornos fiquem mais suaves e precisos, eliminando grande parte do efeito pixelado (ou quadriculado) presente em imagens desse tipo.</p>
<p>Portanto, se você, assim como eu, trabalha no Windows, todas as imagens (produzidas por <em>devices</em> gráficos que usam representação matricial) que você exportar no R, não vão incluir o uso de um <em>anti-aliasing</em>, por padrão do <em>device</em> gráfico utilizado pelo sistema. Isso significa, que grande parte das suas imagens, vão apresentar o efeito pixelado, mesmo que você utilize resoluções altas. Por exemplo, você pode ver na figura 8.4, especialmente na imagem com 300 dpi, que aumentar a resolução da imagem, ajuda bastante quanto ao efeito pixelado, mas que ainda não é o suficiente para eliminá-lo (se você der um <em>zoom</em> grande sobre a imagem de 300 dpi, você ainda é capaz de ver alguns resquícios do efeito “escada” que estamos tentando eliminar). Portanto, poderíamos atingir um resultado ainda melhor nessas imagens, com o uso de um <em>anti-aliasing</em>.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-512"></span>
<img src="Figuras/sem_anti_aliasing.png" alt="Aumentar a resolução de uma imagem ajuda, mas ainda não é o suficiente" width="100%"><p class="caption">
Figura 8.4: Aumentar a resolução de uma imagem ajuda, mas ainda não é o suficiente
</p>
</div>
<p></p>
<p>Isso é um problema particular do Windows, que ocorre sempre que utilizamos algum dos <em>devices</em> gráficos que utilizam representação matricial. Pois os <em>devices</em> gráficos utilizados pelo RStudio em outros sistemas, como Mac e Linux, apresentam “de fábrica” um mecanismo de <em>anti-aliasing</em>. Apesar desse problema, os usuários de Windows possuem uma solução simples, que é descrita por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-chase2019" role="doc-biblioref">Chase</a> (<a href="refer%C3%AAncias-14.html#ref-chase2019" role="doc-biblioref">2019</a>)</span>. Isto é, o uso da <em>engine</em> gráfica do Cairo Graphics, que está disponível normalmente nos sistemas Windows e oferece um recurso de anti-aliasing. O uso dessa <em>engine</em> também se torna essencial no Windows, quando desejamos utilizar em nossos gráficos, fontes que estão instaladas no nosso sistema.</p>
<p>Para acessarmos a <em>engine</em> gráfica do Cairo Graphics, podemos utilizar o argumento <code>type</code>, tanto na função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, quanto nas funções do pacote <code>grDevices</code>. Basta igualar esse argumento ao nome <code>cairo</code>, da seguinte forma: <code>type = "cairo"</code>. No caso da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, ela não possui um argumento <code>type</code> definido, mas como essa função utiliza as funções do pacote <code>grDevices</code>, o argumento <code>type</code> será repassado às funções do pacote <code>grDevices</code> durante a sua execução.</p>
<p>Para reforçarmos essa ideia, olhe para a figura 8.5. Ambos os gráficos foram salvos em um arquivo PNG, com as mesmas dimensões, e utilizando a mesma resolução (300 dpi). Se você der um <em>zoom</em> muito grande sobre ambas as imagens, você poderá perceber que o efeito pixelado está muito menor, na imagem em que o <em>anti-aliasing</em> foi aplicado, em relação a outra imagem que não o possui.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-513"></span>
<img src="Figuras/com_anti_aliasing.png" alt="Além de usar resoluções altas, use também anti-aliasing" width="100%"><p class="caption">
Figura 8.5: Além de usar resoluções altas, use também anti-aliasing
</p>
</div>
<p></p>
</div>
<div id="a-função-ggsave" class="section level3" number="8.7.3">
<h3>
<span class="header-section-number">8.7.3</span> A função <code>ggsave()</code><a class="anchor" aria-label="anchor" href="#a-fun%C3%A7%C3%A3o-ggsave"><i class="fas fa-link"></i></a>
</h3>
<p>Como definimos anteriormente, a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> do pacote <code>ggplot</code>, representa apenas um atalho para o método descrito por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-murrell2006" role="doc-biblioref">Murrell</a> (<a href="refer%C3%AAncias-14.html#ref-murrell2006" role="doc-biblioref">2006</a>)</span>, sendo portanto, um método menos verboso do que o método tradicional de se exportar gráficos no R. Para utilizar a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, você precisa primeiro gerar o seu gráfico, ou melhor dizendo, o seu gráfico deve estar aparecendo na área direita e inferior do seu RStudio, na seção de <code>Plots</code>. Pois é a partir do <em>cache</em> dessa seção, que a função irá extrair o seu gráfico, e portanto, salvá-lo em algum local de seu computador.</p>
<p>Dessa forma, o código necessário para o uso dessa função, vai em geral, ser semelhante ao código abaixo. Você primeiro gera o gráfico, e em seguida, utiliza a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, para salvar o gráfico correspondente.</p>
<p></p>
<div class="sourceCode" id="cb947"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"output.pdf"</span><span class="op">)</span></code></pre></div>
<p></p>
<p>O primeiro argumento (<code>filename</code>) da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, corresponde ao nome que você deseja dar ao arquivo onde seu gráfico será salvo. O segundo argumento (<code>device</code>), é onde você irá selecionar o <em>device</em> gráfico desejado para o arquivo onde o gráfico será salvo. Vale ressaltar, que você não precisa definir esse argumento. Pois você pode escolher implicitamente o <em>device</em> desejado, através da extensão que você define no nome do arquivo - no primeiro argumento (<code>filename</code>). Ou seja, se no primeiro argumento, eu colocar o nome do arquivo como <code>output.pdf</code>, devido a extensão <code>.pdf</code> ao final do nome, a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> vai gerar um arquivo PDF para você. Mas caso o nome do arquivo seja <code>output.png</code>, a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> vai construir um arquivo PNG. E assim por diante. Em resumo, você pode utilizar em todos os sistemas operacionais, através da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, as seguintes extensões:</p>
<ol style="list-style-type: decimal">
<li><p><code>eps</code> - <em>encripted PostScript</em>.</p></li>
<li><p><code>ps</code> - <em>PostScript</em>.</p></li>
<li><p><code>tex</code> - PicTex.</p></li>
<li><p><code>pdf</code> - <em>Portable Document Format</em> (PDF).</p></li>
<li><p><code>jpeg</code> - Arquivo JPEG.</p></li>
<li><p><code>tiff</code> - <em>Tag Image File Format</em> (TIFF).</p></li>
<li><p><code>png</code> - <em>Portable Network Graphics</em> (PNG).</p></li>
<li><p><code>bmp</code> - <em>Bitmap Image File</em> (BMP).</p></li>
<li><p><code>svg</code> - <em>Scalable Vector Graphics</em> (SVG).</p></li>
</ol>
<p>Caso você deseje salvar o arquivo do gráfico, em um diretório diferente de seu diretório de trabalho atual do R, você pode utilizar o terceiro argumento (<code>path</code>), para selecionar uma pasta. Basta que você forneça um caminho absoluto até a pasta. Por exemplo, caso eu queira salvar o arquivo em minha pasta de Gráficos, localizada em minha pasta de Pesquisa, eu posso utilizar os seguintes comandos:</p>
<p></p>
<div class="sourceCode" id="cb948"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
  filename <span class="op">=</span> <span class="st">"output.pdf"</span>,
  path <span class="op">=</span> <span class="st">"C:/Users/Pedro/Pesquisa/2020-08/Gráficos/"</span>
<span class="op">)</span></code></pre></div>
<p></p>
<p>Outros argumentos muito importantes a serem utilizados, são os argumentos <code>width</code>, <code>height</code> e <code>dpi</code>, que definem a largura, a altura e a resolução do arquivo resultante, respectivamente. É importante frisar que os argumentos <code>width</code> e <code>height</code>, trabalham com a unidade de polegadas (<code>inches</code> - <code>in</code>), sendo uma unidade menos comum em imagens. Como uma dica, você pode primeiro imaginar a largura e altura de sua imagem, em <em>pixels</em>, que é uma unidade mais comumente utilizada em situações como essa, e em seguida, converter esses <em>pixels</em> para polegadas (1 polegada equivale a 60 <em>pixels</em>), encontrando assim, o valor que você deseja fornecer aos argumentos supracitados.</p>
<p>Dando prosseguimento à descrição, os argumentos <code>width</code> e <code>height</code> são muito importantes, pois eles afetam diretamente a escala (ou o <em>aspect ratio</em>) da imagem. Dito de outra forma, esses argumentos acabam afetando a disposição dos elementos do gráfico, ao longo do espaço da imagem resultante. Com isso, o uso desses argumentos, envolve encontrar um certo equilíbrio, ou uma relação entre a altura e a largura da imagem, que melhor represente o seu gráfico. Por exemplo, os dois gráficos mostrados na figura 8.6, foram salvos utilizando-se a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>. Ambos os gráficos, foram salvos em um arquivo PNG (<code>.png</code>), e utilizaram uma resolução de 300 de dpi. A única diferença entre esses gráficos, se encontra nos valores de altura e largura utilizados em cada imagem.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-516"></span>
<img src="Figuras/proporcao_altura.png" alt="Efeitos da relação entre altura e largura com ggsave(), sobre uma imagem" width="100%"><p class="caption">
Figura 8.6: Efeitos da relação entre altura e largura com ggsave(), sobre uma imagem
</p>
</div>
<p></p>
<p>Portanto, ao aumentarmos a altura e a largura da imagem, o gráfico resultante tende a ser mais “disperso,” e os seus elementos, menores. Essa característica é relevante, pois nós geralmente desejamos evitar um gráfico muito “disperso,” e com elementos muito pequenos. Isso se deve à função que um gráfico usualmente cumpre em uma análise. Nós frequentemente utilizamos gráficos, para nos comunicar com o nosso leitor, ao mostrarmos de forma visual, informações que são relevantes e que trazem novas perspectivas e questões sobre uma determinada análise. Se essas informações ficam menores e muito “dispersas” ao longo do espaço do nosso gráfico, o nosso leitor tem maior dificuldade de enxergar o padrão geral (ou a informação principal) do nosso gráfico. Não apenas porque a sua visão precisa cobrir um espaço mais amplo da tela, mas também porque as formas geométricas que representam os nossos dados, podem ficar muito pequenas, e com isso, mais difíceis de se identificar.</p>
<p>Por outro lado, a resolução (argumento <code>dpi</code>) definida na função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, funciona somente com <em>devices</em> gráficos que utilizam representações matriciais (e.g. PNG, TIFF e JPEG/JPG). A resolução da imagem, é responsável por modificar apenas a dimensão da matriz, ou da malha quadricular que será utilizada para representar a sua imagem. Resoluções maiores, vão utilizar matrizes de maiores dimensões (ou em outras palavras, uma matriz com maior número de células) para representar o seu gráfico, e, portanto, a imagem resultante será mais precisa, e irá sofrer de maneira menos intensa com o efeito “pixelado” produzido por representações matriciais.</p>
<p>Como exemplo prático, veja as imagens dos gráficos na figura 8.7. Ambos os gráficos foram salvos em um arquivo PNG, e utilizaram os mesmos valores de altura e largura. Porém, foi aplicado diferentes valores de resolução em ambas as imagens. Se você der um <em>zoom</em> sobre as imagens, você irá perceber que a imagem de 100 dpi, sofre de maneira muito mais acentuada do efeito granulado (ou pixelado), em relação a imagem de 300 dpi.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-517"></span>
<img src="Figuras/proporcao_resolucao.png" alt="Efeitos da resolução com ggsave() sobre uma imagem" width="100%"><p class="caption">
Figura 8.7: Efeitos da resolução com ggsave() sobre uma imagem
</p>
</div>
<p></p>
<p>Lembre-se que podemos melhorar ainda mais a aparência dessas imagens, ao utilizarmos um recurso de <em>anti-aliasing</em>. Como já definimos na seção de <a href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html#sec:anti_aliasing">Pontos importantes sobre <em>anti-aliasing</em></a>, para utilizarmos tal recurso, precisamos acessar a <em>engine</em> do Cairo Graphics, e para isso, precisamos apenas definir o argumento <code>type</code> para o nome <code>cairo</code>.</p>
<p></p>
<div class="sourceCode" id="cb949"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>
  filename <span class="op">=</span> <span class="st">"output.png"</span>,
  path <span class="op">=</span> <span class="st">"C:/Users/Pedro/Pesquisa/2020-08/Gráficos/"</span>,
  width <span class="op">=</span> <span class="fl">7</span>,
  height <span class="op">=</span> <span class="fl">5</span>,
  type <span class="op">=</span> <span class="st">"cairo"</span>
<span class="op">)</span></code></pre></div>
<p></p>
</div>
<div id="a-forma-tradicional-de-se-exportar-gráficos-no-r" class="section level3" number="8.7.4">
<h3>
<span class="header-section-number">8.7.4</span> A forma tradicional de se exportar gráficos no R<a class="anchor" aria-label="anchor" href="#a-forma-tradicional-de-se-exportar-gr%C3%A1ficos-no-r"><i class="fas fa-link"></i></a>
</h3>
<p>Apesar da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> ser um atalho útil, eu (Pedro) particularmente prefiro usar diretamente as funções do pacote <code>grDevices</code>, sempre que desejo exportar algum gráfico produzido no R. Parte dessa preferência, reside no fato de que a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> não oferece até o momento, suporte para a função <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>, que se torna essencial quando desejamos exportar gráficos que utilizam fontes personalizadas, ou que estão instaladas em nosso sistema. Vale lembrar, que o pacote <code>grDevices</code> já está incluso nos pacotes básicos do R, e por essa razão, ele é carregado automaticamente em toda sessão do R que você inicia.</p>
<p>Como é descrito por , o processo tradicional de exportação de gráficos no R, é bem simples, e envolve três passos diferentes: 1) abrir um arquivo construído por algum <em>device</em> gráfico; 2) gerar o seu gráfico; 3) fechar o arquivo produzido pelo <em>device</em> gráfico.</p>
<p>Portanto, no primeiro passo, vamos criar um novo arquivo de imagem (vazio) em nosso computador, de acordo com um <em>device</em> gráfico de nossa preferência. Dessa forma, o arquivo fica em aberto, à espera de algum <em>input</em> gráfico a ser armazenado. Em seguida, nós podemos gerar o nosso gráfico. Sendo que diferentemente da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, quando abrimos um arquivo de imagem (como fizemos no passo 1), qualquer gráfico que geramos não será mostrado no painel direito e inferior (seção <code>Plots</code>) do nosso RStudio. Pois ele é diretamente levado para o arquivo que abrimos. Por último, podemos fechar o arquivo que abrimos no primeiro passo, encerrando dessa forma, o processo de exportação.</p>
<p>Para abrirmos um novo arquivo de imagem em nosso computador, temos as funções disponíveis abaixo. Perceba que a lista de arquivos abaixo, é praticamente idêntica à lista que mostramos na seção anterior. Pois como já destacamos anteriormente, a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> vai utilizar “por trás dos bastidores,” todas essas funções abaixo (exceto a função <code><a href="https://rdrr.io/r/grDevices/cairo.html">svg()</a></code><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;No caso de arquivos do tipo SVG, a função &lt;code&gt;ggsave()&lt;/code&gt; utiliza a função &lt;code&gt;svglite()&lt;/code&gt;, que vem do pacote &lt;code&gt;svglite&lt;/code&gt;.&lt;/p&gt;"><sup>30</sup></a>) para construir os seus arquivos de imagem.</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="https://rdrr.io/r/grDevices/postscript.html">postscript()</a></code> - <em>encripted PostScript</em> e <em>PostScript</em>.</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/pictex.html">pictex()</a></code> - PicTex.</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> e <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code> - <em>Portable Document Format</em> (PDF).</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/png.html">jpeg()</a></code> - Arquivo JPEG.</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/png.html">tiff()</a></code> - <em>Tag Image File Format</em> (TIFF).</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> - <em>Portable Network Graphics</em> (PNG).</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/png.html">bmp()</a></code> - <em>Bitmap Image File</em> (BMP).</p></li>
<li><p><code><a href="https://rdrr.io/r/grDevices/cairo.html">svg()</a></code> - <em>Scalable Vector Graphics</em> (SVG).</p></li>
</ol>
<p>Independente de qual o <em>device</em> gráfico, ou a função que você escolher para abrir um arquivo em seu computador, você irá fechar esse arquivo (terceiro passo), por meio da função <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.off()</a></code>. Dessa forma, o código necessário para gerarmos, por exemplo, um arquivo PNG, através desse método de exportação, é semelhante aos comandos abaixo. De certa forma, você utiliza as funções do pacote <code>grDevices</code>, de modo que elas “contornem,” ou “envolvam” os comandos que geram o seu gráfico.</p>
<p></p>
<div class="sourceCode" id="cb950"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Abra um arquivo de imagem</span>
<span class="co"># com algum device gráfico</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="st">"output.png"</span><span class="op">)</span>

<span class="co"># Construa algum gráfico</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Feche o arquivo que você criou</span>
<span class="co"># com dev.off()</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Assim como na função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, o primeiro argumento (<code>filename</code> ou <code>file</code>) de todas as funções do pacote <code>grDevices</code>, é responsável por definir o nome do arquivo onde o seu gráfico será salvo. Porém, as semelhanças com a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> acabam por aqui.</p>
<p>Diferentemente da função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, você precisa ficar mais atento ao definir as dimensões de sua imagem nas funções do pacote <code>grDevices</code>, pois as unidades utilizadas nos argumentos <code>height</code> e <code>width</code> ao longo dessas funções, variam. Uma boa forma de guardar essas unidades, é categorizar as funções de acordo com a representação geométrica que elas utilizam. As funções que utilizam representações vetoriais (PDF, SVG e EPS) usam a unidade de polegadas (<em>inches</em>), para definir as dimensões de sua imagem. Já as funções que utilizam representações matriciais (PNG, JPEG/JPG, TIFF, BMP) usam a unidade de <em>pixels</em>.</p>
<p>Uma outra diferença presente nas funções do pacote <code>grDevices</code>, é que o argumento responsável por definir a resolução da imagem, se chama <code>res</code> (abreviação para <em>resolution</em>), ao invés de <code>dpi</code> como ocorre em <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>. Entretanto, a unidade utilizada no argumento <code>res</code>, permanece a mesma, em relação ao argumento <code>dpi</code>.</p>
<div id="arquivos-png-jpegjpg-tiff-e-bmp" class="section level4" number="8.7.4.1">
<h4>
<span class="header-section-number">8.7.4.1</span> Arquivos PNG, JPEG/JPG, TIFF e BMP<a class="anchor" aria-label="anchor" href="#arquivos-png-jpegjpg-tiff-e-bmp"><i class="fas fa-link"></i></a>
</h4>
<p>Para os exemplos dessa seção, vou utilizar a função <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code>, com o objetivo de criar um modelo guia, sobre como você pode configurar esse conjunto de funções, que se referem a <em>devices</em> gráficos que utilizam representações matriciais. Ou seja, você pode replicar normalmente o método de uso da função <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code>, ou os seus argumentos, para as demais funções desse conjunto (que funcionam de maneira idêntica), basta trocar a função <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> por uma dessas funções: <code><a href="https://rdrr.io/r/grDevices/png.html">jpeg()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html">tiff()</a></code> e <code><a href="https://rdrr.io/r/grDevices/png.html">bmp()</a></code>.</p>
<p>Em todas as ocasiões que você utilizar uma dessas funções, você possui ao menos 5 argumentos que você provavelmente irá definir. O primeiro argumento (<code>file</code> ou <code>filename</code>) de todas essas funções, é onde você irá definir o nome do arquivo, em que você está salvando o seu gráfico. Além dele, temos também os dois argumentos que definem a largura (<code>width</code>) e a altura (<code>height</code>) do arquivo resultante (lembre-se que esses argumentos trabalham com a unidade de <em>pixels</em>). Em seguida, temos o argumento <code>res</code>, que é responsável por definir a resolução do arquivo de imagem. Por último, mas não menos importante, temos o argumento <code>type</code>, que é responsável por definir se o R irá utilizar o <em>device</em> gráfico nativo do sistema, ou a <em>engine</em> do Cairo Graphics para construir a sua imagem.</p>
<p>Tendo esses argumentos em mente, temos logo abaixo um código modelo, sobre como poderíamos configurar essa função. No caso de arquivos PNG, você ainda pode utilizar o valor <code>cairo-png</code> no argumento <code>type</code>, para utilizar uma outra <em>engine</em> interna do Cairo Graphics. Porém, os resultados produzidos por <code>cairo</code> e <code>cairo-png</code> através do argumento <code>type</code>, são virtualmente idênticos (ao menos a olho nu). Você pode encontrar mais detalhes sobre a diferença entre esses dois métodos, na documentação da função <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> (execute o comando <code><a href="https://rdrr.io/r/grDevices/png.html">?png</a></code> no console para acessar essa documentação).</p>
<p></p>
<div class="sourceCode" id="cb951"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span>
  filename <span class="op">=</span> <span class="st">"um_nome_qualquer.png"</span>, 
  width <span class="op">=</span> <span class="fl">2800</span>,
  height <span class="op">=</span> <span class="fl">1800</span>,
  res <span class="op">=</span> <span class="fl">300</span>,
  type <span class="op">=</span> <span class="st">"cairo"</span>
<span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Agora, é muito importante destacar que a resolução da imagem (que você define no argumento <code>res</code>) construída por essas funções, possui um efeito diferente do que vimos na função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>. Quando estávamos discutindo a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, vimos que a resolução definida no argumento <code>dpi</code> dessa função, cumpria o trabalho para o qual foi desenvolvida, que consistia no aumento ou redução da malha quadricular responsável pela representação da imagem. Em outras palavras, a resolução afetava diretamente a precisão da imagem construída.</p>
<p>Porém, em comparação com a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>, a resolução definida no argumento <code>res</code>, possui um efeito extra nas funções <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html">jpeg()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html">tiff()</a></code> e <code><a href="https://rdrr.io/r/grDevices/png.html">bmp()</a></code>. Em resumo, ao modificarmos a resolução nessas funções, nós também afetamos o espaço da imagem, da mesma forma como ocorre ao modificarmos a altura e a largura da imagem. Por isso, ao utilizar essas funções, você possui mais um item a considerar, ao procurar pelo equilíbrio que melhor representa o seu gráfico.</p>
<p>Descrevendo esse efeito em mais detalhes, nas funções <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html">jpeg()</a></code>, <code><a href="https://rdrr.io/r/grDevices/png.html">tiff()</a></code> e <code><a href="https://rdrr.io/r/grDevices/png.html">bmp()</a></code>, caso nós mantivermos a altura e a largura da imagem constantes, ao aumentarmos a sua resolução, estamos de certa forma comprimindo o gráfico a um espaço menor. Por outro lado, ao reduzirmos essa resolução, estamos produzindo o efeito contrário, e como resultado, nós aumentamos o espaço que o gráfico irá ocupar na imagem.</p>
<p>Isto significa, que para você utilizar altos níveis de resolução em suas imagens, você terá que compensar os efeitos dessa resolução, com maiores valores para a altura e largura de sua imagem. Veja por exemplo, as imagens mostradas na figura 8.8. Ambas imagens apresentam exatamente o mesmo gráfico. Sendo que ambos os gráficos foram salvos em um arquivo PNG (construídos pela função <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code>), e utilizaram as mesmas dimensões (altura = 900 <em>pixels</em>, largura = 1500 <em>pixels</em>). Entretanto, os dois arquivos de imagem usaram resoluções diferentes. Perceba que o gráfico presente na imagem com maior resolução (300 dpi), está mais “comprimido,” enquanto o gráfico com menor resolução (180 dpi) traz um visual mais “natural,” como se o gráfico tivesse um espaço mais ideal para ocupar na imagem.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-521"></span>
<img src="Figuras/resolucao_png.png" alt="Efeitos da resolução em png() sobre uma imagem" width="100%"><p class="caption">
Figura 8.8: Efeitos da resolução em png() sobre uma imagem
</p>
</div>
<p></p>
</div>
<div id="sec:cairo_pdf" class="section level4" number="8.7.4.2">
<h4>
<span class="header-section-number">8.7.4.2</span> Arquivos PDF e SVG<a class="anchor" aria-label="anchor" href="#sec:cairo_pdf"><i class="fas fa-link"></i></a>
</h4>
<p>Nessa seção, vamos discutir três funções utilizadas para construirmos dois tipos de arquivos de imagem, que utilizam representações vetoriais, mais especificamente PDF (<code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> e <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>) e SVG (<code><a href="https://rdrr.io/r/grDevices/cairo.html">svg()</a></code>).</p>
<p>Você pode configurar as funções <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code>, <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code> e <code><a href="https://rdrr.io/r/grDevices/cairo.html">svg()</a></code>, de maneira muito parecida com a função <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code>. Dessa forma, você possui três argumentos principais a serem tratados nessas funções. O argumento <code>file</code>, para dar um nome ao arquivo que você está criando. E os argumentos <code>height</code> e <code>width</code> para definir a altura e a largura da imagem. Lembre-se que para as funções de <em>drives</em> gráficos que utilizam representação vetorial, as dimensões da imagem são definidas em polegadas (<em>inches</em>), e não em <em>pixels</em>. Abaixo temos um exemplo de uso dessas funções.</p>
<p></p>
<div class="sourceCode" id="cb952"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="st">"output.pdf"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf</a></span><span class="op">(</span><span class="st">"output.pdf"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/cairo.html">svg</a></span><span class="op">(</span><span class="st">"output.svg"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Curiosamente, se você está exportando um arquivo PDF, você pode salvar múltiplos gráficos em um mesmo arquivo, de modo que cada gráfico terá a sua própria página. Como <span class="citation"><a href="refer%C3%AAncias-14.html#ref-chang2012" role="doc-biblioref">Chang</a> (<a href="refer%C3%AAncias-14.html#ref-chang2012" role="doc-biblioref">2012</a>, p 324)</span> descreve, caso você abra um arquivo PDF (com a função <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> ou <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>), e gere mais de um gráfico antes de encerrar esse arquivo com a função <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.off()</a></code>, cada gráfico gerado terá a sua própria página no arquivo resultante.</p>
<p>Para fazer isso, nenhuma nova configuração é necessária sobre a função <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code>. Logo, independentemente de quantos gráficos você esteja planejando guardar nesse arquivo, você não precisa alterar nenhum argumento, em relação aos comandos anteriores. Tudo o que você precisa fazer, é abrir um novo arquivo com a função, e criar quantos gráficos você desejar antes de fechar o arquivo.</p>
<p></p>
<div class="sourceCode" id="cb953"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="st">"output.pdf"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># Gráfico 1</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Gráfico 2</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Gráfico 3</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Porém, para atingir esse mesmo resultado com a função <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>, você precisa ainda adicionar um novo argumento, chamado <code>onefile</code>. Tudo o que você deve fazer, é configurar esse argumento para verdadeiro (<code>TRUE</code>), como no exemplo abaixo. Dessa forma, todos os gráficos gerados por você, serão guardados em um mesmo arquivo.</p>
<p></p>
<div class="sourceCode" id="cb954"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf</a></span><span class="op">(</span><span class="st">"output.pdf"</span>, width <span class="op">=</span> <span class="fl">8</span>, height <span class="op">=</span> <span class="fl">5</span>, onefile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Gráfico 1</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Gráfico 2</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Gráfico 3</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Como o próprio nome da função <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code> dá a entender, essa função utiliza a <em>engine</em> gráfica do Cairo Graphics para construir o seu arquivo PDF. Como o recurso de <em>anti-aliasing</em> só é aplicado sobre imagens produzidas por representações matriciais, o uso do Cairo Graphics possui um papel diferente em representações vetoriais. Em resumo, você só vai precisar da função <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>, caso você tenha utilizado em seu gráfico, fontes personalizadas, ou que estão instaladas em seu sistema.</p>
<p>Ao executar a função <code><a href="https://rdrr.io/r/grDevices/postscriptFonts.html">pdfFonts()</a></code>, você pode encontrar uma lista, contendo as informações sobre todas as fontes atualmente disponíveis em sua sessão, que podem ser utilizadas ao exportarmos o nosso gráfico através da função <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code>. Em outras palavras, essa lista mostra todas as fontes que você pode utilizar em seu gráfico no R, e que vão estar disponíveis ao salvar esse gráfico em um arquivo PDF. Adicionar novas fontes a essa lista mostrada pela função <code><a href="https://rdrr.io/r/grDevices/postscriptFonts.html">pdfFonts()</a></code>, não é algo simples. Por isso, diversos pacotes tem sido desenvolvidos com o objetivo de facilitar o uso de fontes personalizadas em gráficos no R. Dentre eles, o pacote <code>extrafont</code> é o que mais tem se destacado.</p>
<p>No próximo capítulo, vou mostrar como podemos aplicar esse pacote. Mas resumidamente, com o uso do pacote <code>extrafont</code>, o processo para o uso de fontes do sistema em seus gráficos no R, consiste em duas etapas: 1) “importar” as fontes para o R, de forma que ele guarde um registro da localização, e de outras informações sobre cada fonte instalada em seu sistema; 2) após o passo 1, você precisa sempre “carregar” essas fontes, durante toda sessão do R, em que você desejar utilizá-las.</p>
<p>Porém, no caso específico de uma exportação para um arquivo PDF, mesmo após utilizarmos as funções do pacote <code>extrafont</code>, para carregarmos as fontes que desejamos utilizar em nossa sessão do R - como demonstrado por <span class="citation"><a href="refer%C3%AAncias-14.html#ref-qiu2015" role="doc-biblioref">Qiu</a> (<a href="refer%C3%AAncias-14.html#ref-qiu2015" role="doc-biblioref">2015</a>, p 101)</span>, a função <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code>, ainda assim, costuma não ser capaz de incorporar as fontes utilizadas, ao arquivo PDF resultante. Apesar da dificuldade inerente ao processo, a <em>engine</em> interna do Cairo Graphics, oferece suporte para a criação de arquivos PDF, e ainda mais importante, oferece um excelente suporte para o processo de incorporação de fontes (ou <em>font embedding</em>, como é comumente chamado) de seu computador para o arquivo PDF criado.</p>
<p>O processo de <em>font embedding</em>, consiste em incluir dentro de seu arquivo PDF, uma descrição completa das fontes utilizadas ao longo de seu PDF. Com essa descrição, as fontes utilizadas em seu arquivo PDF, se tornam independentes do sistema no qual elas estão sendo mostradas ou impressas. Em outras palavras, as fontes de seu PDF vão ser corretamente mostradas na tela de qualquer computador, independentemente se esse computador possui ou não aquelas fontes presentes em seu sistema. O ponto forte da função <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>, é que ela realiza esse processo de <em>font embedding</em> automaticamente.</p>
<p>Por exemplo, o gráfico mostrado na figura 8.9, utiliza a fonte Comic Sans MS (uma fonte normalmente disponível em todo sistema Windows) e foi salvo utilizando a função <code><a href="https://rdrr.io/r/grDevices/cairo.html">cairo_pdf()</a></code>.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-525"></span>
<img src="Figuras/grafico_cairo_pdf.png" alt="Um gráfico que utiliza a fonte Comic Sans MS" width="60%"><p class="caption">
Figura 8.9: Um gráfico que utiliza a fonte Comic Sans MS
</p>
</div>
<p></p>
</div>
</div>
</div>
<div id="exercícios-6" class="section level2 unnumbered">
<h2>Exercícios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-6"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Questão 8.1.</strong> Descubra qual o problema dos comandos abaixo, porque eles não geram um gráfico conforme esperado? Ou porque eles sequer geram algum gráfico? Vale destacar que, as tabelas <code>mpg</code> e <code>diamonds</code> estão disponíveis através do próprio pacote <code>ggplot2</code>. Portanto, assim que você chamar por esse pacote em sua sessão através do comando <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>, você terá acesso a essas tabelas.</p>
<p>8.1.A) Os comandos abaixo deveriam gerar um simples gráfico de dispersão, porém, um erro é criado. Porque esse erro ocorre? Copie e cole em seu R e veja esse erro com seus próprios olhos.</p>
<p></p>
<div class="sourceCode" id="cb955"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p></p>
<p>8.1.B) Os comandos abaixo deveriam gerar um gráfico de dispersão, onde os pontos seriam coloridos de acordo com os valores da coluna <code>cut</code>. Porém, o resultado é um gráfico de dispersão onde todos os pontos continuam pretos! O que ocorreu de errado nesses comandos?</p>
<p></p>
<div class="sourceCode" id="cb956"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carat</span>, y <span class="op">=</span> <span class="va">price</span>, fill <span class="op">=</span> <span class="va">cut</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p></p>
<p>8.1.C) Os comandos abaixo deveriam gerar um simples gráfico de barras, onde todas as barras deveriam ser coloridas pela cor azul (<em>blue</em>), porém, o resultado é um gráfico com barras coloridas de um vermelho salmão. Porque isso ocorre? Como podemos corrigir esses comandos para que todas as barras estejam coloridas de azul?<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Esse item foi inspirado em um exercício de .&lt;/p&gt;"><sup>31</sup></a>.</p>
<p></p>
<div class="sourceCode" id="cb957"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cut</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p></p>
<p></p>
<div class="inline-figure"><img src="Introducao_R_files/figure-html/unnamed-chunk-1072-1.png" width="60%" style="display: block; margin: auto;"></div>
<p></p>
<p><strong>Questão 8.2.</strong> Como exercício prático, utilize as funções do pacote <code>ggplot</code> para desenhar os objetos abaixo:</p>
<p>8.2.A) Desenha a bandeira do movimento LGBTQ+. Como uma ajuda, nós temos abaixo um vetor contendo os códigos de cada cor presente nessa bandeira:</p>
<p></p>
<div class="sourceCode" id="cb958"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"#a319ff"</span>,
  <span class="st">"#1294ff"</span>,
  <span class="st">"#19bf45"</span>,
  <span class="st">"#ffdc14"</span>,
  <span class="st">"#ff6a00"</span>,
  <span class="st">"#ff1919"</span>
<span class="op">)</span></code></pre></div>
<p></p>
<p>8.2.B) Considerando a função quadrática <span class="math inline">\(y = x^2 + 15x + 32\)</span>, desenhe a curva dessa função para o intervalo de 0 &lt; <span class="math inline">\(x\)</span> &lt; 1000.</p>
<p>8.2.C) Desenhe um conjunto de setas apontando para o texto <code>"Uma anotação muito importante"</code>. Ou seja, desenhe o texto guardado no objeto <code>anotacao</code> abaixo em seu <code>ggplot</code> e, em seguida, tente desenhar um conjunto de setas apontando para essa anotação.</p>
<p></p>
<div class="sourceCode" id="cb959"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anotacao</span> <span class="op">&lt;-</span> <span class="st">"Uma anotação\nmuito importante"</span></code></pre></div>
<p></p>
<p><strong>Questão 8.3.</strong> Na média qual a qualidade de corte (<code>cut</code>) na tabela <code>diamonds</code> que gera o maior preço (<code>price</code>). Dito de outra forma, utilize um gráfico do <code>ggplot</code> para responder à seguinte pergunta: tendo a tabela <code>diamonds</code> em mãos, quais são os cortes descritos na coluna <code>cut</code> que geram os diamantes mais caros do mercado, isto é, que possuem os maiores preços na coluna <code>price</code>. Lembre-se que a tabela <code>diamonds</code> advém do próprio pacote <code>ggplot2</code>, logo, se você chamou por esse pacote em sua sessão com um comando <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>, você já tem acesso à tabela <code>diamonds</code>.</p>
<p></p>
<div class="sourceCode" id="cb960"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="co">### Ao chamar pelo pacote</span>
<span class="co">### ggplot2, você terá acesso</span>
<span class="co">### à tabela diamonds</span>
<span class="va">diamonds</span></code></pre></div>
<pre><code>## # A tibble: 53,940 x 10
##    carat cut       color clarity depth table price     x     y     z
##    &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43
##  2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31
##  3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31
##  4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63
##  5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75
##  6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48
##  7  0.24 Very Good I     VVS1     62.3    57   336  3.95  3.98  2.47
##  8  0.26 Very Good H     SI1      61.9    55   337  4.07  4.11  2.53
##  9  0.22 Fair      E     VS2      65.1    61   337  3.87  3.78  2.49
## 10  0.23 Very Good H     VS1      59.4    61   338  4     4.05  2.39
## # ... with 53,930 more rows</code></pre>
<p></p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="tidy-data-uma-abordagem-para-organizar-os-seus-dados-com-tidyr.html"><span class="header-section-number">7</span> Tidy Data: uma abordagem para organizar os seus dados com tidyr</a></div>
<div class="next"><a href="configurando-componentes-est%C3%A9ticos-do-gr%C3%A1fico-no-ggplot2.html"><span class="header-section-number">9</span> Configurando componentes estéticos do gráfico no ggplot2</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2"><span class="header-section-number">8</span> Visualização de dados com ggplot2</a></li>
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o-e-pr%C3%A9-requisitos-2"><span class="header-section-number">8.1</span> Introdução e pré-requisitos</a></li>
<li><a class="nav-link" href="#o-que-%C3%A9-o-ggplot-e-a-sua-gram%C3%A1tica"><span class="header-section-number">8.2</span> O que é o ggplot e a sua gramática</a></li>
<li>
<a class="nav-link" href="#iniciando-um-gr%C3%A1fico-do-ggplot"><span class="header-section-number">8.3</span> Iniciando um gráfico do ggplot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dados"><span class="header-section-number">8.3.1</span> Dados</a></li>
<li><a class="nav-link" href="#mapeamento-de-vari%C3%A1veis-aesthetic-mapping"><span class="header-section-number">8.3.2</span> Mapeamento de variáveis (Aesthetic Mapping)</a></li>
<li><a class="nav-link" href="#formatos-geom%C3%A9tricos---fun%C3%A7%C3%B5es-geom"><span class="header-section-number">8.3.3</span> Formatos geométricos - funções geom</a></li>
</ul>
</li>
<li><a class="nav-link" href="#uma-outra-forma-de-se-compreender-o-aesthetic-mapping"><span class="header-section-number">8.4</span> Uma outra forma de se compreender o aesthetic mapping</a></li>
<li>
<a class="nav-link" href="#sobrepondo-o-aesthetic-mapping-inicial-em-diversas-camadas"><span class="header-section-number">8.5</span> Sobrepondo o aesthetic mapping inicial em diversas camadas</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#resumo-da-estrutura-b%C3%A1sica-de-um-gr%C3%A1fico-ggplot"><span class="header-section-number">8.5.1</span> Resumo da estrutura básica de um gráfico ggplot()</a></li></ul>
</li>
<li>
<a class="nav-link" href="#uma-discuss%C3%A3o-sobre-os-principais-geoms"><span class="header-section-number">8.6</span> Uma discussão sobre os principais geom’s</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#gr%C3%A1ficos-de-dispers%C3%A3o-e-gr%C3%A1ficos-de-bolha"><span class="header-section-number">8.6.1</span> Gráficos de dispersão e gráficos de bolha</a></li>
<li><a class="nav-link" href="#gr%C3%A1ficos-de-barra"><span class="header-section-number">8.6.2</span> Gráficos de barra</a></li>
<li><a class="nav-link" href="#gr%C3%A1ficos-de-linha"><span class="header-section-number">8.6.3</span> Gráficos de linha</a></li>
<li><a class="nav-link" href="#histogramas-e-outros-gr%C3%A1ficos-de-frequ%C3%AAncia"><span class="header-section-number">8.6.4</span> Histogramas e outros gráficos de frequência</a></li>
<li><a class="nav-link" href="#adicionando-textos-ao-gr%C3%A1fico"><span class="header-section-number">8.6.5</span> Adicionando textos ao gráfico</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec:devices_graficos"><span class="header-section-number">8.7</span> Exportando os seus gráficos do ggplot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tipos-de-representa%C3%A7%C3%A3o-geom%C3%A9trica-em-devices-gr%C3%A1ficos"><span class="header-section-number">8.7.1</span> Tipos de representação geométrica em devices gráficos</a></li>
<li><a class="nav-link" href="#sec:anti_aliasing"><span class="header-section-number">8.7.2</span> Pontos importantes sobre anti-alising</a></li>
<li><a class="nav-link" href="#a-fun%C3%A7%C3%A3o-ggsave"><span class="header-section-number">8.7.3</span> A função ggsave()</a></li>
<li><a class="nav-link" href="#a-forma-tradicional-de-se-exportar-gr%C3%A1ficos-no-r"><span class="header-section-number">8.7.4</span> A forma tradicional de se exportar gráficos no R</a></li>
</ul>
</li>
<li><a class="nav-link" href="#exerc%C3%ADcios-6">Exercícios</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/pedropark99/Introducao_R//blob/main/08-ggplot.Rmd">View source <i class="fas fa-book-open"></i></a></li>
          <li><a id="book-edit" href="https://github.com/pedropark99/Introducao_R//edit/main/08-ggplot.Rmd">Edit this page <i class="fas fa-book-open"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introdução à Linguagem R: seus fundamentos e sua prática</strong>" was written by Pedro Faria. It was last built on 2022-04-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
