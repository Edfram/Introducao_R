<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 13 Controle condicional de fluxo | Introdução à Linguagem R: seus fundamentos e sua prática</title>
<meta name="author" content="Pedro Faria">
<meta name="description" content="13.1 Introdução Haverá momentos em que você precisa tomar decisões em seu programa. A estrutura no R que te permite construir essas decisões, são os controles condicionais de fluxo. Nesse capítulo...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Capítulo 13 Controle condicional de fluxo | Introdução à Linguagem R: seus fundamentos e sua prática">
<meta property="og:type" content="book">
<meta property="og:url" content="bem-vindo.html/controle-condicional-de-fluxo.html">
<meta property="og:image" content="bem-vindo.html/capa.png">
<meta property="og:description" content="13.1 Introdução Haverá momentos em que você precisa tomar decisões em seu programa. A estrutura no R que te permite construir essas decisões, são os controles condicionais de fluxo. Nesse capítulo...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 13 Controle condicional de fluxo | Introdução à Linguagem R: seus fundamentos e sua prática">
<meta name="twitter:description" content="13.1 Introdução Haverá momentos em que você precisa tomar decisões em seu programa. A estrutura no R que te permite construir essas decisões, são os controles condicionais de fluxo. Nesse capítulo...">
<meta name="twitter:image" content="bem-vindo.html/capa.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introdução à Linguagem R: seus fundamentos e sua prática</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem vindo!</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="pref%C3%A1cio.html">Prefácio</a></li>
<li class="book-part">Introduzindo a Linguagem R</li>
<li><a class="" href="no%C3%A7%C3%B5es-b%C3%A1sicas-do-r.html"><span class="header-section-number">1</span> Noções Básicas do R</a></li>
<li><a class="" href="fundamentos-da-linguagem-r.html"><span class="header-section-number">2</span> Fundamentos da Linguagem R</a></li>
<li class="book-part">Importando, organizando e transformando dados</li>
<li><a class="" href="introduzindo-o-universo-do-tidyverse.html"><span class="header-section-number">3</span> Introduzindo o universo do tidyverse</a></li>
<li><a class="" href="importando-e-exportando-dados-com-readr-readxl-e-haven.html"><span class="header-section-number">4</span> Importando e exportando dados com readr, readxl e haven</a></li>
<li><a class="" href="transformando-dados-com-dplyr.html"><span class="header-section-number">5</span> Transformando dados com dplyr</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-a-base-de-dados-relacionais-com-dplyr.html"><span class="header-section-number">6</span> Introdução a base de dados relacionais com dplyr</a></li>
<li><a class="" href="tidy-data-uma-abordagem-para-organizar-os-seus-dados-com-tidyr.html"><span class="header-section-number">7</span> Tidy Data: uma abordagem para organizar os seus dados com tidyr</a></li>
<li class="book-part">Visualizando seus dados</li>
<li><a class="" href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html"><span class="header-section-number">8</span> Visualização de dados com ggplot2</a></li>
<li><a class="" href="configurando-componentes-est%C3%A9ticos-do-gr%C3%A1fico-no-ggplot2.html"><span class="header-section-number">9</span> Configurando componentes estéticos do gráfico no ggplot2</a></li>
<li class="book-part">Ferramentas para tipos específicos de dados</li>
<li><a class="" href="manipula%C3%A7%C3%A3o-e-transforma%C3%A7%C3%A3o-de-strings-com-stringr.html"><span class="header-section-number">10</span> Manipulação e transformação de strings com stringr</a></li>
<li><a class="" href="introduzindo-fatores-factors-com-forcats.html"><span class="header-section-number">11</span> Introduzindo fatores (factor’s) com forcats</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-%C3%A0-vari%C3%A1veis-de-tempo-com-lubridate.html"><span class="header-section-number">12</span> Introdução à variáveis de tempo com lubridate</a></li>
<li class="book-part">Funções e Loops: construindo os seus próprios programas e automatizando tarefas</li>
<li><a class="active" href="controle-condicional-de-fluxo.html"><span class="header-section-number">13</span> Controle condicional de fluxo</a></li>
<li><a class="" href="fun%C3%A7%C3%B5es.html"><span class="header-section-number">14</span> Funções</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">15</span> Loops</a></li>
<li><a class="" href="functional-programming-com-purrr.html"><span class="header-section-number">16</span> Functional programming com purrr</a></li>
<li><a class="" href="debugging---resolvendo-bugs-em-suas-fun%C3%A7%C3%B5es.html"><span class="header-section-number">17</span> Debugging - Resolvendo bugs em suas funções</a></li>
<li><a class="" href="environments-ou-ambientes-no-r.html"><span class="header-section-number">18</span> Environments ou ambientes no R</a></li>
<li class="book-part">Respostas dos exercícios de cada capítulo</li>
<li><a class="" href="respostas.html">Respostas</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="pnad-cont%C3%ADnua-arquivo-csv-para-input.html"><span class="header-section-number">A</span> PNAD Contínua: arquivo CSV para input</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/pedropark99/Introducao_R/">View book source <i class="fas fa-book-open"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="controle-condicional-de-fluxo" class="section level1" number="13">
<h1>
<span class="header-section-number">Capítulo 13</span> Controle condicional de fluxo<a class="anchor" aria-label="anchor" href="#controle-condicional-de-fluxo"><i class="fas fa-link"></i></a>
</h1>
<div id="introdução" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Introdução<a class="anchor" aria-label="anchor" href="#introdu%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h2>
<p>Haverá momentos em que você precisa tomar decisões em seu programa. A estrutura no R que te permite construir essas decisões, são os controles condicionais de fluxo. Nesse capítulo vamos rapidamente descrever o que são controles de fluxo, e focar logo em seguida, nos controles condicionais de fluxo. Apesar deles serem mais conhecidos por outros nomes, basicamente todas as linguagens de programação existentes oferecem tais controles e, por isso, eles fazem parte da base de praticamente todos os programas em uso no mundo.</p>
</div>
<div id="o-que-são-controles-de-fluxo" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> O que são controles de fluxo ?<a class="anchor" aria-label="anchor" href="#o-que-s%C3%A3o-controles-de-fluxo"><i class="fas fa-link"></i></a>
</h2>
<p>Em ciência da computação, controle de fluxo (ou <em>control flow</em>) é a ordem na qual expressões (ou comandos) são avaliados em uma dada linguagem ou programa. Mas esse termo também é utilizado para se referir à estruturas que são capazes de alterar essa “ordem de avaliação” dos comandos executados por uma dada linguagem/programa. Nesse capítulo vamos descrever uma dessas estruturas que estão disponíveis na linguagem R.</p>
<p>No R, expressões são avaliadas de maneira sequencial (um comando atrás do outro). Mas a linguagem também nos oferece algumas estruturas que alteram a forma como essas expressões podem ser avaliadas. Tais estruturas são chamadas de “elementos de controle de fluxo” nos manuais internos da linguagem <span class="citation">(<a href="refer%C3%AAncias.html#ref-Rlanguage" role="doc-biblioref">R Core Team 2020b</a>)</span>, porém, elas são mais conhecidas dentro da comunidade de R (e da comunidade de programação em geral) por um conjunto de termos (<em>loops</em>, <code>if/else</code> <em>statements</em>, <em>exception handling</em>, dentre outros).</p>
<p>Estes “elementos de controle de fluxo” são estruturas especiais criadas a partir de palavras-chave (funções também se encaixam nessa categoria), e que utilizam um par de chaves (<code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code>) para delimitar o conjunto de comandos sobre o qual essa estrutura vai atuar. Ao contornarmos esses comandos com um par de chaves, formamos o “corpo” (ou o <em>body</em>) dessa estrutura. Logo abaixo, temos uma lista dos “elementos de controle de fluxo” presentes no R. Para além dos elementos listados abaixo, temos algumas outras palavras-chave que ocorrem dentro dessas estruturas, e que também alteram a forma como o fluxo de comandos ocorre, como as palavras-chave <code><a href="https://rdrr.io/r/base/Control.html">next</a></code> e <code><a href="https://rdrr.io/r/base/Control.html">break</a></code>, as quais podem ser utilizadas dentro de algum <em>loop</em>.</p>
<p></p>
<div class="sourceCode" id="cb1396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### if statement</span>
<span class="kw">if</span> <span class="op">(</span> <span class="va">cond</span> <span class="op">)</span> <span class="op">{</span>
  <span class="va">expr</span>
<span class="op">}</span>

<span class="co">### if else statement</span>
<span class="kw">if</span> <span class="op">(</span> <span class="va">cond</span> <span class="op">)</span> <span class="op">{</span>
  <span class="va">expr1</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">expr2</span>
<span class="op">}</span>

<span class="co">### while loop</span>
<span class="kw">while</span> <span class="op">(</span> <span class="va">cond</span> <span class="op">)</span> <span class="op">{</span>
  <span class="va">expr</span>
<span class="op">}</span>

<span class="co">### repeat loop</span>
<span class="kw">repeat</span> <span class="op">{</span>
  <span class="va">expr</span>
<span class="op">}</span>

<span class="co">### for loop</span>
<span class="kw">for</span> <span class="op">(</span> <span class="va">var</span> <span class="kw">in</span> <span class="va">list</span> <span class="op">)</span> <span class="op">{</span>
  <span class="va">expr</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Muitas linguagens de programação oferecem ao menos 3 categorias principais de controles de fluxo, sendo elas: 1) controles condicionais, ou, controles de escolha (<code>if/else</code> <em>statements</em>); 2) controles de iteração (<em>loops</em>); 3) controles de exceções (<em>exception handling</em>). No R, todas essas categorias estão presentes. Entretanto, os controles de exceções estão disponíveis através de funções (como <code><a href="https://rdrr.io/r/base/try.html">try()</a></code> e <code><a href="https://rdrr.io/r/base/conditions.html">tryCatch()</a></code>), enquanto os demais tipos de controles são empregados através das estruturas especiais que mencionamos, que são formadas por palavras-chave (como <code>if</code>, <code>for</code>, <code>while</code>, etc.). O foco deste capítulo são os controles de escolha. Por isso, os controles de iteração e de exceções serão descritos em capítulos posteriores.</p>
</div>
<div id="o-que-são-controles-condicionais-de-fluxo" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> O que são controles condicionais de fluxo ?<a class="anchor" aria-label="anchor" href="#o-que-s%C3%A3o-controles-condicionais-de-fluxo"><i class="fas fa-link"></i></a>
</h2>
<p>Um controle condicional de fluxo (ou controle de escolha) lhe permite executar ou ignorar um determinado bloco de comandos com base em uma condição lógica. Dito de outra forma, um controle de escolha vai utilizar o resultado de um teste lógico, para decidir sobre executar ou não um determinado bloco de comandos. Muitos programadores e profissionais da ciência da computação em geral, conhecem os controles condicionais de fluxo pelo termo <em>“branching”</em>.</p>
<p>Nós utilizamos esse tipo de controle de fluxo, toda vez que encontramos uma bifurcação em nosso programa, e precisamos decidir sobre qual dos dois caminhos seguir. Por exemplo, suponha que eu tenha uma variável <code>x</code> em minha sessão, e que eu gostaria que o R me mostrasse no console, uma mensagem para o caso do valor dessa variável ser maior que 10, e, uma outra mensagem para o caso desse valor ser menor que 10. Tal mecanismo de mensagens poderia ser implementado da seguinte forma:</p>
<p></p>
<div class="sourceCode" id="cb1397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">5</span>

<span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"x é maior que 10!"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"x é menor que 10!"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>## [1] "x é menor que 10!"</code></pre>
<p></p>
<p>Um controle de escolha é sempre iniciado pela palavra-chave <code>if</code>, e pode ou não incluir uma palavra-chave <code>else</code> em seguida. Sendo assim, após a palavra <code>if</code>, devemos abrir um par de parênteses, e incluir dentro deles, algum teste lógico (ou um objeto que contenha um valor lógico). Depois, abrimos um par de chaves, e incluímos dentro delas, os comandos a serem executados caso o resultado do teste lógico seja <code>TRUE</code> (no exemplo acima, esse comando é <code>print("x é maior que 10!")</code>). Se você deseja que um outro conjunto de comandos sejam executados, para a hipótese do teste lógico retornar o valor <code>FALSE</code>, basta adicionar a palavra-chave <code>else</code> e abrir um novo par de chaves e incluir esse outro conjunto de comandos (no exemplo acima, esse outro comando é <code>print("x é menor que 10!")</code>) dentro delas.</p>
<p>Tendo isso em mente, e observando o resultado dos comandos acima, podemos concluir que o resultado do teste lógico <code>x &gt; 10</code> foi igual a <code>FALSE</code>, e que por isso, o R ignorou completamente o comando armazenado no primeiro par de chaves, e executou o comando definido no segundo par de chaves que está conectada pela palavra-chave <code>else</code>.</p>
<p>Portanto, olhando agora para o <em>template</em> abaixo, quando o R encontrar em seu <em>script</em> esse tipo de estrutura iniciada pela palavra <code>if</code>, ele vai primeiro, avaliar o resultado da condição lógica descrita em <code>condicao</code>. Caso o resultado desse teste seja <code>TRUE</code>, o R vai executar os comandos presentes no primeiro par de chaves. Mas caso o resultado desse teste seja <code>FALSE</code>, o R vai ignorar os comandos presentes no primeiro par de chaves, e também, vai verificar se você adicionou uma palavra <code>else</code> após esse primeiro par de chaves. Caso você tenha adicionado essa palavra, o R vai executar os comandos inseridos no par de chaves que está logo após essa palavra <code>else</code>. Vale destacar que, o resultado de <code>condicao</code> deve ser um único valor lógico (<code>TRUE</code> ou <code>FALSE</code>). Caso o resultado de <code>condicao</code> seja um vetor de valores lógicos, <code>if</code> vai utilizar apenas o primeiro valor desse vetor para realizar suas escolhas <span class="citation">(<a href="refer%C3%AAncias.html#ref-grolemund2014" role="doc-biblioref">Grolemund 2014</a>)</span>.</p>
<p></p>
<div class="sourceCode" id="cb1399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="va">condicao</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># se `condicao` for verdadeira</span>
  <span class="co"># execute esses comandos</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="co"># se `condicao` não for verdadeira</span>
  <span class="co"># execute esses comandos</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Descrevendo ainda de outra maneira, e utilizando o <em>template</em> abaixo, se o resultado de <code>condicao</code> for <code>TRUE</code>, o R vai executar os comandos descritos na área <code>comandos1</code>, e vai ignorar completamente os comandos descritos na área <code>comandos2</code>. Por outro lado, se o resultado de <code>condicao</code> for <code>FALSE</code>, o contrário ocorre, logo, o R ignora os comandos descritos em <code>comandos1</code> e executa os comandos descritos em <code>comandos2</code>. Dessa forma, um <code>if</code> <em>statement</em> é uma maneira de dizermos para o R realizar uma tarefa específica para um caso específico. Em português, um <code>if</code> <em>statement</em> pode ser traduzido como “Caso isso seja verdadeiro, faça isso, caso contrário, faça aquilo” <span class="citation">(<a href="refer%C3%AAncias.html#ref-grolemund2014" role="doc-biblioref">Grolemund 2014</a>)</span>.</p>
<p></p>
<div class="sourceCode" id="cb1400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="va">condicao</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># comandos1</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="co"># comandos2</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Você pode incluir em cada área (<code>comandos1</code> e <code>comandos2</code>) quantas linhas de comandos forem necessárias. Porém, pelo fato de um teste lógico produzir apenas dois valores possíveis (<code>TRUE</code> e <code>FALSE</code>), com 1 combinação de <code>if</code> e <code>else</code>, você é capaz de construir apenas dois blocos de comandos, ou duas possibilidades de execução. Caso você queira adicionar mais blocos possíveis de serem executados, formando uma espécie de “árvore de possibilidades,” você precisa adicionar um novo <code>if</code> após o <code>else</code>, como no exemplo abaixo:</p>
<p></p>
<div class="sourceCode" id="cb1401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">4</span>

<span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 1"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 2"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 3"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 4"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Não sei o que y é"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>## [1] "y é igual a 4"</code></pre>
<div class="sourceCode" id="cb1403"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="st">"a"</span>

<span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 1"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 2"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 3"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 4"</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Não sei o que y é"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>## [1] "Não sei o que y é"</code></pre>
<p></p>
<p>Contudo, quando você possui mais de duas possibilidades, como no exemplo acima, o seu código geralmente fica mais organizado e legível, quando você utiliza vários <code>if</code>’s individuais para cada caso, como demonstrado abaixo:</p>
<p></p>
<div class="sourceCode" id="cb1405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="st">"a"</span>

<span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 1"</span><span class="op">)</span>
<span class="op">}</span> 

<span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 2"</span><span class="op">)</span>
<span class="op">}</span> 

<span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 3"</span><span class="op">)</span>
<span class="op">}</span> 

<span class="kw">if</span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"y é igual a 4"</span><span class="op">)</span>
<span class="op">}</span> </code></pre></div>
<p></p>
<p>Perceba que, quando você não utiliza a palavra-chave <code>else</code>, o R vai executar uma ação se, e somente se o resultado do teste lógico descrito em <code>if</code> for <code>TRUE</code>. Pois sem a palavra-chave <code>else</code>, você basicamente não deu ao R, nenhuma ação a ser executada para o caso do teste lógico resultar em <code>FALSE</code>. Por isso que no exemplo acima, nenhuma das mensagens com <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> foram executadas. Pois os testes lógicos de todos os <code>if</code>’s acima, resultaram em <code>FALSE</code>.</p>
</div>
<div id="a-função-switch-como-uma-alternativa-interessante" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> A função <code>switch()</code> como uma alternativa interessante<a class="anchor" aria-label="anchor" href="#a-fun%C3%A7%C3%A3o-switch-como-uma-alternativa-interessante"><i class="fas fa-link"></i></a>
</h2>
<p>No R, temos uma função que executa um controle de fluxo semelhante ao realizado por <code>if</code> e <code>else</code>, que é a função <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code>. Porém, ao invés de utilizar o resultado de um teste lógico, essa função utiliza uma <em>string</em> ou um índice numérico para selecionar e executar um dos blocos de comandos listados.</p>
<p>Por exemplo, logo abaixo, eu forneço à função <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> o objeto <code>y</code>, o qual contém a <em>string</em> <code>"fruit"</code>. Ao receber esse valor, <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> começa a procurar por alguma opção listada cujo o nome seja igual a essa <em>string</em>. Ao se deparar com <code>fruit = "banana"</code>, <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> pega a expressão guardada nessa opção (nesse caso, a <em>string</em> <code>"banana"</code>) e a executa. Já no segundo bloco, o objeto <code>y</code> agora guarda a <em>string</em> <code>"meat"</code>, e assim, a função <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> procura novamente por uma opção listada que possua esse nome. Porém, ela não encontra nenhuma opção com o nome <code>meat</code>, e, por isso, ela acaba executando a expressão “geral” (a qual não está conectada a nenhum “nome” específico).</p>
<p></p>
<div class="sourceCode" id="cb1406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="st">"fruit"</span>
<span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="va">y</span>, fruit <span class="op">=</span> <span class="st">"banana"</span>, vegetable <span class="op">=</span> <span class="st">"broccoli"</span>, <span class="st">"Neither"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "banana"</code></pre>
<div class="sourceCode" id="cb1408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="st">"meat"</span>
<span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="va">y</span>, fruit <span class="op">=</span> <span class="st">"banana"</span>, vegetable <span class="op">=</span> <span class="st">"broccoli"</span>, <span class="st">"Neither"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "Neither"</code></pre>
<p></p>
<p>Portanto, quando fornecemos uma <em>string</em> à <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code>, a função procura por uma opção listada que possua um nome igual a essa <em>string</em>. Caso <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> encontre essa opção, a função vai executar a expressão que foi dada a essa opção. Vale destacar que essa expressão pode ser qualquer coisa, uma constante, uma função ou uma expressão que cria um novo objeto (<code>nome_objeto &lt;- valor</code>).</p>
<p></p>
<div class="sourceCode" id="cb1410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1410-1"><a href="controle-condicional-de-fluxo.html#cb1410-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"média"</span></span>
<span id="cb1410-2"><a href="controle-condicional-de-fluxo.html#cb1410-2" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span>(y, média <span class="ot">=</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">soma =</span> <span class="fu">sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="st">"Não encontrei a função"</span>)</span></code></pre></div>
<pre><code>## [1] 5.5</code></pre>
<div class="sourceCode" id="cb1412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1412-1"><a href="controle-condicional-de-fluxo.html#cb1412-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"soma"</span></span>
<span id="cb1412-2"><a href="controle-condicional-de-fluxo.html#cb1412-2" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span>(y, média <span class="ot">=</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">soma =</span> <span class="fu">sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="st">"Não encontrei a função"</span>)</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb1414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1414-1"><a href="controle-condicional-de-fluxo.html#cb1414-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"divisão"</span></span>
<span id="cb1414-2"><a href="controle-condicional-de-fluxo.html#cb1414-2" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span>(y, média <span class="ot">=</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">soma =</span> <span class="fu">sum</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="st">"Não encontrei a função"</span>)</span></code></pre></div>
<pre><code>## [1] "Não encontrei a função"</code></pre>
<p></p>
<p>Uma outra forma de selecionar a expressão a ser executada em <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> é fonecer o índice númerico que representa essa expressão. Ou seja, se eu quero executar a primeira expressão listada, eu forneço o número 1, se eu quero executar a segunda expressão listada, eu forneço o número 2, e assim por diante.</p>
<p></p>
<div class="sourceCode" id="cb1416"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="st">"Não encontrei a função"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<p></p>
</div>
<div id="em-certas-ocasiões-é-melhor-evitar-uma-árvore-de-ifs-através-de-subsetting" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Em certas ocasiões, é melhor evitar uma árvore de <code>if</code>’s através de <em>subsetting</em><a class="anchor" aria-label="anchor" href="#em-certas-ocasi%C3%B5es-%C3%A9-melhor-evitar-uma-%C3%A1rvore-de-ifs-atrav%C3%A9s-de-subsetting"><i class="fas fa-link"></i></a>
</h2>
<p>Nós utilizamos um controle de escolha para escolher que caminho perseguir em uma determinada parte de nosso programa. Entretanto, muitos usuários podem acabar utilizando <code>if</code> <em>statements</em> de uma forma não produtiva, ou ineficiente. Tenha atenção com isso. Se você está utilizando vários <code>if</code>/<code>else</code> em seu código, você provavelmente consegue refatorar esses comandos, em um formato mais claro e eficiente.</p>
<p>Isso se torna um ponto ainda mais crítico quando você está tentando lidar com várias possibilidades diferentes. Pois, apesar dos controles de escolha do R serem bastante rápidos, quando temos uma árvore muito grande de <code>if</code>’s, várias verificações lógicas precisam ser avaliadas e, com isso, ineficiências podem surgir em seu programa de maneira desnecessária. Uma das conclusões fundamentais de <span class="citation"><a href="refer%C3%AAncias.html#ref-grolemund2014" role="doc-biblioref">Grolemund</a> (<a href="refer%C3%AAncias.html#ref-grolemund2014" role="doc-biblioref">2014</a>)</span> na Parte 3 de sua obra, é que podemos quase sempre evitar esse efeito danoso, ao substituirmos nossa árvore de <code>if</code>’s por um sistema que utiliza <em>subsetting</em> sobre algum objeto de consulta que contém todas as possibilidades.</p>
<p>Por exemplo, suponha que você esteja construindo um programa que simula uma máquina caça-níquel. Quando você aciona a máquina, três símbolos são sorteados, dentre as opções “D” (diamante), “C” (cereja), “B” (banana), “G” (ouro). Caso os três símbolos seja iguais entre si, você ganha um prêmio, com base em que símbolos são esses. Suponha que 3 diamantes geram R$1000 de prêmio, enquanto 3 cerejas, 3 bananas e 3 ouros levam a prêmios de R$200, R$100 e R$600, respectivamente.</p>
<p>Portanto, nesse programa, temos um comando que sorteia o <code>resultado</code> da máquina caça-níquel, e uma outra parte, que decide qual o valor do <code>premio</code> com base nesse <code>resultado</code> sorteado. Esse é provavelmente o caso mais típico de uso indevido de um <code>if</code>/<code>else</code> <em>statements</em>, em que você está tentando determinar o valor correto de uma variável (no caso abaixo, <code>premio</code>) que pode assumir diferentes valores a depender de uma ou de várias condições lógicas.</p>
<p></p>
<div class="sourceCode" id="cb1418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Sorteando os símbolos:</span>
<span class="va">resultado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"G"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">resultado</span></code></pre></div>
<pre><code>## [1] "CGB"</code></pre>
<div class="sourceCode" id="cb1420"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">premio</span> <span class="op">&lt;-</span> <span class="fl">0</span>

<span class="kw">if</span><span class="op">(</span><span class="va">resultado</span> <span class="op">==</span> <span class="st">"DDD"</span><span class="op">)</span><span class="op">{</span>
  <span class="va">premio</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="op">}</span>

<span class="kw">if</span><span class="op">(</span><span class="va">resultado</span> <span class="op">==</span> <span class="st">"CCC"</span><span class="op">)</span><span class="op">{</span>
  <span class="va">premio</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="op">}</span>

<span class="kw">if</span><span class="op">(</span><span class="va">resultado</span> <span class="op">==</span> <span class="st">"BBB"</span><span class="op">)</span><span class="op">{</span>
  <span class="va">premio</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="op">}</span>

<span class="kw">if</span><span class="op">(</span><span class="va">resultado</span> <span class="op">==</span> <span class="st">"GGG"</span><span class="op">)</span><span class="op">{</span>
  <span class="va">premio</span> <span class="op">&lt;-</span> <span class="fl">600</span>
<span class="op">}</span>

<span class="co">### Vendo qual foi o prêmio da rodada:</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">premio</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p></p>
<p>Um método muito mais eficiente de se resolver um problema como esse, seria criarmos um vetor de consulta (ou <em>lookup vector</em>) com os valores de cada prêmio. Para criar um vetor como esse, nós armazenamos os prêmios em um vetor comum, e utilizamos a função <code><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names()</a></code> para nomearmos cada um desses valores com o respectivo resultado que o representa. Dessa forma, ao sortearmos o resultado do caça-níquel, utilizamos esse resultado como uma <em>key</em> dentro da função de <em>subsetting</em> (<code>[</code>). No exemplo abaixo, estamos fazendo isso com o comando <code>premios[resultado]</code>. Assim, o R vai procurar por um prêmio dentro do vetor <code>premios</code> que contém o mesmo nome que essa <em>key</em>.</p>
<p></p>
<div class="sourceCode" id="cb1422"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">premios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">200</span>, <span class="fl">100</span>, <span class="fl">600</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">premios</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DDD"</span>, <span class="st">"CCC"</span>, <span class="st">"BBB"</span>, <span class="st">"GGG"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">premios</span><span class="op">)</span></code></pre></div>
<pre><code>##  DDD  CCC  BBB  GGG 
## 1000  200  100  600</code></pre>
<div class="sourceCode" id="cb1424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Sorteando o resultado</span>
<span class="va">resultado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"G"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">resultado</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "BGD"</code></pre>
<div class="sourceCode" id="cb1426"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Calculando o prêmio</span>
<span class="va">premio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">premios</span><span class="op">[</span><span class="va">resultado</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">premio</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p></p>
<p>Assim como em que qualquer outra linguagem, você pode reescrever uma sentença de várias formas diferentes, sem afetar o seu significado. Porém, quando estamos tratando de linguagens de programação, certos padrões de escrita tendem a ser mais claros e eficientes do que outros. O padrão de escrita mostrado acima, em que estamos tentando determinar o valor correto de uma variável, pode ser quase sempre resumido por essa estratégia em que criamos um objeto de consulta contendo todas as possibilidades, e utilizamos a função de <em>subsetting</em> (<code>[</code>) para selecionarmos a possibilidade correta.</p>
<p>Entenda que, esse “valor correto” pode ser qualquer coisa (um <code>character</code>, um <code>double</code>, uma função, o nome de um arquivo, etc.) que o R te permite definir. Como exemplo, suponha que você receba múltiplos valores numéricos individuais, e que esses valores numéricos são acompanhados de um rótulo. Esse rótulo faz referência a um indicador específico.</p>
<p>Vamos supor que temos apenas 3 indicadores diferentes: nota média de atendimento (identificado pelo rótulo <code>"nma"</code>), tempo médio de atendimento (identificado pelo rótulo <code>"tma"</code>) e índice de conclusão de tickets (identificado pelo rótulo <code>"ict"</code>). Cada um desses 3 indicadores utilizam uma unidade diferente, ou, em outras palavras, eles são apresentados em formatos diferentes. Por exemplo, o indicador <code>tma</code> é um indicador de tempo, logo, ele pode ser apresentado no formato <code>HH:MM:SS</code>. Por outro lado, o indicador <code>ict</code> é uma proporção de quantos tickets foram concluídos, logo, ele seria apresentado como uma porcentagem <code>VV,VV%</code>.</p>
<p>Portanto, a depender do rótulo associado ao valor numérico que eu recebo, eu preciso formatar esse valor numérico de uma determinada maneira. Poderíamos organizar essas diferentes maneiras de se apresentar um determinado indicador em diferentes funções de “formatos.” Tais funções estão representadas abaixo. Todas elas esperam receber como <em>input</em>, um valor numérico qualquer, e elas produzem como <em>output</em>, uma representação em texto desse valor numérico no formato ideal para o indicador a que esse valor se refere.</p>
<p></p>
<div class="sourceCode" id="cb1428"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">format_percent</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">rn</span>, decimal.mark <span class="op">=</span> <span class="st">","</span>, big.mark <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">rn</span>, <span class="st">"%"</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">format_double</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">rn</span>, <span class="fl">2</span><span class="op">)</span>
  <span class="va">rn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">rn</span>, decimal.mark <span class="op">=</span> <span class="st">","</span>, big.mark <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rn</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">format_hour</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3600</span> <span class="op">)</span>
  <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">/</span> <span class="fl">60</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">H</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op">)</span>
  <span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">M</span> <span class="op">*</span> <span class="fl">60</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">H</span> <span class="op">*</span> <span class="fl">3600</span><span class="op">)</span> <span class="op">)</span>
  <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">H</span> <span class="op">&lt;</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">)</span>
  <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">M</span> <span class="op">&lt;</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span>
  <span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">S</span> <span class="op">&lt;</span> <span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">)</span>
  <span class="va">hour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">H</span>, <span class="st">':'</span>, <span class="va">M</span>, <span class="st">':'</span>, <span class="va">S</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">hour</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Com essas funções em mãos, você poderia construir uma árvore de <code>if</code>’s que decidiria qual dessas funções aplicar sobre um determinado valor a depender do rótulo que o acompanha. Logo abaixo, temos um exemplo deste raciocínio:</p>
<p></p>
<div class="sourceCode" id="cb1429"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">valor</span> <span class="op">&lt;-</span> <span class="fl">560.258812</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"tma"</span>

<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span> <span class="op">==</span> <span class="st">"ict"</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">format_percent</span><span class="op">(</span><span class="va">valor</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> 
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span> <span class="op">==</span> <span class="st">"tma"</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">format_hour</span><span class="op">(</span><span class="va">valor</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span> <span class="op">==</span> <span class="st">"nma"</span><span class="op">)</span><span class="op">{</span>
  <span class="fu">format_double</span><span class="op">(</span><span class="va">valor</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>## [1] "00:09:20"</code></pre>
<p></p>
<p>Entretanto, podemos facilmente refatorar esses comandos utilizando <em>subsetting</em>. Dessa forma, podemos armazenar as diferentes funções de formato dentro de uma lista e, em seguida, utilizarmos o rótulo que acompanha o valor em questão como uma <em>key</em> para acessarmos a função de formato correta dentro da lista de consulta (<code>funcoes_formato</code>), como está demonstrado abaixo:</p>
<p></p>
<div class="sourceCode" id="cb1431"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">funcoes_formato</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="st">"nma"</span> <span class="op">=</span> <span class="va">format_double</span>,
  <span class="st">"ict"</span> <span class="op">=</span> <span class="va">format_percent</span>,
  <span class="st">"tma"</span> <span class="op">=</span> <span class="va">format_hour</span>
<span class="op">)</span>

<span class="va">valor</span> <span class="op">&lt;-</span> <span class="fl">560.258812</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"tma"</span>

<span class="va">format_fun</span> <span class="op">&lt;-</span> <span class="va">funcoes_formato</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>

<span class="fu">format_fun</span><span class="op">(</span><span class="va">valor</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "00:09:20"</code></pre>
<p></p>
<p>Uma outra alternativa, seria utilizarmos a função <code><a href="https://rdrr.io/r/base/switch.html">switch()</a></code> para reorganizarmos esse código:</p>
<p></p>
<div class="sourceCode" id="cb1433"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">valor</span> <span class="op">&lt;-</span> <span class="fl">560.258812</span>
<span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"tma"</span>

<span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/names.html">names</a></span><span class="op">(</span><span class="va">valor</span><span class="op">)</span>

<span class="va">format_fun</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html">switch</a></span><span class="op">(</span>
  <span class="va">ind</span>,
  <span class="st">"nma"</span> <span class="op">=</span> <span class="va">format_double</span>,
  <span class="st">"ict"</span> <span class="op">=</span> <span class="va">format_percent</span>,
  <span class="st">"tma"</span> <span class="op">=</span> <span class="va">format_hour</span>
<span class="op">)</span>

<span class="fu">format_fun</span><span class="op">(</span><span class="va">valor</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "00:09:20"</code></pre>
<p></p>
<!-- ## O que seria um uso adequado de controles condicionais de fluxo? -->
<!-- ### *Exit early as possible* -->
<!-- Um programa (ou *script*) do R é, em geral, construído a partir de um conjunto de funções. Essas funções coletam e utilizam vários *inputs* para produzirem um *output*. Contudo, para que toda função execute a sua tarefa para a qual ela foi desenvolvida, e da maneira adequada, essa função precisa muitas vezes que certas condições sejam satisfeitas. -->
<!-- Com a frase *exit early as possible* (ou, "saia o mais rápido possível") estou destacando a importância de conferirmos se essas condições são satisfeitas, e, caso seja necessário, pararmos o mais rápido possível a execução de uma função. Com isso em mente, essa frase poderia ser comparada com "primeiro de tudo, confirme que suas condições foram satisfeitas", ou ainda, "se algo estiver errado, pare imediatamente!". -->
<!-- Portanto, em qualquer função que você venha a desenvolver no R, é sempre uma boa ideia iniciar essa função com um conjunto de conferências sobre os seus *inputs*. Se os *inputs* fornecidos à essa função, tiverem todas as características e atributos que você espera que eles tenham, você tem maior certeza de que a sua função vai funcionar da maneira correta. Porém, se algum desses *inputs* não satisfezerem alguma dessas condições, a sua função pode não ser capaz de lidar com esse *input* da forma esperada. Por essa razão, talvez seja melhor pararmos a execução, e avisarmos ao usuário de que o *input* que ele forneceu não é adequado para essa função. -->
<!-- Algumas funções que apresentamos até aqui, seguem esse princípio. Um exemplo é a função `readxl::read_excel()`. Como descrevemos no capítulo [Importando e exportando dados com `readr`, `readxl` e `haven`](#sec:importando_dados), essa função serve para lermos planilhas do Excel (`.xlsx` ou `.xls`).  -->
<!-- Logo abaixo, temos o *body* dessa função, ou em outras palavras, os comandos que ela executa. Perceba abaixo que, a primeira coisa que essa função `read_excel()` faz é executar duas outras funções (`check_format()` e `check_file()`).  -->
<!-- ```{r} -->
<!-- body(readxl::read_excel) -->
<!-- ``` -->
<!-- Essas duas funções são responsáveis pelas conferências necessárias sobre o principal *input* da função (que é o argumento `path`). Ao observarmos o *body* de `check_file()`, podemos perceber que a função realiza duas conferências principais: 1) primeiro, ela se certifica que o caminho fornecido à `read_excel()` é uma string (com a função `readxl:::is_string()`), ou, em outras palavras, um valor do tipo `character`; 2) segundo, a função se certifica que o caminho fornecido à `read_excel()` é válido, isto é, se o arquivo descrito nesse caminho existe de fato em meu computador (com a função `file.exists()`).  -->
<!-- ```{r} -->
<!-- body(readxl:::check_file) -->
<!-- ``` -->
<!-- Por que essas conferências são necessárias? Primeiro, porque caminhos até arquivos e diretórios devem ser fornecidos como *strings* no R, assim como em diversas outras linguagens de programação. Segundo, porque eu posso muito bem entregar à função, um caminho imaginário, ou seja, um caminho que não existe em meu computador. O que `read_excel()` deveria fazer nesse caso? Se o caminho não existe, será que ela deveria sequer tentar encontrar e ler o arquivo descrito nesse caminho? Provavelmente, o melhor a se fazer nesse caso seria simplesmente interrompermos a execução de `read_excel()`, e avisarmos ao usuário que o caminho dado não existe no computador em questão.  -->
<!-- Este é exatamente o papel que a função `readxl:::check_file()` cumpre. Perceba acima que essa função utiliza um `if` *statement* para executar a função `stop()`, a depender do resultado de `!file.exists(path)`. Dessa forma, se a expressão `!file_exists(path)` retornar `FALSE`, significa que o arquivo descrito no *input* `path` existe em meu computador e, por isso, a função ignora completamente o comando `stop()` que está dentro do `if` *statement*. Porém, se a expressão `!file.exists(path)` retornar `TRUE`, o `if` *statement* vai executar o comando `stop()`, e toda a execução de `read_excel()` é interrompida com uma mensagem de erro, a qual avisa o usuário que o arquivo descrito em `path` não existe. -->
<!-- A função `readxl:::check_format()` realiza um trabalho parecido. Em resumo, essa função utiliza `readxl:::excel_format()` para determinar se o arquivo descrito em `path` é de fato uma planilha do Excel, isto é, se o arquivo possui extensão `.xslx` ou `.xls`. Em seguida, a função confere com a expressão `is.na(format)`, se a função `readxl:::excel_format()` conseguiu determinar o formato do arquivo. Caso não tenha, é muito provável que o arquivo descrito em `path` não seja uma planilha do Excel e, por esse motivo, a função executa o comando `stop()` que está dentro do `if` *statement*. -->
<!-- ```{r} -->
<!-- body(readxl:::check_format) -->
<!-- ``` -->
<!-- Portanto, sempre que você estiver desenvolvendo uma função (ou o seu *script* como um todo), reflita se há alguma condição que precisa ser aceita para que a sua função (ou o seu *script*) funcione de maneira adequada. Por exemplo, vamos supor que você possui em seu *script*, uma simples soma entre duas variáveis (como `x` e `y`).  -->
<!-- ```{r} -->
<!-- x <- 15 -->
<!-- y <- 5 -->
<!-- x + y -->
<!-- ``` -->
<!-- Existe alguma condição que precisa ser satisfeita, para que essa soma ocorra como esperado? Você pode rapidamente chegar à conclusão de que ambas as variáveis (`x` e `y`) devem conter valores numéricos. Logo, seria interessante incluírmos um `if` *statement* que nos avise caso essa condição não se sustente, como está demonstrado abaixo. -->
<!-- ```{r, eval = FALSE} -->
<!-- x <- 15 -->
<!-- y <- "5" -->
<!-- if(!is.numeric(x) | !is.numeric(y)){ -->
<!--   stop("Uma das variáveis (`x` ou `y`) não contém valores numéricos!") -->
<!-- }  -->
<!-- x + y -->
<!-- ``` -->
<!-- ``` -->
<!-- Error: Uma das variáveis (`x` ou `y`) não contém valores numéricos! -->
<!-- ``` -->
<!-- ### As vezes o seu código fica mais claro com uma árvore de `if`'s -->
<!-- ```{r} -->
<!-- fun <- getAnywhere(mutate.data.frame)[["objs"]][[1]] -->
<!-- body(fun) -->
<!-- ``` -->

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introdu%C3%A7%C3%A3o-%C3%A0-vari%C3%A1veis-de-tempo-com-lubridate.html"><span class="header-section-number">12</span> Introdução à variáveis de tempo com lubridate</a></div>
<div class="next"><a href="fun%C3%A7%C3%B5es.html"><span class="header-section-number">14</span> Funções</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#controle-condicional-de-fluxo"><span class="header-section-number">13</span> Controle condicional de fluxo</a></li>
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o"><span class="header-section-number">13.1</span> Introdução</a></li>
<li><a class="nav-link" href="#o-que-s%C3%A3o-controles-de-fluxo"><span class="header-section-number">13.2</span> O que são controles de fluxo ?</a></li>
<li><a class="nav-link" href="#o-que-s%C3%A3o-controles-condicionais-de-fluxo"><span class="header-section-number">13.3</span> O que são controles condicionais de fluxo ?</a></li>
<li><a class="nav-link" href="#a-fun%C3%A7%C3%A3o-switch-como-uma-alternativa-interessante"><span class="header-section-number">13.4</span> A função switch() como uma alternativa interessante</a></li>
<li><a class="nav-link" href="#em-certas-ocasi%C3%B5es-%C3%A9-melhor-evitar-uma-%C3%A1rvore-de-ifs-atrav%C3%A9s-de-subsetting"><span class="header-section-number">13.5</span> Em certas ocasiões, é melhor evitar uma árvore de if’s através de subsetting</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/pedropark99/Introducao_R//blob/main/13-controle-fluxo.Rmd">View source <i class="fas fa-book-open"></i></a></li>
          <li><a id="book-edit" href="https://github.com/pedropark99/Introducao_R//edit/main/13-controle-fluxo.Rmd">Edit this page <i class="fas fa-book-open"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introdução à Linguagem R: seus fundamentos e sua prática</strong>" was written by Pedro Faria. It was last built on 2022-04-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
