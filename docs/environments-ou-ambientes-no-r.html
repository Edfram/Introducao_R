<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 18 Environments ou ambientes no R | Introdução à Linguagem R: seus fundamentos e sua prática</title>
<meta name="author" content="Pedro Faria">
<meta name="description" content="18.1 Introdução Todo objeto existente no R está armazenado em um environment (ou ambiente) específico. Como é destacado por WICKHAM (2015a) os environments são a estrutura de dados que sustenta o...">
<meta name="generator" content="bookdown 0.26.3 with bs4_book()">
<meta property="og:title" content="Capítulo 18 Environments ou ambientes no R | Introdução à Linguagem R: seus fundamentos e sua prática">
<meta property="og:type" content="book">
<meta property="og:url" content="bem-vindo.html/environments-ou-ambientes-no-r.html">
<meta property="og:image" content="bem-vindo.html/capa.png">
<meta property="og:description" content="18.1 Introdução Todo objeto existente no R está armazenado em um environment (ou ambiente) específico. Como é destacado por WICKHAM (2015a) os environments são a estrutura de dados que sustenta o...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 18 Environments ou ambientes no R | Introdução à Linguagem R: seus fundamentos e sua prática">
<meta name="twitter:description" content="18.1 Introdução Todo objeto existente no R está armazenado em um environment (ou ambiente) específico. Como é destacado por WICKHAM (2015a) os environments são a estrutura de dados que sustenta o...">
<meta name="twitter:image" content="bem-vindo.html/capa.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 1em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introdução à Linguagem R: seus fundamentos e sua prática</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem vindo!</a></li>
<li><a class="" href="sobre-o-autor.html">Sobre o autor</a></li>
<li><a class="" href="pref%C3%A1cio.html">Prefácio</a></li>
<li class="book-part">Introduzindo a Linguagem R</li>
<li><a class="" href="no%C3%A7%C3%B5es-b%C3%A1sicas-do-r.html"><span class="header-section-number">1</span> Noções Básicas do R</a></li>
<li><a class="" href="fundamentos-da-linguagem-r.html"><span class="header-section-number">2</span> Fundamentos da Linguagem R</a></li>
<li class="book-part">Importando, organizando e transformando dados</li>
<li><a class="" href="introduzindo-o-universo-do-tidyverse.html"><span class="header-section-number">3</span> Introduzindo o universo do tidyverse</a></li>
<li><a class="" href="importando-e-exportando-dados-com-readr-readxl-e-haven.html"><span class="header-section-number">4</span> Importando e exportando dados com readr, readxl e haven</a></li>
<li><a class="" href="transformando-dados-com-dplyr.html"><span class="header-section-number">5</span> Transformando dados com dplyr</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-a-base-de-dados-relacionais-com-dplyr.html"><span class="header-section-number">6</span> Introdução a base de dados relacionais com dplyr</a></li>
<li><a class="" href="tidy-data-uma-abordagem-para-organizar-os-seus-dados-com-tidyr.html"><span class="header-section-number">7</span> Tidy Data: uma abordagem para organizar os seus dados com tidyr</a></li>
<li class="book-part">Visualizando seus dados</li>
<li><a class="" href="visualiza%C3%A7%C3%A3o-de-dados-com-ggplot2.html"><span class="header-section-number">8</span> Visualização de dados com ggplot2</a></li>
<li><a class="" href="configurando-componentes-est%C3%A9ticos-do-gr%C3%A1fico-no-ggplot2.html"><span class="header-section-number">9</span> Configurando componentes estéticos do gráfico no ggplot2</a></li>
<li class="book-part">Ferramentas para tipos específicos de dados</li>
<li><a class="" href="manipula%C3%A7%C3%A3o-e-transforma%C3%A7%C3%A3o-de-strings-com-stringr.html"><span class="header-section-number">10</span> Manipulação e transformação de strings com stringr</a></li>
<li><a class="" href="introduzindo-fatores-factors-com-forcats.html"><span class="header-section-number">11</span> Introduzindo fatores (factor’s) com forcats</a></li>
<li><a class="" href="introdu%C3%A7%C3%A3o-%C3%A0-vari%C3%A1veis-de-tempo-com-lubridate.html"><span class="header-section-number">12</span> Introdução à variáveis de tempo com lubridate</a></li>
<li class="book-part">Funções e Loops: construindo os seus próprios programas e automatizando tarefas</li>
<li><a class="" href="controle-condicional-de-fluxo.html"><span class="header-section-number">13</span> Controle condicional de fluxo</a></li>
<li><a class="" href="fun%C3%A7%C3%B5es.html"><span class="header-section-number">14</span> Funções</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">15</span> Loops</a></li>
<li><a class="" href="functional-programming-com-purrr.html"><span class="header-section-number">16</span> Functional programming com purrr</a></li>
<li><a class="" href="debugging---resolvendo-bugs-em-suas-fun%C3%A7%C3%B5es.html"><span class="header-section-number">17</span> Debugging - Resolvendo bugs em suas funções</a></li>
<li><a class="active" href="environments-ou-ambientes-no-r.html"><span class="header-section-number">18</span> Environments ou ambientes no R</a></li>
<li class="book-part">Respostas dos exercícios de cada capítulo</li>
<li><a class="" href="respostas.html">Respostas</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="pnad-cont%C3%ADnua-arquivo-csv-para-input.html"><span class="header-section-number">A</span> PNAD Contínua: arquivo CSV para input</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/pedropark99/Introducao_R/">View book source <i class="fas fa-book-open"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="environments-ou-ambientes-no-r" class="section level1" number="18">
<h1>
<span class="header-section-number">Capítulo 18</span> <em>Environments</em> ou ambientes no R<a class="anchor" aria-label="anchor" href="#environments-ou-ambientes-no-r"><i class="fas fa-link"></i></a>
</h1>
<div id="introdução-3" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> Introdução<a class="anchor" aria-label="anchor" href="#introdu%C3%A7%C3%A3o-3"><i class="fas fa-link"></i></a>
</h2>
<p>Todo objeto existente no R está armazenado em um <em>environment</em> (ou ambiente) específico. Como é destacado por <span class="citation">WICKHAM (<a href="refer%C3%AAncias.html#ref-wickham2015_advanced" role="doc-biblioref">2015a</a>)</span> os <em>environments</em> são a estrutura de dados que sustenta o processo de <em>scoping</em> do R, isto é, as regras de “busca” por objetos da linguagem R.</p>
<p>Compreender o que é um <em>environment</em> é algo bastante simples. Porém, entender como os vários <em>environments</em> ativos em sua sessão funcionam em conjunto, representa um outro nível de dificuldade. Mesmo assim, <em>environments</em> são estruturas muito importantes para a linguagem R, e que sustentam grande parte das operações realizadas pelos pacotes <code>dplyr</code> e <code>ggplot2</code>.</p>
<p>Além disso, <em>environments</em> são parte fundamental da reprodutibilidade dos programas criados pela linguagem R. Pois eles são as estruturas responsáveis por garantir que os diferentes componentes de seu programa sejam únicos e independentes entre si.</p>
<p>Ao longo deste capítulo vamos utilizar algumas funções do pacote <code>rlang</code>. Sendo assim, para que você possa acompanhar alguns dos exemplos a seguir, é necessário que esse pacote esteja instalado em sua máquina.</p>
<p></p>
<div class="sourceCode" id="cb1822"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org">rlang</a></span><span class="op">)</span></code></pre></div>
<p></p>
</div>
<div id="sec:environments" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> Noções básicas de <em>environments</em><a class="anchor" aria-label="anchor" href="#sec:environments"><i class="fas fa-link"></i></a>
</h2>
<p>Para além de uma linguagem que trabalha com objetos, o R é também uma linguagem que trabalha com objetos que estão contidos (ou guardados) em certos <em>environments</em>. Um <em>environment</em> (ou ambiente) no R, é muito parecido com uma lista nomeada. Cada nome presente nessa lista, corresponde ao nome de um objeto que está armazenado nesse respectivo <em>environment</em>.</p>
<p>Segundo <span class="citation">WICKHAM (<a href="refer%C3%AAncias.html#ref-wickham2015_advanced" role="doc-biblioref">2015a</a>)</span>, todo <em>environment</em> carrega algumas propriedades:</p>
<ul>
<li><p>Todos os nomes em um <em>environment</em> são únicos (isso garante que dois ou mais objetos de mesmo nome não existam dentro de um mesmo environment);</p></li>
<li><p>Os nomes presentes em um <em>environment</em> não são ordenados;</p></li>
<li><p>Todo <em>environment</em> possui um <em>environment</em> “pai”;</p></li>
<li><p>Um <em>environment</em> é modificado <em>in place</em> (ou seja, ele não é copiado quando ele é modificado).</p></li>
</ul>
<p>Quando estamos trabalhando com um determinado objeto, geralmente nos referimos a este objeto através de seu nome, contudo, o nome é apenas parte desta referência, <strong>pois objetos existem dentro de um determinado contexto, ou escopo</strong>. Portanto, no R, uma referência completa a um determinado objeto, é na verdade, a combinação entre o nome deste objeto e o <em>environment</em> no qual ele está inserido <span class="citation">(<a href="refer%C3%AAncias.html#ref-chambers2016" role="doc-biblioref">CHAMBERS, 2016</a>)</span>.</p>
</div>
<div id="descobrindo-o-environment-atual" class="section level2" number="18.3">
<h2>
<span class="header-section-number">18.3</span> Descobrindo o <em>environment</em> atual<a class="anchor" aria-label="anchor" href="#descobrindo-o-environment-atual"><i class="fas fa-link"></i></a>
</h2>
<p>Independentemente de onde você esteja dentro do R, você sempre é capaz de identificar qual é o <em>environment</em> atual através da função <code><a href="https://rdrr.io/r/base/environment.html">environment()</a></code>. Basta executar essa função, e, o endereço do <em>environment</em> no qual você está será retornado como resultado.</p>
<p>Perceba abaixo que, ao executar essa função em minha sessão atual do R, o endereço <code>R_GlobalEnv</code> é retornado. Normalmente, <em>environments</em> são identificados através do endereço da memória RAM no qual eles estão localizados. Contudo, esse valor <code>R_GlobalEnv</code> representa um apelido para um <em>environment</em> especial do R, chamado de <em>global environment</em>. Vamos discutir esse <em>environment</em> na próxima seção.</p>
<p></p>
<div class="sourceCode" id="cb1823"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">environment</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>Em termos mais técnicos, o que a função <code><a href="https://rdrr.io/r/base/environment.html">environment()</a></code> faz é retornar o endereço do <em>environment</em> no qual ela é executada. Portanto, o resultado dessa função depende diretamente de <strong>onde</strong> você a executa.</p>
<p>Logo, se o comando <code><a href="https://rdrr.io/r/base/environment.html">environment()</a></code> está sendo executado dentro do <em>body</em> de uma função chamada <code>f</code>, o resultado será o <em>environment</em> de execução dessa função <code>f</code>. Mas, se você executar esse comando diretamente no seu console do R, o resultado será diferente.</p>
</div>
<div id="o-environment-global" class="section level2" number="18.4">
<h2>
<span class="header-section-number">18.4</span> O <em>environment</em> global<a class="anchor" aria-label="anchor" href="#o-environment-global"><i class="fas fa-link"></i></a>
</h2>
<p>Normalmente, quando digitamos o nome de um determinado objeto, nós não estamos preocupados com o <em>environment</em> no qual este objeto está guardado. Pois o próprio R realiza o trabalho duro de procurar por este objeto ao longo de todos os <em>environments</em> ativos em sua sessão, atrás de um objeto que possua o mesmo nome que você digitou. Tal mecanismo de procura é denominado de <em>scoping</em> ou de <em>lexical scoping</em> <span class="citation">(<a href="refer%C3%AAncias.html#ref-wickham2015_advanced" role="doc-biblioref">WICKHAM, 2015a</a>)</span>, e ele geralmente se inicia pelo seu <em>global environment</em>.</p>
<p>Toda vez que você inicia a sua sessão no R, você está trabalhando com um <em>environment</em> especial que chamamos de <em>global environment</em>, ou ambiente global. Logo, todos os objetos que você normalmente cria em sua sessão, são guardados dentro deste <em>global environment</em>.</p>
<p>Você pode se referir a esse <em>environment</em> através da função <code><a href="https://rdrr.io/r/base/environment.html">globalenv()</a></code>. Como exemplo, eu posso usar a função <code><a href="https://rdrr.io/r/base/ls.html">ls()</a></code> para listar os nomes de todos os objetos que estão disponíveis especificamente neste <em>global environment</em>. Como vimos na seção passada, o endereço desse <em>environment</em> é referenciado como <code>R_GlobalEnv</code>.</p>
<p></p>
<div class="sourceCode" id="cb1825"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">globalenv</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p></p>
<p></p>
<div class="sourceCode" id="cb1827"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Iniciei uma nova sessão no R</span>

<span class="co"># Criei alguns objetos</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span>

<span class="co"># ls() lista todos os objetos criados</span>
<span class="co"># em meu global environment</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span>envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## [1] "a" "b"</code></pre>
<p>Portanto, um <em>environment</em> é uma espécie de caixa ou um espaço reservado para guardar um certo conjunto de objetos. O seu <em>global environment</em> é um desses <em>environments</em>, onde ficam todos os seus objetos que você normalmente cria em sua sessão. Todavia, sempre existem vários outros <em>environments</em> ativos em sua sessão, e você também pode criar objetos dentro desses outros <em>environments</em> (caso seja de seu desejo).</p>
</div>
<div id="sec:environment_exec" class="section level2" number="18.5">
<h2>
<span class="header-section-number">18.5</span> O <em>environment</em> de execução de uma função<a class="anchor" aria-label="anchor" href="#sec:environment_exec"><i class="fas fa-link"></i></a>
</h2>
<p>Toda função no R, possui o que nós chamamos de <em>function environment</em>, que corresponde ao <em>environment</em> no qual elas foram criadas. No exemplo abaixo, estamos identificando quais são esses <em>environments</em> para as funções <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> do pacote <code>dplyr</code>, e <code><a href="https://rdrr.io/r/base/seq.html">seq()</a></code> do pacote <code>base</code>.</p>
<p></p>
<div class="sourceCode" id="cb1829"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/fn_env.html">fn_env</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: namespace:dplyr&gt;</code></pre>
<div class="sourceCode" id="cb1831"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/fn_env.html">fn_env</a></span><span class="op">(</span><span class="va">seq</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: namespace:base&gt;</code></pre>
<p></p>
<p>Como um outro exemplo, caso eu crie uma nova função em minha sessão, perceba que o <em>environment</em> a qual ela pertence, se trata justamente do <em>global environment</em> (<code>R_GlobalEnv</code>).</p>
<p></p>
<div class="sourceCode" id="cb1833"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">soma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/fn_env.html">fn_env</a></span><span class="op">(</span><span class="va">soma</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>Por outro lado, se eu quiser, por exemplo, criar uma função chamada <code>g</code> dentro de uma outra função chamada <code>h</code>, o <em>function environment</em> de <code>g()</code> será o <em>environment</em> de execução de <code>h()</code>. Pois a função <code>g()</code> foi criada dentro deste <em>environment</em> de <code>h()</code>.</p>
<p></p>
<div class="sourceCode" id="cb1835"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">h</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">g_env</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/fn_env.html">fn_env</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">g_env</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">h</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d7a827b78&gt;</code></pre>
<p></p>
<p>Portanto, as funções também possuem o que chamamos de <em>environment</em> de execução, que se trata do <em>environment</em> no qual os seus cálculos são executados. Ou seja, sempre que você executa uma função, os cálculos realizados por essa função são feitos em um <em>environment</em> separado de seu <em>global environment</em>.</p>
<p>Como expomos ao final do capítulo de <a href="fun%C3%A7%C3%B5es.html#sec:functions_chapter">Funções</a>, quando uma função é executada, um novo <em>environment</em> vazio é criado. Em seguida, um objeto para cada argumento fornecido à função é criado dentro desse novo <em>environment</em>. Por último, todos os comandos presentes no body dessa função são executados dentro desse novo <em>environment</em> <span class="citation">(<a href="refer%C3%AAncias.html#ref-chambers2016" role="doc-biblioref">CHAMBERS, 2016</a>, p 52)</span>.</p>
<p>Por esse motivo, você não consegue visualizar com facilidade, os resultados que são gerados por essa função, pois os seus cálculos estão sendo realizados em um <em>environment</em> diferente do <em>environment</em> no qual você se encontra (<em>global environment</em>).</p>
<p>Em contrapartida, essa característica garante que uma função não afete os objetos de seu <em>global environment</em>. Isso também permite que uma função do R seja <em>self-contained</em>, de modo que, os seus resultados dependam apenas dos valores de seus argumentos, e não dos objetos de outros <em>environments</em> presentes em sua sessão <span class="citation">(<a href="refer%C3%AAncias.html#ref-chambers2016" role="doc-biblioref">CHAMBERS, 2016</a>)</span>.</p>
<p>Para demonstrar esse conceito de <em>environment</em> de execução, estou criando abaixo uma função chamada <code>f_env</code>, que nos retorna justamente o endereço do <em>environment</em> no qual essa função executou a soma entre 4 e 5. Perceba que a cada momento em que eu executo essa função, ela me retorna um endereço diferente.</p>
<p>Logo, esses <em>environments</em> de execução são temporários (ou efêmeros se preferir), e utilizados uma única vez pela função. Por causa disso, no R, cada execução de uma função é independente uma da outra. A função não sabe absolutamente nada sobre o que aconteceu na última vez em que ela foi avaliada.</p>
<p></p>
<div class="sourceCode" id="cb1837"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f_env</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">soma</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="op">+</span> <span class="fl">5</span>
  
  <span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html">environment</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rlang.r-lib.org/reference/f_rhs.html">f_env</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d79bc1d00&gt;</code></pre>
<div class="sourceCode" id="cb1839"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rlang.r-lib.org/reference/f_rhs.html">f_env</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d79907a30&gt;</code></pre>
<p></p>
<!-- Contudo, só porque esses *environments* são temporários, isso não significa que eles são deletados, ou, que os objetos criados durante a execução da função, são eliminados após a sua finalização. Perceba no exemplo abaixo, que eu consigo acessar normalmente o objeto `soma`, após a execução da função `f()`. Porém, para encontrar esse objeto, eu preciso obrigatoriamente do endereço do *environment* de execução, o qual foi salvo no objeto `x`. -->
<!-- ```{r} -->
<!-- f <- function(){ -->
<!--   soma <- 4 + 5 -->
<!--   env <- environment() -->
<!--   return(env) -->
<!-- } -->
<!-- x <- f() -->
<!-- get("soma", envir = x) -->
<!-- ``` -->
<p>O exemplo abaixo, demonstra essa ideia de que os <em>environments</em> de execução asseguram que toda função não altere os nossos objetos salvos em nosso <em>global environment</em>. Dentro da função <code>f()</code> mostrada abaixo, estou criando um objeto chamado <code>y</code> com o valor de 100. Porém, mesmo após executar essa função, o objeto <code>y</code> que está salvo em meu <em>global environment</em> continua armazenando o valor 1.</p>
<p></p>
<div class="sourceCode" id="cb1841"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Crie um objeto y em meu global environment</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="op">}</span>

<span class="co">### Executo a função f()</span>
<span class="fu">f</span><span class="op">(</span><span class="op">)</span>

<span class="co">### O valor de y continua igual a 1</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p></p>
<div id="os-environments-de-pacotes" class="section level3" number="18.5.1">
<h3>
<span class="header-section-number">18.5.1</span> Os <em>environments</em> de pacotes<a class="anchor" aria-label="anchor" href="#os-environments-de-pacotes"><i class="fas fa-link"></i></a>
</h3>
<p>Portanto, o trabalho de um <em>environment</em> no R, é o de vincular, ou de associar um conjunto de nomes (os nomes dos objetos), a seus respectivos conjuntos de valores . Ou seja, um dos principais papéis que um <em>environment</em> desempenha no R, é o de organizar um conjunto de objetos, de forma que o R seja capaz de diferenciar dois ou mais objetos com o mesmo nome.</p>
<p>Um bom exemplo disso, é a função <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> do pacote <code>dplyr</code>, que vimos no capítulo 4. Pois nós temos dentre os pacotes básicos do R, mais especificamente no pacote <code>stats</code>, uma outra função também chamada <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>. Por isso, sempre que chamamos pelo pacote <code>dplyr</code> através de <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>, a seguinte mensagem aparece, nos informando que há um choque entre as duas funções.</p>
<p></p>
<div class="sourceCode" id="cb1843"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></code></pre></div>
<p></p>
<p></p>
<pre class="text"><code>Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag</code></pre>
<p></p>
<p>Essa mensagem está nos informando, que o pacote <code>dplyr</code> possui funções com os mesmos nomes das funções <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> e <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag()</a></code> do pacote <code>stats</code>, e, que por esse motivo, essas funções seriam “escondidas” de forma a evitar conflitos.</p>
<p>Portanto, após carregarmos o pacote <code>dplyr</code> com <code><a href="https://rdrr.io/r/base/library.html">library()</a></code>, as funções <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> e <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag()</a></code> do pacote <code>stats</code> são “escondidas”. Como resultado, se nós chamarmos pela função <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> no console, estaremos utilizando a função do pacote <code>dplyr</code>, e não a função do pacote <code>stats</code>.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-989"></span>
<img src="Figuras/environments.png" alt="Ambientes de pacotes no R" width="80%"><p class="caption">
Figura 18.1: Ambientes de pacotes no R
</p>
</div>
<p></p>
<p>Portanto, essas duas funções <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code>, são funções diferentes, que servem para propósitos diferentes. O único fator que permite ao R, diferenciar essas funções uma da outra, é o fato de que elas pertencem a ambientes, ou <em>environments</em> diferentes, como demonstrado na figura 18.1. Lembre-se que todas as funções estão associadas a um <em>environment</em> específico. Por isso, nós podemos diferenciar as funções <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> e <code><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag()</a></code> de ambos os pacotes (<code>dplyr</code> e <code>stats</code>), através do nome do <em>environment</em> ao qual essas funções pertencem.</p>
<p>Pacotes do R são um caso especial, pois eles contêm dois <em>environments</em> diferentes que se relacionam entre si. Um é o <em>environment</em> propriamente dito do pacote, que contém os seus respectivos objetos, e um outro comumente chamado de <em>namespace</em>. Essa diferenciação só será útil na prática, quando você estiver desenvolvendo um novo pacote para o R.</p>
<p>Ou seja, não se preocupe em entender agora a diferença entre esses dois espaços. Apenas entenda que, pacotes no R, vão além de simples <em>environments</em>. Também entenda que, os objetos e funções de todo pacote do R estão sempre armazenados no <em>environment</em> deste pacote, o qual é um <em>environment</em> separado de seu <em>global environment</em>.</p>
<p>Tendo isso em mente, quando desejamos utilizar uma função que está em conflito com uma outra função de um outro pacote, nós devemos definir de alguma forma, o <em>environment</em> do pacote no qual o R deve procurar pela função que você está chamando.</p>
<p>No caso de pacotes, podemos acessar funções definidas em seus respectivos <em>environments</em>, ao fornecer o nome do pacote que contém essa função, seguido do operador <code>::</code>, e do nome da função que desejamos utilizar. Veja o exemplo abaixo, em que estamos utilizando a função <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> do pacote <code>stats</code>.</p>
<p></p>
<div class="sourceCode" id="cb1845"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1990</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1998</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>

<span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span>, filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##             Jan         Feb         Mar         Apr         May
## 166                                                            
## 167 -0.11875469  1.91074629  1.68731392 -0.41976451 -0.62389218
## 168 -0.90010012 -0.67343101  0.88807883  1.50201948  2.00649477
## 169 -0.05060343 -0.23506634 -0.74108286 -0.64042848  0.36716686
## 170  0.01642278  0.22333764  1.43799155  1.52000248  1.58566817
##             Jun         Jul         Aug         Sep         Oct
## 166                                                          NA
## 167  0.17942147  1.20670912  1.87466329  0.79380123  0.55794457
## 168  0.45995674 -0.16749206 -0.12045702 -1.25194953 -1.04400313
## 169  0.15365047 -0.68626295  0.33691878  0.91669945  0.76497798
## 170          NA                                                
##             Nov         Dec
## 166 -0.23944009 -0.41419107
## 167 -0.21128700 -0.49462199
## 168 -0.23921563 -0.29579158
## 169  0.15428223  0.36872766
## 170</code></pre>
<p></p>
</div>
</div>
<div id="acessando-outros-environments" class="section level2" number="18.6">
<h2>
<span class="header-section-number">18.6</span> Acessando outros environments<a class="anchor" aria-label="anchor" href="#acessando-outros-environments"><i class="fas fa-link"></i></a>
</h2>
<p>Já mostramos que você pode acessar o <em>environment</em> atual através da função <code><a href="https://rdrr.io/r/base/environment.html">environment()</a></code>. Também mostramos que você pode acessar o seu <em>global environment</em> por meio da função <code><a href="https://rdrr.io/r/base/environment.html">globalenv()</a></code>. Agora, a questão que fica é: como podemos acessar outros <em>environments</em> que estão presentes no caminho de pesquisa do R?</p>
<p>Por exemplo, como podemos acessar o <em>environment</em> do pacote <code>dplyr</code>? Para isso podemos utilizar as funções <code><a href="https://rdrr.io/r/base/as.environment.html">as.environment()</a></code> e <code><a href="https://rlang.r-lib.org/reference/as_environment.html">rlang::as_environment()</a></code>. Ambas as funções desempenham basicamente o mesmo trabalho. Utilizando essas funções, podemos acessar o <em>environment</em> do pacote <code>dplyr</code> ao fornecer o nome de seu <em>environment</em>, como demonstrado abaixo.</p>
<p>Perceba que, se você utilizar a função <code><a href="https://rdrr.io/r/base/as.environment.html">as.environment()</a></code> (dos pacotes básicos do R), você precisa fornecer o nome completo do <em>environment</em>. Por se tratar do <em>environment</em> de um pacote, o nome deste pacote precisa ser antecedido por <code>package:</code>. Por outro lado, a função <code><a href="https://rlang.r-lib.org/reference/as_environment.html">rlang::as_environment()</a></code> é inteligente o suficiente para pesquisar por um pacote com o nome que você digitou.</p>
<p></p>
<div class="sourceCode" id="cb1847"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/as.environment.html">as.environment</a></span><span class="op">(</span><span class="st">"package:dplyr"</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: package:dplyr&gt;
## attr(,"name")
## [1] "package:dplyr"
## attr(,"path")
## [1] "C:/Users/pedro/AppData/Local/R/win-library/4.2/dplyr"</code></pre>
<div class="sourceCode" id="cb1849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/as_environment.html">as_environment</a></span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: package:dplyr&gt;
## attr(,"name")
## [1] "package:dplyr"
## attr(,"path")
## [1] "C:/Users/pedro/AppData/Local/R/win-library/4.2/dplyr"</code></pre>
<p></p>
<p>Como um outro exemplo, vamos refletir sobre o objeto <code>LETTERS</code>. Esse objeto está sempre disponível em sua sessão no R. Pois ele pertence ao <em>environment</em> do pacote <code>base</code> (o qual faz parte dos pacotes básicos da linguagem, e, portanto, é <strong>sempre</strong> carregado para a sua sessão).</p>
<p>Vamos supor que eu crie um novo objeto chamado <code>LETTERS</code> em meu <em>global environment</em>. Como resultado, se eu procurar por este objeto no console do R, o objeto encontrado será este novo objeto salvo em meu <em>global environment</em>. Pois o processo de busca do R geralmente se inicia pelo <em>global environment</em>.</p>
<p></p>
<div class="sourceCode" id="cb1851"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Este é o objeto LETTERS salvo no</span>
<span class="co">### *environment* do pacote `base`</span>
<span class="va">LETTERS</span></code></pre></div>
<p></p>
<p></p>
<pre><code>##  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q"
## [18] "R" "S" "T" "U" "V" "W" "X" "Y" "Z"</code></pre>
<p></p>
<p></p>
<div class="sourceCode" id="cb1853"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Estou criando um novo objeto LETTERS em</span>
<span class="co">### meu global environment</span>
<span class="va">LETTERS</span> <span class="op">&lt;-</span> <span class="st">"a"</span>

<span class="co">### Agora, se eu procurar por um objeto</span>
<span class="co">### LETTERS, o R vai encontrar primeiro o objeto </span>
<span class="co">### salvo em meu global environment</span>
<span class="va">LETTERS</span></code></pre></div>
<pre><code>## [1] "a"</code></pre>
<p></p>
<p>Vale destacar que, o objeto <code>LETTERS</code> original, ainda existe dentro do <em>environment</em> do pacote <code>base</code>. A única diferença é que, antes de chegar ao <em>environment</em> do pacote <code>base</code>, o R está encontrando primeiro o objeto <code>LETTERS</code> salvo em meu global <em>environment</em>. Logo, ele retorna esse objeto contendo o valor <code>"a"</code>, ao invés do objeto original.</p>
<p>Pelo fato de termos dois objetos <code>LETTERS</code> diferentes em nossa sessão, para acessarmos o objeto <code>LETTERS</code> original, precisamos definir o <em>environment</em> no qual o R deve pesquisar por este objeto. Como este objeto <code>LETTERS</code> pertence a um pacote do R, podemos utilizar a mesma estrutura que utilizamos para acessar a função <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> do pacote <code>stats</code>, como demonstrado abaixo.</p>
<p></p>
<div class="sourceCode" id="cb1855"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">base</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/base/Constants.html">LETTERS</a></span></code></pre></div>
<pre><code>##  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q"
## [18] "R" "S" "T" "U" "V" "W" "X" "Y" "Z"</code></pre>
<p></p>
<p>Contudo, como uma outra alternativa, também podemos utilizar a função <code><a href="https://rdrr.io/r/base/get.html">get()</a></code> para especificarmos melhor, qual dos dois objetos desejamos acessar. Pois essa função possui um argumento (<code>envir</code>) onde podemos definir o <em>environment</em> em que o objeto deve ser pesquisado.</p>
<p>Como exemplo, para acessarmos o objeto <code>LETTERS</code> original, precisamos pesquisar por ele dentro do <em>environment</em> do pacote <code>base</code>. Por isso, eu forneço abaixo, o <em>environment</em> deste pacote ao argumento <code>envir</code>.</p>
<p></p>
<div class="sourceCode" id="cb1857"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">"LETTERS"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.environment.html">as.environment</a></span><span class="op">(</span><span class="st">"package:base"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N" "O" "P" "Q"
## [18] "R" "S" "T" "U" "V" "W" "X" "Y" "Z"</code></pre>
<p></p>
<p>Portanto, mesmo que eu crie um objeto em minha sessão, ou em outras palavras, um objeto em meu <em>global environment</em> chamado <code>LETTERS</code>, o R ainda é capaz de diferenciar os dois objetos denominados <code>LETTERS</code>, através do <em>environment</em> ao qual eles estão associados. Esta ideia está apresentada de forma visual na figura 18.2.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-997"></span>
<img src="Figuras/environments2.png" alt="Representação de environments" width="90%"><p class="caption">
Figura 18.2: Representação de environments
</p>
</div>
<p></p>
<p>Após criarmos um novo objeto <code>LETTERS</code>, se eu chamar por este objeto no console, o resultado será o valor contido no objeto <code>LETTERS</code> do meu <em>global environment</em>. Isso ocorre, pois o R irá geralmente procura por um objeto primeiro em seu <em>global environment</em>. Depois ele vai procurar por este objeto ao qual você requisitou em outros <em>environments</em>.</p>
<p>Esse caminho de <em>environments</em> pelo qual o R percorre durante sua procura, é comumente chamado por <em>search path</em> (ou “caminho de busca”). Como vimos acima, podemos utilizar a função <code><a href="https://rdrr.io/r/base/get.html">get()</a></code> sempre que desejamos contornar esse caminho padrão seguido pelo R, e, pesquisar por nosso objeto em um <em>environment</em> específico.</p>
<p>Concluindo, nós geralmente desejamos acessar um <em>environment</em> específico, quando temos dois objetos existentes em nossa sessão que possuem o mesmo nome, porém, são diferentes entre si. Nesse caso, precisamos unir o nome deste objeto, e o <em>environment</em> ao qual ele pertence, para acessarmos o objeto correto.</p>
<p>Caso esse objeto em questão, pertença a um pacote do R específico, podemos utilizar a estrutura <code>pacote::objeto</code> para acessarmos esse objeto. No entanto, se esse objeto pertence a um outro tipo de <em>environment</em>, podemos utilizar a função <code><a href="https://rdrr.io/r/base/get.html">get()</a></code> e seu argumento <code>envir</code>, para definirmos em que <em>environment</em> específico, o objeto deve ser pesquisado.</p>
</div>
<div id="o-sistema-de-scoping-do-r" class="section level2" number="18.7">
<h2>
<span class="header-section-number">18.7</span> O sistema de <em>scoping</em> do R<a class="anchor" aria-label="anchor" href="#o-sistema-de-scoping-do-r"><i class="fas fa-link"></i></a>
</h2>
<p>Sempre que você digita o nome de um objeto, o R inicia um processo de busca ao longo de todos os <em>environments</em> ativos em sua sessão, atrás de um objeto que possua o mesmo nome do que você digitou. Esse processo de busca é chamado de <em>scoping</em>, ou, <em>lexical scoping</em>.</p>
<p>Antes de explicar como esse mecanismo de busca funciona, precisamos descrever o que é um <em>parent environment</em>. Pois eles determinam qual o caminho que o R vai perseguir durante a sua pesquisa.</p>
<div id="compreendendo-parent-environments" class="section level3" number="18.7.1">
<h3>
<span class="header-section-number">18.7.1</span> Compreendendo <em>parent environments</em><a class="anchor" aria-label="anchor" href="#compreendendo-parent-environments"><i class="fas fa-link"></i></a>
</h3>
<p>Todo <em>environment</em> possui um <em>environment</em> “pai”. Dentro da comunidade, esse tipo de <em>environment</em> é chamado de <em>parent environment</em>. Como exemplo, vamos supor que você crie um novo <em>environment</em> a partir de seu global <em>environment</em>.</p>
<p>Para criar um novo <em>environment</em>, você pode utilizar as funções <code><a href="https://rlang.r-lib.org/reference/env.html">rlang::env()</a></code> e <code><a href="https://rdrr.io/r/base/environment.html">new.env()</a></code>. Perceba abaixo, que eu não apenas crio esse novo <em>environment</em> chamado <code>env1</code>, mas eu também já adiciono dois novos objetos (<code>a</code> e <code>b</code>) a esse <em>environment</em>. Esses objetos <code>a</code> e <code>b</code> guardam os valores 1 e 2, respectivamente.</p>
<p></p>
<div class="sourceCode" id="cb1859"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env1</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Como eu não defini explicitamente dentro da função <code><a href="https://rlang.r-lib.org/reference/env.html">rlang::env()</a></code>, um <em>parent environment</em> para esse novo <em>environment</em>, a função vai, por padrão, criar esse novo <em>environment</em> a partir do <em>environment</em> atual, isto é, o <em>environment</em> no qual essa função foi chamada. No exemplo acima, esse <em>environment</em> atual é o global <em>environment</em>, porque eu estou executando a função diretamente em meu console do R.</p>
<p>Por esse motivo, o <em>parent environment</em> de <code>env1</code> é o meu global <em>environment</em>. Eu posso representar essa relação de maneira visual, como na figura 18.3. Cada retângulo nessa figura é um <em>environment</em> específico. Em todas as figuras a seguir, o <em>environment</em> filho vai estar sempre apontando para o <em>environment</em> pai com uma seta azul.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-999"></span>
<img src="Figuras/parent1.png" alt="Apresentando *parent environments* - Parte 1" width="80%"><p class="caption">
Figura 18.3: Apresentando <em>parent environments</em> - Parte 1
</p>
</div>
<p></p>
<p>Como um outro exemplo, eu posso criar um outro enviroment chamado <code>env2</code>. Porém, dessa vez, esse <em>environment</em> é criado a partir de <code>env1</code>. Ou seja, <code>env1</code> se torna o <em>parent environment</em> de <code>env2</code>. Repare que eu crio 3 novos objetos (<code>e</code>, <code>d</code> e <code>c</code>) dentro desse novo <em>environment</em>.</p>
<p></p>
<div class="sourceCode" id="cb1860"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env2</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="va">env1</span>, c <span class="op">=</span> <span class="fl">3</span>, d <span class="op">=</span> <span class="fl">4</span>, e <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Para descobrir o <em>parent environment</em> de um <em>environment</em> qualquer, você pode utilizar a função <code><a href="https://rdrr.io/r/base/environment.html">parent.env()</a></code>. Veja no exemplo abaixo que, o resultado do comando <code>parent.env(env2)</code> é justamente o endereço de <code>env1</code>.</p>
<p></p>
<div class="sourceCode" id="cb1861"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">parent.env</a></span><span class="op">(</span><span class="va">env2</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d0ccfc358&gt;</code></pre>
<div class="sourceCode" id="cb1863"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env1</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d0ccfc358&gt;</code></pre>
<p></p>
<p>Caso eu aplique essa função sobre <code>env1</code>, podemos confirmar que o meu global <em>environment</em> é de fato o pai desse <em>environment</em>.</p>
<p></p>
<div class="sourceCode" id="cb1865"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">parent.env</a></span><span class="op">(</span><span class="va">env1</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>Sendo assim, podemos atualizar a nossa representação visual da seguinte maneira:</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-1003"></span>
<img src="Figuras/parent2.png" alt="Apresentando *parent environments* - Parte 2" width="100%"><p class="caption">
Figura 18.4: Apresentando <em>parent environments</em> - Parte 2
</p>
</div>
<p></p>
<p>Vale destacar que, a figura 18.4 acima não mostra um <em>parent environment</em> para o meu global <em>environment</em>, mas isso não significa que esse <em>environment</em> não existe. Eu apenas o omiti acima, para manter a figura simples.</p>
<p>Lembre-se sempre que, todo <em>environment</em> possui um <em>parent environment</em>. Como exemplo, perceba abaixo que, o <em>parent environment</em> de meu global <em>environment</em> é (neste momento) o <em>environment</em> do pacote <code>dplyr</code>, que foi o último pacote que eu carreguei para a minha sessão.</p>
<p></p>
<div class="sourceCode" id="cb1867"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">parent.env</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/environment.html">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## &lt;environment: package:dplyr&gt;
## attr(,"name")
## [1] "package:dplyr"
## attr(,"path")
## [1] "C:/Users/Pedro/Documents/R/win-library/4.1/dplyr"</code></pre>
<p>Nos manuais internos do R, o <em>parent environment</em> é muitas vezes chamado de <em>enclosing environment</em>, isto é, o ambiente que “envolve” ou que “contém” os demais <em>environments</em> <span class="citation">(<a href="refer%C3%AAncias.html#ref-Rlanguage" role="doc-biblioref">TEAM, 2020a</a>)</span>. Ou seja, de certa forma, o <em>environment</em> <code>env1</code> envolve ou contém <code>env2</code> dentro dele, e, o meu global <em>environment</em> contém <code>env1</code>.</p>
</div>
<div id="o-environment-vazio-ou-empty-environment" class="section level3" number="18.7.2">
<h3>
<span class="header-section-number">18.7.2</span> O <em>environment</em> vazio ou <em>empty environment</em><a class="anchor" aria-label="anchor" href="#o-environment-vazio-ou-empty-environment"><i class="fas fa-link"></i></a>
</h3>
<p>Eventualmente, toda sequência de <em>environments</em> termina em um <em>environment</em> vazio (ou <em>empty environment</em>). Em outras palavras, se você começar a subir pela árvore genealógica de seus <em>environments</em>, seguindo <em>parent environment</em> atrás de <em>parent environment</em>, você vai eventualmente chegar a um empty <em>environment</em>. Que é um tipo especial de <em>environment</em>, pois ele é a exceção à regra de que todo <em>environment</em> possui um pai.</p>
<p>Portanto, um empty <em>environment</em> é identificado pelo apelido <code>R_EmptyEnv</code> e, ele não possui um <em>parent environment</em>. Você pode acessar esse <em>environment</em> através da função <code><a href="https://rdrr.io/r/base/environment.html">emptyenv()</a></code>.</p>
<p></p>
<div class="sourceCode" id="cb1869"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">emptyenv</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: R_EmptyEnv&gt;</code></pre>
<p></p>
<p>Você pode comprovar a afirmação do parágrafo acima, ao tentar aplicar a função <code><a href="https://rdrr.io/r/base/environment.html">parent.env()</a></code> sobre esse <em>environment</em>. Perceba abaixo que um erro é retornado, avisando que esse <em>environment</em> não possui um <em>environment</em> “pai”.</p>
<p></p>
<div class="sourceCode" id="cb1871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">parent.env</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/environment.html">emptyenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## Error in parent.env(emptyenv()) : the empty *environment* has no parent</code></pre>
<p>Tendo isso em mente, esse <em>environment</em> vazio representa o final de toda sequência de <em>environments</em>. De certa maneira, esse <em>environment</em> é o último <em>parent environment</em> de todos. Assim que o R atinge esse <em>environment</em>, ele encerra o seu processo de pesquisa, pois ele não tem mais para onde ir.</p>
<p>Se você refletir sobre isso, você pode chegar a conclusão de que, se o R chegar a esse <em>environment</em> vazio durante o seu processo de pesquisa, isso significa que o R não pôde encontrar o objeto que você requisitou. Pois ao chegar a esse <em>environment</em> vazio, o R já vai ter visitado todos os outros <em>environments</em> ativos em sua sessão.</p>
</div>
<div id="o-caminho-de-busca-ou-search-path-do-r" class="section level3" number="18.7.3">
<h3>
<span class="header-section-number">18.7.3</span> O caminho de busca ou <em>search path</em> do R<a class="anchor" aria-label="anchor" href="#o-caminho-de-busca-ou-search-path-do-r"><i class="fas fa-link"></i></a>
</h3>
<p>Para encontrar o objeto pelo qual você requisitou, o R visita <em>environment</em> por <em>environment</em>, em busca desse objeto, até atingir um empty <em>environment</em>. A lista de <em>environments</em> que o R visita durante esse processo de pesquisa, é chamada de <em>search path</em> (ou, o caminho de pesquisa). Você pode descobrir qual é esse <em>search path</em>, através da função <code><a href="https://rdrr.io/r/base/search.html">search()</a></code>.</p>
<p>Basta executar essa função, que um vetor contendo os nomes de todos esses <em>environments</em> será retornado como resultado. Vale destacar que, os nomes desses <em>environments</em> vão estar precisamente na ordem em que eles são visitados, durante este processo de pesquisa.</p>
<p>Perceba abaixo que, o <em>environment</em> <code>.GlobalEnv</code> (que é um outro apelido para o <em>global environment</em>) é o primeiro da lista. Logo, o seu <em>global environment</em> é o primeiro <em>environment</em> visitado pelo R. Por outro lado, o <em>environment</em> do pacote <code>base</code> é o último <em>environment</em> visitado.</p>
<p></p>
<div class="sourceCode" id="cb1873"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/search.html">search</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## [1]  ".GlobalEnv"        "tools:rstudio"     "package:stats"
## [4]  "package:graphics"  "package:grDevices" "package:utils"
## [7]  "package:datasets"  "package:methods"   "Autoloads"
## [10] "package:base"</code></pre>
<p>Portanto, o <em>search path</em> do R sempre segue essa mesma estrutura. Ele sempre se inicia pelo seu <em>global environment</em>, seguido dos <em>environments</em> dos pacotes que estão carregados em sua sessão, que por sua vez, são seguidos pelo <em>environment</em> <code>Autoloads</code> e pelo <em>environment</em> do pacote <code>base</code>.</p>
<p>O <em>environment</em> Autoloads é basicamente responsável por carregar algumas bases de dados padrão do R. Porém, tais bases são carregadas de maneira <em>lazy</em> (preguiçosa), isto é, essas bases são carregadas para a memória RAM apenas no momento em que você efetivamente requisita por elas.</p>
<p>Já o <em>environment</em> do pacote <code>base</code> é sempre o último <em>environment</em> dessa lista. Isso significa que, após esse <em>environment</em>, temos um <em>environment</em> vazio que encerra o mecanismo de pesquisa do R, como está demonstrado abaixo.</p>
<p></p>
<div class="sourceCode" id="cb1875"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">parent.env</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.environment.html">as.environment</a></span><span class="op">(</span><span class="st">"package:base"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: R_EmptyEnv&gt;</code></pre>
<p></p>
<p>Podemos representar este caminho de maneira gráfica, como apresentado na figura 18.5. Perceba que, pelo fato do <em>environment</em> do pacote <code>base</code> ser o último da lista resultante de <code><a href="https://rdrr.io/r/base/search.html">search()</a></code>, o seu <em>parent environment</em> é justamente um <em>environment</em> vazio.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-1009"></span>
<img src="Figuras/search_path.png" alt="Representação do *search path* do R" width="100%"><p class="caption">
Figura 18.5: Representação do <em>search path</em> do R
</p>
</div>
<p></p>
<!-- Portanto, o R sempre inicia o processo de busca pelo seu *global environment*. Ou seja, o *global environment* é o primeiro *environment* que o R visita em busca do objeto que você digitou. Para mais, o pacote `base` é sempre o último *environment* pesquisado. Logo, esse pacote sempre é o último elemento do vetor resultante de `search()` [@peng2015]. -->
<!-- ### O sentido de busca do R -->
<!-- Para compreender o caminho percorrido pelo R durante o *scoping*, é importante que você entenda o sentido que o R utiliza ao percorrer pela árvore (ou sequência) de *environments*. Em resumo, o R percorre os vários *environments*, **subindo** a árvore genealógica.  -->
<!-- Ou seja, se o R não encontrar o seu objeto em um *environment* `x`, ele parte para o *parent environment* desse *environment* `x`, em seguida, caso ele não encontre o objeto neste outro *environment*, então, ele parte novamente para o próximo *parent environment*, e assim segue, até ele encontrar o seu objeto (ou até atingir um *environment* vazio).  -->
<!-- Portanto, quando você precisa compreender o caminho que o R está percorrendo durante um processo de pesquisa, é importante que você identifique quais são os *parent environments* do *environment* inicial. Se você souber qual é o primeiro *environment* pesquisado, e quais são os seus *parent environments*, você pode desenhar aos poucos esse caminho em sua mente.  -->
<!-- Se utilizarmos como referência, o *search path* mostrado na figura x, o R tenta primeiro encontrar o objeto em seu *global environment*. Caso ele não encontre este objeto, o R parte então para o *parent environment* de seu global *environment*, que é sempre o *environment* do último pacote que você carregou para a sua sessão. E assim vai, seguindo os *environments* de todos os pacotes que você carregou para a sua sessão. Por último, o R ainda tenta encontrar esse objeto em `Autoloads` e no *environment* do pacote `base` (respectivamente) antes de atingir o *environment* vazio e encerrar o seu processo de busca. -->
</div>
<div id="descrevendo-o-lexical-scoping" class="section level3" number="18.7.4">
<h3>
<span class="header-section-number">18.7.4</span> Descrevendo o <em>lexical scoping</em><a class="anchor" aria-label="anchor" href="#descrevendo-o-lexical-scoping"><i class="fas fa-link"></i></a>
</h3>
<!-- A obra de @wickham2015_advanced fornece uma descrição bastante clara, completa e precisa de *environments* e, por isso, representa uma importante referência sobre o tema. Porém, da forma como o capítulo de *Environments* está escrito, o leitor pode chegar a conclusão de que o processo de busca do R sempre se inicia pelo *global environment*. Porém, isso não representa a realidade. -->
<!-- Infelizmente, a obra de @wickham2015_advanced não discute esse ponto de forma clara ao longo de seu capítulo de [*Environments*](https://adv-r.hadley.nz/environments.html). Os autores chegam a demonstrar esse ponto de forma implícita em seus exemplos da seção 6.4 de [*Lexical Scoping*](https://adv-r.hadley.nz/functions.html#lexical-scoping). Porém, não apontar esse conhecimento de forma clara dentro do capítulo de *Environments*, pode ter causado certa confusão em muitos leitores. -->
<p>Como descrevemos anteriormente, a linguagem R utiliza um conjunto de regras (chamadas de <em>lexical scoping</em>) para encontrar o valor de seus objetos. Nessa seção, vamos explicar em mais detalhes que regras são essas.</p>
<p>Primeiro, o R <strong>sempre</strong> inicia o seu processo de busca pelo <em>environment</em> em que você chamou por esse objeto. Por exemplo, se você está chamando por esse objeto, diretamente no console do R, então, você está chamando esse objeto a partir de seu <em>global environment</em>, logo, o R começa a sua pesquisa por este <em>environment</em>. Contudo, se você está chamando por esse objeto, dentro do body de uma função, então, o R vai procurar primeiro dentro do <em>environment</em> de execução dessa função.</p>
<p>Segundo, se o R não encontra o objeto em questão no primeiro <em>environment</em> pesquisado, ele começa a subir pela árvore genealógica de <em>environments</em>, até atingir o seu <em>global environment</em>. Ou seja, o R começa a procurar pelo objeto dentro do pai do primeiro <em>environment</em> pesquisado, depois, no pai do pai, e assim por diante.</p>
<p>Explicando ainda esse mesmo ponto, de uma outra forma: se o R não encontrar o seu objeto em um <em>environment</em> <code>x</code>, ele parte para o <em>parent environment</em> desse <em>environment</em> <code>x</code>, caso ele não encontre o objeto neste outro <em>environment</em>, então, ele parte novamente para o próximo <em>parent environment</em>, e assim segue, até ele chegar em seu <em>global environment</em> .</p>
<p>Terceiro, a partir do momento em que o R atinge o seu <em>global environment</em>, o R começa a navegar pelo seu <em>search path</em> . Ou seja, o R começa a subir pela sequência de <em>environments</em> descrita pela função <code><a href="https://rdrr.io/r/base/search.html">search()</a></code>. Então ele visita primeiro o seu <em>global environment</em>, depois, parte para os <em>environments</em> dos pacotes carregados em sua sessão, depois, para o <em>environment</em> <code>Autoloads</code> e o <em>environment</em> do pacote <code>base</code>.</p>
<p>Quarto, ao subir pelo seu <em>search path</em>, se o R atingir o empty <em>environment</em> (que é o pai do <em>environment</em> do pacote <code>base</code>), o processo de busca é encerrado, e o R retorna um erro, lhe avisando que o objeto não pôde ser encontrado.</p>
<p>Vamos para alguns exemplos práticos. Suponha que você possua a função <code>f()</code> apresentada abaixo salva em seu <em>global environment</em>. Perceba que dentro do body dessa função, temos dois objetos (<code>x</code> e <code>y</code>) que o R precisa encontrar, no momento em que executar essa função.</p>
<p>Quando essa função é avaliada, o R procura primeiro dentro do <em>environment</em> de execução dessa função. Pois é dentro desse <em>environment</em> que os objetos estão sendo chamados.</p>
<p>Dentro desse <em>environment</em> de execução, o R encontra o objeto <code>y</code> (que é igual a 10), porém, ele não consegue encontrar o objeto <code>x</code>. Consequentemente, o R parte para o pai do <em>environment</em> de execução da função, que no exemplo abaixo se trata do <em>global environment</em>. Ao chegar no <em>global environment</em>, o R encontra o vetor <code>x</code> e, por isso, tal vetor é utilizado pela função <code>f()</code>.</p>
<p></p>
<div class="sourceCode" id="cb1877"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">f</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 12 15 16 11</code></pre>
<p></p>
<p>Agora, vamos partir para um exemplo mais profundo. Observe o exemplo abaixo, e tente responder a seguinte pergunta: porque o resultado do comando <code>h(3)</code> mostrado abaixo é 13, e não 25?. Para responder a essa pergunta, vamos recapitular ou esclarecer alguns pontos a seguir.</p>
<p></p>
<div class="sourceCode" id="cb1879"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">15</span>

<span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">10</span>
  <span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">h</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="op">)</span>
<span class="fu">h</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<p></p>
<p>Primeiro, vamos expor o caminho de <em>environments</em> que você (leitor) provavelmente achou que o R iria seguir durante o cálculo de <code>h()</code> (painel A), e, o caminho que ele efetivamente seguiu (painel B). Tais caminhos de <em>environments</em> estão expostos na figura 18.6.</p>
<p></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-1012"></span>
<img src="Figuras/exemplo_path1.png" alt="Certos *parent environments* podem te surpreender" width="100%"><p class="caption">
Figura 18.6: Certos <em>parent environments</em> podem te surpreender
</p>
</div>
<p></p>
<p>Pelo fato da função <code>h()</code> ter sido criada dentro do <em>global environment</em>, você provavelmente pressupôs que <code>R_GlobalEnv</code> fosse o <em>parent environment</em> do <em>environment</em> de execução dessa função. Porém, o <em>parent environment</em> de <code>h()</code> é na verdade o <em>environment</em> de execução da função <code>f()</code>.</p>
<p>Pois o valor do objeto <code>h</code> (que está salvo no <em>global environment</em>) é a definição da função <code>g()</code>. Essa função <code>g()</code> foi criada dentro do <em>environment</em> de execução da função <code>f()</code>. Portanto, o <em>parent environment</em> da função que está armazenada dentro do objeto <code>h</code> é o <em>environment</em> de execução da função <code>f()</code>.</p>
<p>Tendo isso em mente, lembre-se que toda função do R possui o que chamamos de <em>function environment</em>. Esse é o <em>environment</em> no qual essa função foi criada. Para mais, o <em>function environment</em> é sempre o pai do <em>environment</em> de execução dessa função.</p>
<p>Esse exemplo mostra que as conexões de todos os objetos envolvidos em uma expressão, são definidos no instante em que aquela expressão é criada. Os manuais internos da linguagem, destacam essa característica como um dos princípios fundamentais de <em>lexical scope</em>:</p>
<blockquote>
<blockquote>
<p>“R adheres to a set of rules that are called lexical scope. This means the variable bindings in effect at the time the expression was created are used to provide values for any unbound symbols in the expression.” </p>
</blockquote>
</blockquote>
<p>Isso significa que essas conexões não são calculadas pelo R, no momento em que executamos essa expressão, e, sim, no momento em que definimos ou criamos essa expressão. Em outras palavras, o <em>parent environment</em> da função <code>h()</code> foi determinado no momento em que a função <code>g()</code> foi criada, e não, no momento em que executamos a função <code>h()</code>.</p>
<p>Concluindo, as regras que regem o <em>lexical scoping</em> no R são:</p>
<ol style="list-style-type: decimal">
<li><p>O R sempre inicia o seu processo de busca pelo <em>environment</em> no qual você requisitou pelo objeto;</p></li>
<li><p>Se ele não encontra o objeto no primeiro <em>environment</em> pesquisado, ele começa a percorrer os <em>parent environments</em>, até atingir o global environment;</p></li>
<li><p>Ao atingir o global <em>environment</em>, o R percorre o <em>search path</em>;</p></li>
<li><p>Ao atingir um empty <em>environment</em>, a procura é interrompida, e um erro é levantado indicando que o objeto não foi encontrado;</p></li>
</ol>
</div>
</div>
<div id="criando-objetos-em-outros-environments." class="section level2" number="18.8">
<h2>
<span class="header-section-number">18.8</span> Criando objetos em outros <em>environments</em>.<a class="anchor" aria-label="anchor" href="#criando-objetos-em-outros-environments."><i class="fas fa-link"></i></a>
</h2>
<p>Quando utilizamos o operador de assignment <code>&lt;-</code> para criar um objeto, este objeto é sempre criado dentro do <em>environment</em> no qual você executou tal operador. Veja o exemplo abaixo.</p>
<p>Repare que dois objetos numéricos (<code>x</code> e <code>y</code>) estão sendo criados. Contudo, esses dois objetos estão sendo criados em <em>environments</em> diferentes. Mais especificamente, o objeto <code>x</code> é criado dentro do meu global <em>environment</em>, enquanto o objeto y é criado dentro do <em>environment</em> de execução da função <code>f()</code>.</p>
<p></p>
<div class="sourceCode" id="cb1881"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">10</span>

<span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="op">}</span></code></pre></div>
<p></p>
<p>Portanto, você pode utilizar o body de uma função, para criar objetos em <em>environments</em> diferentes de seu <em>global environments</em>. Além disso, você já viu que a função <code><a href="https://rlang.r-lib.org/reference/env.html">rlang::env()</a></code> te permite fornecer novos objetos para serem armazenados dentro do novo <em>environment</em> criado pela função. No exemplo abaixo, estou criando dois objetos (<code>nome</code> e <code>ano</code>) dentro do <em>environment</em> <code>env1</code>.</p>
<p></p>
<div class="sourceCode" id="cb1882"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env1</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span>nome <span class="op">=</span> <span class="st">"Pedro"</span>, ano <span class="op">=</span> <span class="fl">2022</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Como uma outra alternativa, você pode também utilizar a função <code><a href="https://rdrr.io/r/base/assign.html">assign()</a></code> quando desejar ser mais específico quanto ao <em>environment</em> em que o objeto deve ser criado. Em resumo, essa função executa o mesmo trabalho do operador de <code>assignment</code> (<code>&lt;-</code>), todavia, essa função nos oferece o argumento <code>envir</code>, no qual podemos definir o <em>environment</em> no qual o objeto será criado.</p>
<p>Como exemplo, estou criando abaixo dois <em>environments</em> separados, <code>env1</code> e <code>env2</code>. Repare que <code>env1</code> é o <em>parent environment</em> de <code>env2</code>. A princípio, esses dois <em>environments</em> estão vazios.</p>
<p></p>
<div class="sourceCode" id="cb1883"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env1</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">env2</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="va">env1</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Se eu desejasse criar um objeto dentro do <em>environment</em> <code>env2</code>, eu poderia utilizar a função <code><a href="https://rdrr.io/r/base/assign.html">assign()</a></code> como exposto abaixo. Perceba que nesse exemplo, estou criando um objeto chamado <code>x</code> que contém o valor 10.</p>
<p></p>
<div class="sourceCode" id="cb1884"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">10</span>, envir <span class="op">=</span> <span class="va">env2</span><span class="op">)</span></code></pre></div>
<p></p>
<p>Depois de executar a função, podemos acessar o objeto <code>x</code> com o operador <code>$</code>, ou ainda, com a função <code><a href="https://rdrr.io/r/base/get.html">get()</a></code> que vimos em seções anteriores.</p>
<p></p>
<div class="sourceCode" id="cb1885"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env2</span><span class="op">$</span><span class="va">x</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb1887"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">"x"</span>, envir <span class="op">=</span> <span class="va">env2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p></p>
<p>Para além dessas opções, você pode utilizar o operador de super-assignment (<code>&lt;&lt;-</code>) para redefinir um objeto presente no <em>parent environment</em> do <em>environment</em> atual. Como exemplo, vamos estudar as funções <code>f()</code> e <code>g()</code> abaixo.</p>
<p>Perceba que a função <code>g()</code> é criada dentro da função <code>f()</code>, logo, o <em>parent environment</em> da função <code>g()</code> é o <em>environment</em> de execução da função <code>f()</code>. Repare também que, dentro da função <code>f()</code> é criado um objeto chamado <code>y</code>, contendo inicialmente o valor 20.</p>
<p>Entretanto, a partir do momento em que a função <code>g()</code> é executada dentro da função <code>f()</code>, o valor do objeto <code>y</code> se torna igual a 1. Isso ocorre, pelo fato da função <code>g()</code> executar dentro dela, uma expressão de <em>super-assignment</em>, mais especificamente, a expressão <code>y &lt;&lt;- 1</code>.</p>
<p></p>
<div class="sourceCode" id="cb1889"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">20</span>
  <span class="co">### Primeiro print()</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
  <span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
    <span class="va">y</span> <span class="op">&lt;&lt;-</span> <span class="fl">1</span>
  <span class="op">}</span>
  
  <span class="fu">g</span><span class="op">(</span><span class="op">)</span>
  <span class="co">### Segundo print()</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="op">}</span>


<span class="fu">f</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 20
## [1] 1</code></pre>
<p></p>
<p>Em mais detalhes, quando utilizamos o operador <code>&lt;&lt;-</code>, ao invés do R criar o objeto dentro do <em>environment</em> onde a expressão foi executada, ele inicia uma busca dentro do <em>parent environment</em>, atrás de um objeto que possua o mesmo nome do objeto contido nessa expressão.</p>
<p>Ou seja, ao executar a expressão <code>y &lt;&lt;- 1</code>, o R começou a procurar dentro do <em>parent environment</em> de <code>g()</code> (que no exemplo acima, é o <em>environment</em> de execução de <code>f()</code>), por um objeto chamado <code>y</code>. Ao encontrar o objeto <code>y</code> que guarda o valor de 20, o R redefine o seu valor para 1.</p>
<p>Portanto, em uma operação de <em>super-assignment</em> (<code>&lt;&lt;-</code>), o R procura pelo objeto envolvido na operação dentro do <em>parent environment</em>. Caso o R encontre esse objeto, ele vai redefinir o seu valor. Entretanto, se o R não encontrar esse objeto dentro do <em>parent environment</em>, então, ele vai criar (ou redefinir) esse objeto dentro de seu global <em>environment</em>.</p>
<p>Por exemplo, observe as funções <code>f()</code> e <code>g()</code> abaixo. O <em>parent environment</em> de <code>g()</code> continua sendo o <em>environment</em> de execução de <code>f()</code>. Porém, perceba que dessa vez, não existe um objeto <code>y</code> sendo definido dentro de <code>f()</code>. Para mais, repare que antes de eu executar a função <code>f()</code>, não existe nenhum objeto <code>y</code> salvo em meu global <em>environment</em>.</p>
<p>Em contrapartida, no instante em que eu executo a função <code>f()</code>, um novo objeto <code>y</code> contendo o valor 1 surge em meu global <em>environment</em>. Perceba que eu utilizo a função <code><a href="https://rdrr.io/r/base/get.html">get()</a></code> em conjunto com <code><a href="https://rdrr.io/r/base/environment.html">globalenv()</a></code> para demonstrar que tal objeto foi encontrado dentro de meu global <em>environment</em>, e não em algum outro <em>environment</em>.</p>
<p></p>
<div class="sourceCode" id="cb1891"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Perceba que ainda não existe nenhum</span>
<span class="co">### objeto chamado `y` em meu global environment</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></code></pre></div>
<p></p>
<pre><code>## Error in print(y) : object 'y' not found</code></pre>
<p></p>
<div class="sourceCode" id="cb1893"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
  <span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>
    <span class="va">y</span> <span class="op">&lt;&lt;-</span> <span class="fl">1</span>
  <span class="op">}</span>
  
  <span class="fu">g</span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span>


<span class="fu">f</span><span class="op">(</span><span class="op">)</span>

<span class="co">### Agora, como num passe de mágica</span>
<span class="co">### surge um objeto chamado `y` em</span>
<span class="co">### meu global environment</span>
<span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">"y"</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p></p>
<p>Portanto, dessa vez, o R não conseguiu encontrar um objeto chamado <code>y</code> dentro do <em>environment</em> de <code>f()</code> e, por isso, ele acabou criando este objeto <code>y</code> dentro de meu global <em>environment</em>.</p>
</div>
<div id="exercícios-13" class="section level2 unnumbered">
<h2>Exercícios<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-13"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Questão 18.1.</strong> Observe o exemplo abaixo, em que eu acabo de iniciar uma nova sessão no R, e crio logo em seguida, dois novos <em>environments</em> (<code>env1</code> e <code>env2</code>). Através dos resultados de <code><a href="https://rdrr.io/r/base/environment.html">parent.env()</a></code> abaixo, sabemos que o <em>global environment</em> é o pai de <code>env1</code>, enquanto <code>env1</code> é o pai de <code>env2</code>. Portanto, os itens desta questão focam na relação entre esses três <em>environments</em> (<code>env1</code>, <code>env2</code> e o <em>global environment</em>). Agora, suponha que eu crie dois objetos (<code>obj</code> e <code>i</code>) dentro de <code>env1</code>, e, um objeto (<code>i</code>) dentro de <code>env2</code>.</p>
<p></p>
<div class="sourceCode" id="cb1895"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Acabei de iniciar um nova sessão no R</span>
<span class="va">env1</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">env2</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="va">env1</span><span class="op">)</span>

<span class="va">env1</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d78042148&gt;</code></pre>
<div class="sourceCode" id="cb1897"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env2</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d77f09f10&gt;</code></pre>
<div class="sourceCode" id="cb1899"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">parent.env</a></span><span class="op">(</span><span class="va">env1</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<div class="sourceCode" id="cb1901"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/environment.html">parent.env</a></span><span class="op">(</span><span class="va">env2</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;environment: 0x0000021d78042148&gt;</code></pre>
<div class="sourceCode" id="cb1903"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">env1</span><span class="op">$</span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>
<span class="va">env1</span><span class="op">$</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="va">env2</span><span class="op">$</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">2</span></code></pre></div>
<p></p>
<p>18.1.A) Abaixo, estou utilizando a função <code><a href="https://rdrr.io/r/base/eval.html">eval()</a></code> para executar a expressão <code>obj[i] &lt;&lt;- obj[i] + 1</code> dentro do <em>environment</em> <code>env1</code>. O que vai acontecer nesse caso? Em que <em>environment</em> será salvo o resultado dessa expressão?</p>
<p></p>
<div class="sourceCode" id="cb1904"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">obj</span> <span class="op">&lt;&lt;-</span> <span class="va">obj</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, envir <span class="op">=</span> <span class="va">env1</span><span class="op">)</span></code></pre></div>
<p></p>
<p>18.1.B) Abaixo, estou utilizando novamente a função <code><a href="https://rdrr.io/r/base/eval.html">eval()</a></code> para executar a expressão <code>obj[i] &lt;&lt;- obj[i] + 1</code> dentro de um environment específico. Porém, dessa vez, estou executando essa expressão dentro do environment <code>env2</code>. O que vai acontecer nesse caso? O resultado da expressão será salvo em um <em>environment</em> diferente do item anterior? Lembre-se, é muito importante começar com uma sessão limpa do R, e recriar os <em>environments</em> <code>env1</code> e <code>env2</code> para testar o comando abaixo.</p>
<p></p>
<div class="sourceCode" id="cb1905"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">obj</span> <span class="op">&lt;&lt;-</span> <span class="va">obj</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, envir <span class="op">=</span> <span class="va">env2</span><span class="op">)</span></code></pre></div>
<p></p>
<p><strong>Questão 18.2.</strong> Observe os exemplos em cada item abaixo, e tente prever qual será o resultado de cada comando <code><a href="https://rdrr.io/r/base/print.html">print()</a></code>.</p>
<p>18.2.A)</p>
<p></p>
<div class="sourceCode" id="cb1906"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">15</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">### Qual será o resultado do comando print()</span>
<span class="co">### executado por f() ?</span>
<span class="fu">f</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p></p>
<p>18.2.B)</p>
<p></p>
<div class="sourceCode" id="cb1907"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Iniciei uma nova sessão no R</span>
<span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>

<span class="va">env1</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">env2</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="va">env1</span><span class="op">)</span>
<span class="va">env3</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/env.html">env</a></span><span class="op">(</span><span class="va">env2</span><span class="op">)</span>

<span class="va">env1</span><span class="op">$</span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>
<span class="va">env3</span><span class="op">$</span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">obj</span> <span class="op">&lt;&lt;-</span> <span class="va">obj</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, envir <span class="op">=</span> <span class="va">env2</span><span class="op">)</span>

<span class="co">### Qual é o resultado do print() abaixo ?</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">"obj"</span>, envir <span class="op">=</span> <span class="va">env1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p></p>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="debugging---resolvendo-bugs-em-suas-fun%C3%A7%C3%B5es.html"><span class="header-section-number">17</span> Debugging - Resolvendo bugs em suas funções</a></div>
<div class="next"><a href="respostas.html">Respostas</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#environments-ou-ambientes-no-r"><span class="header-section-number">18</span> Environments ou ambientes no R</a></li>
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o-3"><span class="header-section-number">18.1</span> Introdução</a></li>
<li><a class="nav-link" href="#sec:environments"><span class="header-section-number">18.2</span> Noções básicas de environments</a></li>
<li><a class="nav-link" href="#descobrindo-o-environment-atual"><span class="header-section-number">18.3</span> Descobrindo o environment atual</a></li>
<li><a class="nav-link" href="#o-environment-global"><span class="header-section-number">18.4</span> O environment global</a></li>
<li>
<a class="nav-link" href="#sec:environment_exec"><span class="header-section-number">18.5</span> O environment de execução de uma função</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#os-environments-de-pacotes"><span class="header-section-number">18.5.1</span> Os environments de pacotes</a></li></ul>
</li>
<li><a class="nav-link" href="#acessando-outros-environments"><span class="header-section-number">18.6</span> Acessando outros environments</a></li>
<li>
<a class="nav-link" href="#o-sistema-de-scoping-do-r"><span class="header-section-number">18.7</span> O sistema de scoping do R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#compreendendo-parent-environments"><span class="header-section-number">18.7.1</span> Compreendendo parent environments</a></li>
<li><a class="nav-link" href="#o-environment-vazio-ou-empty-environment"><span class="header-section-number">18.7.2</span> O environment vazio ou empty environment</a></li>
<li><a class="nav-link" href="#o-caminho-de-busca-ou-search-path-do-r"><span class="header-section-number">18.7.3</span> O caminho de busca ou search path do R</a></li>
<li><a class="nav-link" href="#descrevendo-o-lexical-scoping"><span class="header-section-number">18.7.4</span> Descrevendo o lexical scoping</a></li>
</ul>
</li>
<li><a class="nav-link" href="#criando-objetos-em-outros-environments."><span class="header-section-number">18.8</span> Criando objetos em outros environments.</a></li>
<li><a class="nav-link" href="#exerc%C3%ADcios-13">Exercícios</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/pedropark99/Introducao_R//blob/main/16-environments.Rmd">View source <i class="fas fa-book-open"></i></a></li>
          <li><a id="book-edit" href="https://github.com/pedropark99/Introducao_R//edit/main/16-environments.Rmd">Edit this page <i class="fas fa-book-open"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introdução à Linguagem R: seus fundamentos e sua prática</strong>" was written by Pedro Faria. It was last built on 2022-11-30.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
